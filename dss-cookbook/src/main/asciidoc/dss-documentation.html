<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="description" content="Documentation of the open source project DSS (Digital Signature Service). This project allows producing/validation of Advanced electronic signatures (AdES).">
<meta name="keywords" content="electronic signature, XAdES, CAdES, PAdES, ASiC, open source, validation">
<meta name="author" content="version : {dssVersion} - 2022-01-03">
<title>Digital Signature Service</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Digital Signature Service</h1>
<div class="details">
<span id="author" class="author">version : {dssVersion} - 2022-01-03</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_generic_information">1. Generic information</a>
<ul class="sectlevel2">
<li><a href="#_purpose_of_the_document">1.1. Purpose of the document</a></li>
<li><a href="#_scope_of_the_document">1.2. Scope of the document</a></li>
<li><a href="#_available_demonstrations">1.3. Available demonstrations</a></li>
<li><a href="#_license">1.4. License</a></li>
<li><a href="#_abbreviations_and_acronyms">1.5. Abbreviations and Acronyms</a></li>
<li><a href="#_references">1.6. References</a></li>
<li><a href="#_useful_links">1.7. Useful links</a></li>
</ul>
</li>
<li><a href="#_how_to_start_with_dss">2. How to start with DSS</a>
<ul class="sectlevel2">
<li><a href="#_integration_instructions">2.1. Integration instructions</a></li>
<li><a href="#_dss_framework_structure">2.2. DSS framework structure</a></li>
</ul>
</li>
<li><a href="#_electronic_signatures_and_dss">3. Electronic signatures and DSS</a>
<ul class="sectlevel2">
<li><a href="#_eu_legislation">3.1. EU legislation</a></li>
<li><a href="#_electronic_and_digital_signatures">3.2. Electronic and digital signatures</a></li>
<li><a href="#DigitalSignatureConcepts">3.3. Digital signatures concepts</a></li>
<li><a href="#_resources">3.4. Resources</a></li>
<li><a href="#_digital_signatures_in_dss">3.5. Digital signatures in DSS</a></li>
</ul>
</li>
<li><a href="#_signature_creation">4. Signature creation</a>
<ul class="sectlevel2">
<li><a href="#_ades_specificities">4.1. AdES specificities</a></li>
<li><a href="#DSSDocuments">4.2. Representation of documents in DSS</a></li>
<li><a href="#SignatureTokens">4.3. Signature tokens</a></li>
<li><a href="#SignatureCreationThreeSteps">4.4. Signature creation in 3 stateless methods</a></li>
<li><a href="#_cryptographic_signature_value_creation">4.5. Cryptographic signature value creation</a></li>
<li><a href="#_creating_a_xades_baseline_b_signature">4.6. Creating a XAdES baseline B signature</a></li>
<li><a href="#_configuration_of_attributes_in_dss">4.7. Configuration of attributes in DSS</a></li>
<li><a href="#_multiple_signatures_2">4.8. Multiple signatures</a></li>
<li><a href="#_counter_signatures">4.9. Counter signatures</a></li>
<li><a href="#_extract_the_original_document_from_a_signature">4.10. Extract the original document from a signature</a></li>
</ul>
</li>
<li><a href="#_specificities_of_signature_creation_in_different_signature_formats">5. Specificities of signature creation in different signature formats</a>
<ul class="sectlevel2">
<li><a href="#_xades_xml">5.1. XAdES (XML)</a></li>
<li><a href="#_cades_signature_cms">5.2. CAdES signature (CMS)</a></li>
<li><a href="#_pades_signature_pdf">5.3. PAdES signature (PDF)</a></li>
<li><a href="#_iso_32000_1_pdf_signature_pkcs7">5.4. ISO 32000-1 PDF signature (PKCS#7)</a></li>
<li><a href="#_jades_signature_jws">5.5. JAdES signature (JWS)</a></li>
<li><a href="#_asic_signature_containers">5.6. ASiC signature (containers)</a></li>
</ul>
</li>
<li><a href="#RevocationDataManagement">6. Revocation data management</a>
<ul class="sectlevel2">
<li><a href="#_tokens_and_sources">6.1. Tokens and sources</a></li>
<li><a href="#_caching">6.2. Caching</a></li>
<li><a href="#_online_fetching">6.3. Online fetching</a></li>
<li><a href="#_other_implementations_of_crl_and_ocsp_sources">6.4. Other implementations of CRL and OCSP Sources</a></li>
<li><a href="#RevocationLoadingStrategy">6.5. Revocation data loading strategy</a></li>
</ul>
</li>
<li><a href="#SignatureValidation">7. Signature Validation</a>
<ul class="sectlevel2">
<li><a href="#CertificateValidation">7.1. Validation of a certificate</a></li>
<li><a href="#validationPolicy">7.2. AdES validation constraints/policy</a></li>
<li><a href="#signatureValidationProcess">7.3. Signature validation in one method and 4 outputs</a></li>
<li><a href="#_various_dss_validation_options">7.4. Various DSS validation options</a></li>
<li><a href="#ServiceLoaderValidation">7.5. DocumentValidator implementation management</a></li>
<li><a href="#_format_specificities">7.6. Format specificities</a></li>
</ul>
</li>
<li><a href="#RequestingTimestampToken">8. Requesting a timestamp token in DSS</a>
<ul class="sectlevel2">
<li><a href="#_configuring_timestamp_sources">8.1. Configuring timestamp sources</a></li>
</ul>
</li>
<li><a href="#_standalone_timestamping">9. Standalone timestamping</a>
<ul class="sectlevel2">
<li><a href="#_timestamping_a_pdf">9.1. Timestamping a PDF</a></li>
<li><a href="#_timestamping_with_a_container_asic">9.2. Timestamping with a container (ASiC)</a></li>
<li><a href="#_standalone_timestamps_repetition">9.3. Standalone timestamps repetition</a></li>
<li><a href="#_standalone_timestamp_validation">9.4. Standalone timestamp validation</a></li>
</ul>
</li>
<li><a href="#_signature_augmentation">10. Signature augmentation</a>
<ul class="sectlevel2">
<li><a href="#_configuration_of_the_augmentation_process">10.1. Configuration of the augmentation process</a></li>
<li><a href="#_augmenting_an_ades_baseline_b_signature">10.2. Augmenting an AdES baseline B signature</a></li>
<li><a href="#_creating_a_baseline_t_signature">10.3. Creating a baseline T signature</a></li>
<li><a href="#_best_practices_regarding_baseline_levels">10.4. Best practices regarding baseline levels</a></li>
</ul>
</li>
<li><a href="#TrustedLists">11. Trusted Lists</a>
<ul class="sectlevel2">
<li><a href="#tlValidationJob">11.1. Configuration of TL validation job</a></li>
<li><a href="#_validation_policy_for_trusted_lists">11.2. Validation policy for trusted lists</a></li>
<li><a href="#_using_non_eu_trusted_lists">11.3. Using non-EU trusted lists</a></li>
<li><a href="#_signing_a_trusted_list">11.4. Signing a trusted list</a></li>
</ul>
</li>
<li><a href="#_eidas">12. eIDAS</a>
<ul class="sectlevel2">
<li><a href="#_overview_of_certificates">12.1. Overview of certificates</a></li>
<li><a href="#_how_certificate_type_and_qualification_are_represented_in_dss">12.2. How certificate type and qualification are represented in DSS</a></li>
<li><a href="#_overview_of_ades_signatures">12.3. Overview of AdES signatures</a></li>
<li><a href="#_how_signature_type_and_qualification_are_represented_in_dss">12.4. How signature type and qualification are represented in DSS</a></li>
<li><a href="#_verifying_the_qualified_status_of_timestamp">12.5. Verifying the qualified status of timestamp</a></li>
</ul>
</li>
<li><a href="#_webservices_2">13. Webservices</a>
<ul class="sectlevel2">
<li><a href="#REST">13.1. REST</a></li>
<li><a href="#SOAP">13.2. SOAP</a></li>
</ul>
</li>
<li><a href="#_internationalization_i18n">14. Internationalization (i18n)</a>
<ul class="sectlevel2">
<li><a href="#i18nLanguage">14.1. Language of reports</a></li>
</ul>
</li>
<li><a href="#_exceptions">15. Exceptions</a></li>
<li><a href="#_privacy">16. Privacy</a>
<ul class="sectlevel2">
<li><a href="#_use_of_digested_documents">16.1. Use of digested documents</a></li>
<li><a href="#_original_document_in_the_data_to_be_signed">16.2. Original document in the Data To Be Signed</a></li>
<li><a href="#_private_information_in_logs">16.3. Private information in logs</a></li>
<li><a href="#ClientServerSeparation">16.4. Client-side signature creation with server-side remote key activation</a></li>
</ul>
</li>
<li><a href="#AdvancedConcepts">17. Advanced DSS java concepts</a>
<ul class="sectlevel2">
<li><a href="#ServiceLoaderAdvanced">17.1. ServiceLoader</a></li>
<li><a href="#_multithreading">17.2. Multithreading</a></li>
<li><a href="#_jaxb_modules">17.3. JAXB modules</a></li>
<li><a href="#xmlSecurities">17.4. XML securities</a></li>
</ul>
</li>
<li><a href="#DSSUpgrades">18. DSS upgrades and change history</a>
<ul class="sectlevel2">
<li><a href="#_dss_upgrades">18.1. DSS upgrades</a></li>
</ul>
</li>
<li><a href="#Annex">19. Annex</a>
<ul class="sectlevel2">
<li><a href="#Alerts">19.1. Use of Alerts throughout the framework</a></li>
<li><a href="#_configuration_of_validation_policy_in_different_use_cases">19.2. Configuration of validation policy in different use cases</a></li>
<li><a href="#CachingUseCases">19.3. Caching use cases</a></li>
<li><a href="#_complete_examples_of_signature_creation">19.4. Complete examples of Signature creation</a></li>
<li><a href="#Topology">19.5. Examples of SCA and SCDev Topology and Workflows.</a></li>
<li><a href="#DetaliedReportInterpretation">19.6. Interpreting a detailed report</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_generic_information">1. Generic information</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose_of_the_document">1.1. Purpose of the document</h3>
<div class="paragraph">
<p>This document describes some examples of how to develop in Java using the DSS framework. The aim is to show to the developers, in a progressive manner, the different uses of the framework. It will familiarize them with the code step by step.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scope_of_the_document">1.2. Scope of the document</h3>
<div class="paragraph">
<p>This document provides examples of code which allow easy handling of digital signatures. The examples are consistent with the Release {dssVersion} of DSS framework which can be downloaded via <a href="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/DSS+releases" class="bare">https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/DSS+releases</a></p>
</div>
<div class="paragraph">
<p>Three main features can be distinguished within the framework :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The creation of a digital signature;</p>
</li>
<li>
<p>The augmentation of a digital signature and;</p>
</li>
<li>
<p>The validation of a digital signature.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In a more detailed manner the following concepts and features are addressed in this document:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Forms of digital signatures: XAdES, CAdES, PAdES, JAdES and ASiC-S/ASiC-E;</p>
</li>
<li>
<p>Formats of the signed documents: XML, JSON, PDF, DOC, TXT, ZIP, etc.;</p>
</li>
<li>
<p>Packaging structures: enveloping, enveloped, detached and internally-detached;</p>
</li>
<li>
<p>Profiles associated to each form of the digital signature;</p>
</li>
<li>
<p>Trust management;</p>
</li>
<li>
<p>Revocation data handling (OCSP and CRL sources);</p>
</li>
<li>
<p>Certificate chain building;</p>
</li>
<li>
<p>Signature validation and validation policy;</p>
</li>
<li>
<p>Signature qualification;</p>
</li>
<li>
<p>Validation reports (Simple, Detailed, ETSI Validation report);</p>
</li>
<li>
<p>Management of signature tokens;</p>
</li>
<li>
<p>Validation of the signing certificate;</p>
</li>
<li>
<p>Timestamp creation;</p>
</li>
<li>
<p>Timestamp validation and qualification;</p>
</li>
<li>
<p>REST and SOAP webservices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is not an exhaustive list of all the possibilities offered by the framework and the proposed examples cover only the most useful features. However, to discover every detail of the operational principles of the framework, the JavaDoc is available within the source code.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The DSS framework is actively maintained and new features will be released in the future.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_available_demonstrations">1.3. Available demonstrations</h3>
<div class="paragraph">
<p>With the framework, some demonstrations are provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://ec.europa.eu/cefdigital/DSS/webapp-demo/home">DSS online demo web application</a>;</p>
</li>
<li>
<p><a href="#DSSWebApp">Ready to use demo web application build</a>;</p>
</li>
<li>
<p><a href="#DSSStandaloneApp">JavaFX Standalone Application</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The demonstrations use a fake timestamp service (Mock) so that is not recommended for a production usage.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The requirements and build instructions for DSS demonstrations can be found in the section <a href="#DSSDemo">DSS Demonstrations</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_license">1.4. License</h3>
<div class="paragraph">
<p>For the DSS core: <a href="https://www.gnu.org/licenses/old-licenses/lgpl-2.1.en.html">GNU Lesser General Public License version 2.1 (LGPL)</a>.</p>
</div>
<div class="paragraph">
<p>For the DSS demo: Dual license <a href="https://joinup.ec.europa.eu/licence/european-union-public-licence-version-11-or-later-eupl">MOCCA EUPL</a> and <a href="https://www.gnu.org/licenses/old-licenses/lgpl-2.1.en.html">GNU Lesser General Public License version 2.1 (LGPL)</a>. For more information please see <a href="https://github.com/esig/dss-demonstrations/blob/master/LICENSE">DSS demonstration LICENSE</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_abbreviations_and_acronyms">1.5. Abbreviations and Acronyms</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Abbreviations and Acronyms</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Advanced Electronic Signature</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Programming Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Associated Signature Containers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Building Block (CEF)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate authority</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMS Advanced Electronic Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CEF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connecting Europe Facility</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic Message Syntax</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate Revocation List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cryptographic Service Provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distinguished Encoding Rules</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Digital Signature Algorithm - an algorithm for public-key cryptography</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Digital Signature Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">European Commission</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Electronic Signatures and Infrastructures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">European Telecommunications Standards Institute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EUPL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">European Union Public License</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hardware Security Modules</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hypertext Transfer Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON Advanced Electronic Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java EE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Enterprise Edition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaDoc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaDoc is developed by Sun Microsystems to create API documentation in HTML format from the comments in the source code. JavaDoc is an industrial standard for documenting Java classes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAXB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java Architecture for XML Binding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java DataBase Connectivity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON Web Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LGPL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lesser General Public License</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOTL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of Trusted List or List of the Lists</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MOCCA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Austrian Modular Open Citizen Card Architecture; implemented in Java</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS / EUMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Member State</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MS CAPI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Cryptographic Application Programming Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OEBPS Container Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Online Certificate Status Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ODF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Document Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ODT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open Document Text</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OEBPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open eBook Publication Structure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OOXML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Office Open XML</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDF Advanced Electronic Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PC/SC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Personal computer/Smart Card</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Portable Document Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDFBox</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache PDFBox - A Java PDF Library: <a href="http://pdfbox.apache.org/" class="bare">http://pdfbox.apache.org/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public Key Cryptographic Standards</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS#12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">It defines a file format commonly used to store X.509 private key accompanying public key certificates, protected by symmetrical password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet X.509 Public Key Infrastructure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rivest Shamir Adleman - an algorithm for public-key cryptography</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signature Creation Application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signature Creation Device</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Simple Object Access Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSCD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secure Signature-Creation Device</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SVA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signature Validation Application</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trusted List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLManager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application for managing trusted lists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time Stamping Authority</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trust-service Status List</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trusted Service Provider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time-Stamp Token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UCF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Universal Container Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uniform Resource Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WSDL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web Services Description Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WYSIWYS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">What you see is what you sign</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML Advanced Electronic Signatures</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extensible Markup Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">File format used for data compression and archiving</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_references">1.6. References</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. References</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Ref.</th>
<th class="tableblock halign-left valign-top">Title</th>
<th class="tableblock halign-left valign-top">Reference</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R01"></a>	R01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - XAdES digital signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 132 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R02"></a>	R02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - CAdES digital signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 122 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R03"></a>	R03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - PAdES digital signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 142 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R04"></a>	R04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Associated Signature Containers (ASiC)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 162 part 1-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R05"></a>	R05</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - JAdES digital signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 182 part 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R06"></a>	R06</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Document management - Portable document format - Part 1: PDF 1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 32000-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R07"></a>	R07</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directive 1999/93/EC of the European Parliament and of the Council of 13 December 1999 on a Community framework for electronic signatures.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DIRECTIVE 1999/93/EC</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R08"></a>	R08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet X.509 Public Key Infrastructure - Time-Stamp Protocol (TSP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC 3161</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R09"></a>	R09</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Procedures for Creation and Validation of AdES Digital Signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI EN 319 102-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R10"></a>	R10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Signature validation policy for European qualified electronic signatures/seals using trusted lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 172-4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R11"></a>	R11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Trusted Lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 612</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.2.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R12"></a>	R12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eIDAS Regulation No 910/2014</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">910/2014/EU</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R13"></a>	R13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Procedures for Creation and Validation of AdES Digital Signatures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 102-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R14"></a>	R14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Procedures for using and interpreting EU Member States national trusted lists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 615</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R15"></a>    R15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet RFC 2315 PKCS #7: Cryptographic Message Syntax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC 2315</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version 1.5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R16"></a>    R16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commission implementing decision (EU) 2015/1506 of 8 September 2015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CID 2015/1506</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R17"></a>	R17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - Building blocks and table of contents for human
readable signature policy documents</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 172-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R18"></a>	R18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - XML format for signature policies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 172-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R19"></a>	R19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ESI - ASN.1 format for signature policies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETSI TS 119 172-3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R20"></a>    R20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet RFC 7515: JSON Web Signature (JWS)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC 7515</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R21"></a>    R21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC 5280</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R22"></a>    R22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internet RFC 6960: X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC 6960</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="R23"></a>    R23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMMON PKI SPECIFICATIONS FOR INTEROPERABLE APPLICATIONS FROM T7 &amp; TELETRUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common PKI v2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v2.0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_useful_links">1.7. Useful links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/eSignature">CEF Digital</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/eSignature+FAQ">eSignature FAQ</a></p>
</li>
<li>
<p><a href="https://esignature.ec.europa.eu/efda/home/">Trust Services Dashboard</a></p>
</li>
<li>
<p><a href="https://esignature.ec.europa.eu/efda/validation-tests/">eSignature validation tests</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/wiki/display/TLSO/Trusted+List+Manager+non-EU">Trusted List Manager non-EU</a></p>
</li>
<li>
<p><a href="https://github.com/esig/dss">Source code (GitHub)</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/code/projects/ESIG/repos/dss/browse">Source code (EC Bitbucket)</a></p>
</li>
<li>
<p><a href="https://github.com/esig/dss-demonstrations">Source code demonstrations (GitHub)</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/code/projects/ESIG/repos/dss-demos/browse">Source code demonstrations (EC Bitbucket)</a></p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/tracker/projects/DSS/issues">Report an issue (EC Jira)</a></p>
</li>
<li>
<p><a href="https://esig-dss.atlassian.net/projects/DSS">Old Jira</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_start_with_dss">2. How to start with DSS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_integration_instructions">2.1. Integration instructions</h3>
<div class="paragraph">
<p>The section explains the basic steps required to successfully integrate the DSS components to your project.</p>
</div>
<div class="sect3">
<h4 id="_dss_core">2.1.1. DSS Core</h4>
<div class="paragraph">
<p>This section explains the usage and build requirements for <a href="https://github.com/esig/dss">DSS framework</a>.</p>
</div>
<div class="sect4">
<h5 id="_requirements">2.1.1.1. Requirements</h5>
<div class="paragraph">
<p>The latest version of DSS framework has the following minimal requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 11 and higher (tested up to Java 17) for the build is required. For usage Java 8 is a minimum requirement;</p>
</li>
<li>
<p>Maven 3.6 and higher;</p>
</li>
<li>
<p>Memory and Disk: see minimal requirements for the used JVM. In general the higher available is better;</p>
</li>
<li>
<p>Operating system: no specific requirements (tested on Windows and Linux).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We strongly recommend using the latest available version of JDK, in order to have the most recent security fixes and cryptographical algorithm updates.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Before processing the integration steps, please ensure you have successfully installed Maven and JVM with a required version.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_adding_as_maven_dependency">2.1.1.2. Adding as Maven dependency</h5>
<div class="paragraph">
<p>The simplest way to include DSS to your Maven project is to add a repository into the pom.xml file in the root directory of your project as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;repositories&gt;</span>
        ...

        <span style="color:#070;font-weight:bold">&lt;repository&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;id&gt;</span>cefdigital<span style="color:#070;font-weight:bold">&lt;/id&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;name&gt;</span>cefdigital<span style="color:#070;font-weight:bold">&lt;/name&gt;</span>
          <span style="color:#070;font-weight:bold">&lt;url&gt;</span>https://ec.europa.eu/cefdigital/artifact/content/repositories/esignaturedss/<span style="color:#070;font-weight:bold">&lt;/url&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/repository&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/repositories&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After that specify a list of dependencies required for your project. See <a href="#MavenModules">Maven modules</a> to get familiar with the available modules in DSS.</p>
</div>
<div class="paragraph">
<p>Refresh your project in order to download the dependency, and then you will be able to use all modules of the DSS framework. Your project needs to be refreshed every time you add new dependencies.</p>
</div>
</div>
<div class="sect4">
<h5 id="_maven_build_and_profiles">2.1.1.3. Maven build and profiles</h5>
<div class="paragraph">
<p>In order to use a customized bundle of DSS, you may want to build the DSS Core framework modules.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you have implemented a new feature or fixed a bug issue, your pull requests are welcome at our <a href="https://github.com/esig/dss">GitHub Repository</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A simple build of the DSS Maven project can be done with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean install</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All listed commands must be executed from the project directory via a Command Line Interface (CLI).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This installation will run all unit tests present in the modules, which can take more than one hour to do the complete build.</p>
</div>
<div class="paragraph">
<p>In addition to the general build, the framework provides a list of custom profiles, allowing a customized behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>quick - disables unit tests and java-doc check, in order to process the build as quick as possible (takes 2-3 minutes).</p>
</li>
<li>
<p>slow-tests - executes all tests, including time-consuming unit tests.</p>
</li>
<li>
<p>owasp - runs validation of the project and using dependencies according to the <a href="https://nvd.nist.gov">National Vulnerability Database (NVD)</a>.</p>
</li>
<li>
<p>jdk19-plus - executed automatically for JDK version 9 and higher. Provides a support of JDK 8 with newer versions.</p>
</li>
<li>
<p>spotless - used to add a licence header into project files.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Some modules (e.g. <code>dss-utils</code>, <code>dss-crl-parser</code>, etc., see ch. <a href="#SpecificModules">Specific modules</a>) still have to be built completely when using the <code>quick</code> profile.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to run a build with a specific profile, the following command must be executed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean install -P *profile_name*</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_documentation_generation">2.1.1.4. Documentation generation</h5>
<div class="paragraph">
<p>In order to generate HTML and PDF documentation for the DSS project, the <code>dss-cookbook</code> module of the DSS Core must be built with the following command (please, ensure that you are located in the <code>/dss-cookbook</code> directory):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean install -P asciidoctor</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_javadoc_generation">2.1.1.5. Javadoc generation</h5>
<div class="paragraph">
<p>In order to generate <a href="https://ec.europa.eu/cefdigital/DSS/webapp-demo/apidocs/index.html">HTML Javadoc</a>, you will need to build the DSS Core completely.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="DSSDemo">2.1.2. DSS Demonstrations</h4>
<div class="paragraph">
<p>This section explains the build and use requirements for the <a href="https://github.com/esig/dss-demonstrations">DSS Demonstration Applications</a>.</p>
</div>
<div class="sect4">
<h5 id="_requirements_2">2.1.2.1. Requirements</h5>
<div class="paragraph">
<p>The minimal requirements to build/run DSS Demonstrations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 8 and higher (tested up to Java 17) is required;</p>
</li>
<li>
<p>Maven 3.6 and higher (if build required);</p>
</li>
<li>
<p>Tomcat 8.5+ for Java 8 and Tomcat 9+ for Java 9 and higher (for Web-application);</p>
</li>
<li>
<p>Memory and Disk: see minimal requirements for the used JVM. In general the highest available is the best;</p>
</li>
<li>
<p>Operating system: no specific requirements (tested on Windows and Linux).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ready_to_use_solutions">2.1.2.2. Ready to use solutions</h5>
<div class="sect5">
<h6 id="DSSWebApp">2.1.2.2.1. DSS Web Application</h6>
<div class="paragraph">
<p>The ready to use webapp allows testing the different functionalities offered in DSS without needing to dive into the implementation.</p>
</div>
<div class="paragraph">
<p>The DSS demo is available online on the <a href="https://ec.europa.eu/cefdigital/DSS/webapp-demo/home">CEF Digital website</a>.</p>
</div>
<div class="paragraph">
<p>The DSS demo is also available as a ready to use downloadable webapp. To use it, you need to complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/Digital+Signature+Service+-++DSS">Download</a> the webapp as a ZIP folder.</p>
</li>
<li>
<p>Unzip the folder</p>
</li>
<li>
<p>Click on the Webapp-Startup.bat file</p>
</li>
<li>
<p>Wait until this message appears "Server startup in xxx ms"</p>
</li>
<li>
<p>Click on the DSS-Web internet shortcut</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="DSSStandaloneApp">2.1.2.2.2. DSS Standalone Application</h6>
<div class="paragraph">
<p>DSS provides a standalone application which uses JavaFX. The application does not require a server to publish the product. The application can be run locally on a client&#8217;s machine.</p>
</div>
<div class="paragraph">
<p>Download links for the Standalone Application (Windows x64):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://ec.europa.eu/cefdigital/DSS/webapp-demo/downloads/dss-app-minimal-windows-x64.zip">Minimal ZIP (application + bat file)</a>;</p>
</li>
<li>
<p><a href="https://ec.europa.eu/cefdigital/DSS/webapp-demo/downloads/dss-app-complete-windows-x64.zip">Complete ZIP (application + bat file + OpenJDK + JavaFX SDK)</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_maven_build_instructions">2.1.2.3. Maven build instructions</h5>
<div class="paragraph">
<p>The build of the project can be done similarly to the DSS Core framework build with the command <code>mvn clean install</code>.</p>
</div>
<div class="paragraph">
<p>Please, ensure that you build modules that you really need. Ignore, build failures for non-required modules.</p>
</div>
<div class="sect5">
<h6 id="_dss_web_application_build">2.1.2.3.1. DSS Web Application build</h6>
<div class="paragraph">
<p>To build the DSS Web Application the following modules are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dss-mock-tsa;</p>
</li>
<li>
<p>dss-demo-webapp;</p>
</li>
<li>
<p>dss-demo-bundle.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After a successful build, in the directory <code>/dss-demo-bundle/target/</code> you will be able to find two containers: <code>dss-demo-bundle.zip</code> and <code>dss-demo-bundle.tar.gz</code>. Despite the different container type, the content of both containers is the same. After extracting the content, you will need to run the file <code>Webapp-Startup.bat</code> in order to launch the server and the file <code>Webapp-Shutdown.bat</code> to stop the server. After running the server, the web-application will be available at the address <code><a href="http://localhost:8080/" class="bare">http://localhost:8080/</a></code>.</p>
</div>
<div class="paragraph">
<p>If during TL/LOTL loading you experience problems with some particular Trusted Lists, please refer the <a href="#KeyStore">Java Keystore Management</a> chapter for a resolution.</p>
</div>
<div class="paragraph">
<p>The documentation and javadoc will be copied automatically from the built DSS Core and made available on the following addresses respectively:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTML documentation : <code><a href="http://localhost:8080/doc/dss-documentation.html" class="bare">http://localhost:8080/doc/dss-documentation.html</a></code>;</p>
</li>
<li>
<p>PDF documentation :  <code><a href="http://localhost:8080/doc/dss-documentation.pdf" class="bare">http://localhost:8080/doc/dss-documentation.pdf</a></code>;</p>
</li>
<li>
<p>Javadoc : <code><a href="http://localhost:8080/apidocs/index.html" class="bare">http://localhost:8080/apidocs/index.html</a></code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to build a bundle for JDK 17, the following profile can be used from the <code>dss-demo-bundle</code> module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean install -P java17</pre>
</div>
</div>
<div class="paragraph">
<p>This will create a bundle with Tomcat 9.</p>
</div>
</div>
<div class="sect5">
<h6 id="_integration_tests">2.1.2.3.2. Integration tests</h6>
<div class="paragraph">
<p>The <code>dss-demo-webapp</code> module provides a collection of integration tests in order to test the behavior of REST/SOAP web-services. In order to run the tests, a web-server with the DSS Web Application shall be launched and the following profile needs to be executed from the module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean install -P run-integration-test</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_dss_standalone_application_build">2.1.2.3.3. DSS Standalone Application build</h6>
<div class="paragraph">
<p>In order to build the standalone application, the following modules are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dss-mock-tsa;</p>
</li>
<li>
<p>dss-standalone-app;</p>
</li>
<li>
<p>dss-standalone-package.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the build is successful, you will be able to find out the following containers in the directory <code>/dss-standalone-app-package/target/</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dss-standalone-app-package-minimal.zip</code> - contains the application code. Requires JDK ad JavaFX installed on a target machine in order to run the application;</p>
</li>
<li>
<p><code>dss-standalone-app-package-complete.zip</code> - contains the application code, as well as JDK and JavaFX library code. Can be run on a machine without pre-installed libraries.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to launch the application, you will need to extract the archive and run the file <code>dss-run.bat</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dss_framework_structure">2.2. DSS framework structure</h3>
<div class="paragraph">
<p>DSS framework is a Maven multi-module project. See below the specifications about  provided modules within the DSS core.</p>
</div>
<div class="sect3">
<h4 id="MavenModules">2.2.1. Maven modules</h4>
<div class="paragraph">
<p>This chapter provides an overview on modules available within <a href="https://github.com/esig/dss">Source code of DSS Core</a>.</p>
</div>
<div class="sect4">
<h5 id="_shared_modules">2.2.1.1. Shared modules</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-enumerations</dt>
<dd>
<p>Contains a list of all used enumerations in the DSS project.</p>
</dd>
<dt class="hdlist1">dss-alerts</dt>
<dd>
<p>Allows configuration of triggers and handers for arbitrary defined events.</p>
</dd>
<dt class="hdlist1">dss-jaxb-parsers</dt>
<dd>
<p>Contains a list of all classes used to transform JAXB objects/strings to Java objects and vice versa.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_jaxb_model_modules">2.2.1.2. JAXB model modules</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">specs-xmldsig</dt>
<dd>
<p>W3C XSD schema for signatures <a href="http://www.w3.org/2000/09/xmldsig" class="bare">http://www.w3.org/2000/09/xmldsig</a></p>
</dd>
<dt class="hdlist1">specs-xades</dt>
<dd>
<p>ETSI EN 319 132-1 XSD schema for XAdES.</p>
</dd>
<dt class="hdlist1">specs-trusted-list</dt>
<dd>
<p>ETSI TS 119 612 XSD schema for parsing Trusted Lists.</p>
</dd>
<dt class="hdlist1">specs-validation-report</dt>
<dd>
<p>ETSI TS 119 102-2 XSD schema for the Validation report.</p>
</dd>
<dt class="hdlist1">specs-asic-manifest</dt>
<dd>
<p>ETSI EN 319 162 schema for ASiCManifest.</p>
</dd>
<dt class="hdlist1">specs-saml-assertion</dt>
<dd>
<p>OASIS schema for SAML Assertions.</p>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-policy-jaxb</dt>
<dd>
<p>JAXB model of the validation policy.</p>
</dd>
<dt class="hdlist1">dss-diagnostic-jaxb</dt>
<dd>
<p>JAXB model of the diagnostic data.</p>
</dd>
<dt class="hdlist1">dss-detailed-report-jaxb</dt>
<dd>
<p>JAXB model of the detailed report.</p>
</dd>
<dt class="hdlist1">dss-simple-report-jaxb</dt>
<dd>
<p>JAXB model of the simple report.</p>
</dd>
<dt class="hdlist1">dss-simple-certificate-report-jaxb</dt>
<dd>
<p>JAXB model of the simple report for certificates.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_json_validation_modules">2.2.1.3. JSON validation modules</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">specs-jws</dt>
<dd>
<p>JSON Schemas based on the RFC 7515 specifications (<a href="#R05">[R05]</a>).</p>
</dd>
<dt class="hdlist1">specs-jades</dt>
<dd>
<p>ETSI TS 119 182-1 JSON Schemas for JAdES (<a href="#R20">[R20]</a>).</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_utils_modules">2.2.1.4. Utils modules</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-utils</dt>
<dd>
<p>API with utility methods for String, Collection, I/O,&#8230;&#8203;</p>
</dd>
<dt class="hdlist1">dss-utils-apache-commons</dt>
<dd>
<p>Implementation of dss-utils with Apache Commons libraries.</p>
</dd>
<dt class="hdlist1">dss-utils-google-guava</dt>
<dd>
<p>Implementation of dss-utils with Google Guava.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_i18n">2.2.1.5. i18n</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-i18n</dt>
<dd>
<p>a module allowing internationalization of generated reports.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_core_modules">2.2.1.6. Core modules</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-model</dt>
<dd>
<p>Data model used in almost every module.</p>
</dd>
<dt class="hdlist1">dss-crl-parser</dt>
<dd>
<p>API to validate CRLs and retrieve revocation data</p>
</dd>
<dt class="hdlist1">dss-crl-parser-stream</dt>
<dd>
<p>Implementation of dss-crl-parser which streams the CRL.</p>
</dd>
<dt class="hdlist1">dss-crl-parser-x509crl</dt>
<dd>
<p>Implementation of dss-crl-parser which uses the java object X509CRL.</p>
</dd>
<dt class="hdlist1">dss-spi</dt>
<dd>
<p>Interfaces and util classes to process ASN.1 structure, compute digests, etc.</p>
</dd>
<dt class="hdlist1">dss-document</dt>
<dd>
<p>Common module to sign and validate document. This module doen&#8217;t contain any implementation.</p>
</dd>
<dt class="hdlist1">dss-service</dt>
<dd>
<p>Implementations to communicate with online resources (TSP, CRL, OCSP).</p>
</dd>
<dt class="hdlist1">dss-token</dt>
<dd>
<p>Token definitions and implementations for MS CAPI, MacOS Keychain, PKCS#11, PKCS#12.</p>
</dd>
<dt class="hdlist1">validation-policy</dt>
<dd>
<p>Business of the signature&#8217;s validation (ETSI EN 319 102 / TS 119 172-4).</p>
</dd>
<dt class="hdlist1">dss-xades</dt>
<dd>
<p>Implementation of the XAdES signature, augmentation and validation.</p>
</dd>
<dt class="hdlist1">dss-cades</dt>
<dd>
<p>Implementation of the CAdES signature, augmentation and validation.</p>
</dd>
<dt class="hdlist1">dss-jades</dt>
<dd>
<p>Implementation of the JAdES signature, augmentation and validation.</p>
</dd>
<dt class="hdlist1">dss-pades</dt>
<dd>
<p>Common code which is shared between dss-pades-pdfbox and dss-pades-openpdf.</p>
</dd>
<dt class="hdlist1">dss-pades-pdfbox</dt>
<dd>
<p>Implementation of the PAdES signature, augmentation and validation with <a href="https://pdfbox.apache.org/">PDFBox</a>.</p>
</dd>
<dt class="hdlist1">dss-pades-openpdf</dt>
<dd>
<p>Implementation of the PAdES signature, augmentation and validation with <a href="https://github.com/LibrePDF/OpenPDF">OpenPDF (fork of iText)</a>.</p>
</dd>
<dt class="hdlist1">dss-asic-common</dt>
<dd>
<p>Common code which is shared between dss-asic-xades and dss-asic-cades.</p>
</dd>
<dt class="hdlist1">dss-asic-cades</dt>
<dd>
<p>Implementation of the ASiC-S and ASiC-E signature, augmentation and validation based on CAdES signatures.</p>
</dd>
<dt class="hdlist1">dss-asic-xades</dt>
<dd>
<p>Implementation of the ASiC-S and ASiC-E signature, augmentation and validation based on XAdES signatures.</p>
</dd>
<dt class="hdlist1">dss-tsl-validation</dt>
<dd>
<p>Module which allows loading / parsing / validating of LOTL and TSLs.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_webservices">2.2.1.7. WebServices</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-common-remote-dto</dt>
<dd>
<p>Common classes between all remote services (REST and SOAP).</p>
</dd>
<dt class="hdlist1">dss-common-remote-converter</dt>
<dd>
<p>Classes which convert the DTO to DSS Objects.</p>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-signature-dto</dt>
<dd>
<p>Data Transfer Objects used for signature creation/augmentation (REST and SOAP).</p>
</dd>
<dt class="hdlist1">dss-signature-remote</dt>
<dd>
<p>Common classes between dss-signature-rest and dss-signature-soap.</p>
</dd>
<dt class="hdlist1">dss-signature-rest-client</dt>
<dd>
<p>Client for the REST webservices.</p>
</dd>
<dt class="hdlist1">dss-signature-rest</dt>
<dd>
<p>REST webservices to sign (getDataToSign, signDocument methods), counter-sign and augment a signature.</p>
</dd>
<dt class="hdlist1">dss-signature-soap-client</dt>
<dd>
<p>Client for the SOAP webservices.</p>
</dd>
<dt class="hdlist1">dss-signature-soap</dt>
<dd>
<p>SOAP webservices to sign (getDataToSign, signDocument methods), counter-sign and augment a signature.</p>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-server-signing-dto</dt>
<dd>
<p>Data Transfer Objects used for the server signing module (REST and SOAP).</p>
</dd>
<dt class="hdlist1">dss-server-signing-common</dt>
<dd>
<p>Common classes for server signing.</p>
</dd>
<dt class="hdlist1">dss-server-signing-rest</dt>
<dd>
<p>REST webservice for server signing.</p>
</dd>
<dt class="hdlist1">dss-server-signing-rest-client</dt>
<dd>
<p>REST client for server signing (sign method).</p>
</dd>
<dt class="hdlist1">dss-server-signing-soap</dt>
<dd>
<p>SOAP webservice for server signing.</p>
</dd>
<dt class="hdlist1">dss-server-signing-soap-client</dt>
<dd>
<p>SOAP client for server signing (sign method).</p>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-validation-dto</dt>
<dd>
<p>Data Transfer Objects used for signature validation (REST and SOAP).</p>
</dd>
<dt class="hdlist1">dss-validation-common</dt>
<dd>
<p>Common classes between dss-validation-rest and dss-validation-soap.</p>
</dd>
<dt class="hdlist1">dss-validation-rest-client</dt>
<dd>
<p>Client for the REST signature-validation webservices.</p>
</dd>
<dt class="hdlist1">dss-validation-soap-client</dt>
<dd>
<p>Client for the SOAP signature-validation webservices.</p>
</dd>
<dt class="hdlist1">dss-validation-rest</dt>
<dd>
<p>REST webservices to validate a signature.</p>
</dd>
<dt class="hdlist1">dss-validation-soap</dt>
<dd>
<p>SOAP webservices to validate a signature.</p>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-certificate-validation-dto</dt>
<dd>
<p>Data Transfer Objects used for certificate validation (REST and SOAP).</p>
</dd>
<dt class="hdlist1">dss-certificate-validation-common</dt>
<dd>
<p>Common classes between dss-certificate-validation-rest and dss-certificate-validation-soap.</p>
</dd>
<dt class="hdlist1">dss-certificate-validation-rest-client</dt>
<dd>
<p>Client for the REST certificate-validation webservice.</p>
</dd>
<dt class="hdlist1">dss-certificate-validation-soap-client</dt>
<dd>
<p>Client for the SOAP certificate-validation webservice.</p>
</dd>
<dt class="hdlist1">dss-certificate-validation-rest</dt>
<dd>
<p>REST webservice to validate a certificate.</p>
</dd>
<dt class="hdlist1">dss-certificate-validation-soap</dt>
<dd>
<p>SOAP webservice to validate a certificate.</p>
</dd>
</dl>
</div>
<hr>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-timestamp-dto</dt>
<dd>
<p>Data Transfer Objects used for timestamp creation.</p>
</dd>
<dt class="hdlist1">dss-timestamp-remote-common</dt>
<dd>
<p>Common classes between dss-timestamp-remote-rest and dss-timestamp-remote-soap.</p>
</dd>
<dt class="hdlist1">dss-timestamp-remote-rest-client</dt>
<dd>
<p>Client for the REST timestamp webservice.</p>
</dd>
<dt class="hdlist1">dss-timestamp-remote-soap-client</dt>
<dd>
<p>Client for the SOAP timestamp webservice.</p>
</dd>
<dt class="hdlist1">dss-timestamp-remote-rest</dt>
<dd>
<p>REST webservice to create a timestamp.</p>
</dd>
<dt class="hdlist1">dss-timestamp-remote-soap</dt>
<dd>
<p>SOAP webservice to create a timestamp.</p>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="_other_modules">2.2.1.8. Other modules</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">dss-test</dt>
<dd>
<p>Mock and util classes for unit tests.</p>
</dd>
<dt class="hdlist1">dss-cookbook</dt>
<dd>
<p>Samples and documentation of DSS used to generate this documentation.</p>
</dd>
<dt class="hdlist1">dss-jacoco-coverage</dt>
<dd>
<p>Module which is used to collect a test coverage for all modules.</p>
</dd>
<dt class="hdlist1">dss-bom</dt>
<dd>
<p>Module which helps the integration with all DSS modules and the version.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="SpecificModules">2.2.2. Specific modules</h4>
<div class="paragraph">
<p>Some modules of the DSS framework have a specific behavior and has to be handled accordingly.</p>
</div>
<div class="paragraph">
<p>DSS contains a bundle of JAXB-based modules, generating Java classes at runtime based on XSD-schema. When any change is made in the XSD, the classes of the module are being re-generated according to the change. The following modules present this behavior:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>specs-xmldsig;</p>
</li>
<li>
<p>specs-xades;</p>
</li>
<li>
<p>specs-trusted-list;</p>
</li>
<li>
<p>specs-validation-report;</p>
</li>
<li>
<p>specs-asic-manifest;</p>
</li>
<li>
<p>specs-saml-assertion;</p>
</li>
<li>
<p>dss-policy-jaxb;</p>
</li>
<li>
<p>dss-diagnostic-jaxb;</p>
</li>
<li>
<p>dss-detailed-report-jaxb;</p>
</li>
<li>
<p>dss-simple-report-jaxb;</p>
</li>
<li>
<p>dss-simple-certificate-report-jaxb.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Specific modules with JWS and JAdES specifications exist. These modules allow to validate the generated JSON against the related JSON Schema :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>specs-jws;</p>
</li>
<li>
<p>specs-jades.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, as it was explained in the previous section, some modules are required to be built completely in order for their dependent modules to be built when using a quick profile, namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#dssUtils">dss-utils</a>;</p>
</li>
<li>
<p><a href="#dssCrlParser">dss-crl-parser</a>;</p>
</li>
<li>
<p>dss-test;</p>
</li>
<li>
<p><a href="#dssPades">dss-pades</a>;</p>
</li>
<li>
<p>dss-asic-common.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The modules contain common interfaces, used in other DSS modules, as well as unit tests to ensure the same behavior between their implementations.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dss_demonstration_modules">2.2.3. DSS-demonstration modules</h4>
<div class="paragraph">
<p>This chapter provides an overview on modules available within <a href="https://github.com/esig/dss-demonstrations">demonstrations project</a>.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
dss-mock-tsa
</td>
<td class="hdlist2">
<p>Timestamping source which generates fake timestamps from a self-signed certificate.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
sscd-mocca-adapter
</td>
<td class="hdlist2">
<p>Adapter for the MOCCA connection.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-standalone-app
</td>
<td class="hdlist2">
<p>Standalone application which allows signing a document with different formats and tokens (JavaFX).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-standalone-app-package
</td>
<td class="hdlist2">
<p>Packaging module for dss-standalone-app.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-demo-webapp
</td>
<td class="hdlist2">
<p>Demonstration web application which presents basic DSS functionalities.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dss-demo-bundle
</td>
<td class="hdlist2">
<p>Packaging module for dss-demo-webapp.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_electronic_signatures_and_dss">3. Electronic signatures and DSS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DSS (Digital Signature Services) is an open-source software library for electronic signature creation, augmentation and validation. DSS supports the creation, augmentation and verification of interoperable and secure electronic signatures in line with European legislation. In particular, DSS aims to follow the eIDAS Regulation and related standards closely.</p>
</div>
<div class="sect2">
<h3 id="_eu_legislation">3.1. EU legislation</h3>
<div class="paragraph">
<p>In the European Union the following legislation have had a considerable impact on the topic of electronic and digital signatures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the Directive 1999/93/EC of the European Parliament and of the Council of 13 December 1999 on a Community framework for electronic signatures (cf. <a href="#R07">[R07]</a>);</p>
</li>
<li>
<p>Regulation (EU) No 910/2014 of the European Parliament and of the Council of 23 July 2014 on electronic identification and trust services for electronic transactions in the internal market and repealing Directive 1999/93/EC (cf. <a href="#R12">[R12]</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The eIDAS Regulation repealed Directive 1999 and became official on July 1, 2016. A Regulation is a law that applies across all EU Member States (MS). eIDAS aims for interoperability between the EU MS, among others in the field of the electronic signature, by building compatible trust service frameworks.</p>
</div>
<div class="paragraph">
<p>One of the main aspects of the eIDAS Regulation, is that where the Directive mainly covered Certificate Service Providers, the eIDAS Regulation expands on that concept and introduces the new concepts of trust services and trust service providers which is detailed in the next subsection.</p>
</div>
<div class="sect3">
<h4 id="TSP">3.1.1. Trust Service Provider</h4>
<div class="paragraph">
<p>A Trust Service Provider (TSP) is a natural or legal person who provides one or more trust services. A trust service is an electronic service related, among others, to the creation, validation and preservation of electronic signatures, timestamps, and certificates.</p>
</div>
<div class="paragraph">
<p>Given that a TSP can provide a combination of trust services, a TSP can take one or more of the following roles</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a certificate issuer (CA)</p>
</li>
<li>
<p>a time-stamp issuer (TSA)</p>
</li>
<li>
<p>a signature verifier (VA)</p>
</li>
<li>
<p>…</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A TSP can be either a qualified or non-qualified trust service provider. All TSPs no matter if qualified or not have the following obligations and requirements</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Processing of personal data;</p>
</li>
<li>
<p>Notification of security and personal data breaches;</p>
</li>
<li>
<p>Keeping an up-to-date termination plan;</p>
</li>
<li>
<p>Meeting requirements on employed staff and subcontractors (e.g. trainings);</p>
</li>
<li>
<p>Keeping sufficient financial resources and/or liability insurance;</p>
</li>
<li>
<p>Recording and keeping activities related to data accessible;</p>
</li>
<li>
<p>…</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This ensures the validity and security of the trust services that TSPs provide, such as the integrity of the data that was used for certificate and signature creation as well as the security of the signing keys.</p>
</div>
<div class="paragraph">
<p>A qualified trust service provider (QTSP) is a TSP that provides one or more qualified trust services and is included in a Trusted List (cf. <a href="#TrustedLists">Trusted Lists</a>).</p>
</div>
<div class="paragraph">
<p>Some aspects are specific to QTSPs and follow from the requirements of eIDAS</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Undergoing a pre-authorization scheme;</p>
</li>
<li>
<p>Being actively supervised;</p>
</li>
<li>
<p>Undergoing regular audits;</p>
</li>
<li>
<p>Presumption of intention or negligence in case of damage due to failure to comply to the law;</p>
</li>
<li>
<p>Providing a high level of security;</p>
</li>
<li>
<p>Providing legal certainty;</p>
</li>
<li>
<p>Presumption of the integrity of the data;</p>
</li>
<li>
<p>…</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_electronic_and_digital_signatures">3.2. Electronic and digital signatures</h3>
<div class="paragraph">
<p>The terms “Electronic Signature” and “Digital Signature” are often used interchangeably however they are very disctinct concetps as "electronic signature" is a legal concept, whereas "digital signature" is a technical concept that is used to provide a concrete instance of electronic signatures.</p>
</div>
<div class="paragraph">
<p>In the eIDAS Regulation, and electronic signature is defined (legally) as "data in electronic form which is attached to or logically associated with other data in electronic form and which is used by the signatory to sign".</p>
</div>
<div class="paragraph">
<p>An electronic signature does not necessarily guarantee that the signature process is secure nor that it is possible to track the changes that have been brought to the content of a document after it was signed. This depends on the category of the electronic signature. Indeed, beyond the concept of "simple" electronic signatures (SES) the Regulation further defines Advanced Electronic Signatures (AdES) and Qualified Electronic Signatures (QES).</p>
</div>
<div class="paragraph">
<p>A <strong>Simple Electronic Signature</strong> can cover a very broad range of data, such as a name written at the end of an email or an image added to a document.</p>
</div>
<div class="paragraph">
<p>An <strong>Advanced Electronic Signature</strong> is an electronic signature that has the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is uniquely linked to the signatory.</p>
</li>
<li>
<p>It is capable of identifying the signatory.</p>
</li>
<li>
<p>The signatory has the sole control over the data used for the creating signatures.</p>
</li>
<li>
<p>It can detect whether the signed data has been modified since the signature.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <strong>Qualified Electronic Signature</strong> is an AdES that is based on a qualified certificate for electronic signatures (cf. <a href="#DigitalCertificate">Digital certificate</a>) and that has been generated by a qualified signature creation device (QSCD). QES have the same legal value as handwritten signatures. When an electronic signature is a QES, there is a reversal of the burden of proof. There is a presumption that a person has signed until a proof is given that the person did not sign.</p>
</div>
<div class="paragraph">
<p>A <strong>digital signature</strong> is a technical concept that is based on a Public Key Infrastructure (PKI, cf.<a href="#PKI">Simplified PKI model</a>) and  involves, among others, public key cryptography and public key certificates (cf. <a href="#DigitalCertificate">Digital certificate</a>).</p>
</div>
<div class="paragraph">
<p>Digital signatures can be used to ensure the unique identification of the signer, the authenticity of the signature and the integrity of the data. The identification of the signer as well as the authenticity of the signature are guaranteed by decrypting the digital signature value using a public key attested by a public key certificate (cf. <a href="#DigitalCertificate">Digital certificate</a>). The component of the digital signature that allows detecting whether signed data has been tampered with is a cryptographic function called a hash function.</p>
</div>
<div class="paragraph">
<p>"AdES digital signatures" are digital signature formats that have been developped by ETSI to support the eIDAS Regulation and provide a way to create digital signatures that can meet the legal requirements for AdES and QES.</p>
</div>
</div>
<div class="sect2">
<h3 id="DigitalSignatureConcepts">3.3. Digital signatures concepts</h3>
<div class="paragraph">
<p>This section aims to briefly introduce PKI-based digital signature concepts, more specifically concepts related to digital signatures supported by X.509 digital certificates issued by Certification Authorities (CA), and making use of asymmetric cryptography. Such signatures are the kind of signatures that are handled in DSS.</p>
</div>
<div class="paragraph">
<p>For the rest of this section, the creation of a digital signature value is assumed to be the encryption of the digest of a data object using a private key for which there exists a corresponding X.509 public key certificate issued by a CA.</p>
</div>
<div class="paragraph">
<p>For the purpose of introducing those concepts, we will first provide a simplified description of the PKI model in which digital signatures are created. The goal of this model is not to provide an accurate and exhaustive description and definition of a PKI but to provide a basis for introducing the main PKI concepts that are useful to DSS users. Suggestions for improvement are welcomed and can be proposed via PRs in the DSS github.</p>
</div>
<div class="sect3">
<h4 id="PKI">3.3.1. Simplified PKI model</h4>
<div class="paragraph">
<p>A (simplified) description of the PKI model and where DSS is involved in that model is given in the figure below.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/PKI-and-DSS.png" alt="DSS and simplified PKI overview" width="100%" height="100%">
</div>
</div>
<div class="paragraph">
<p>In this simplified model, a PKI is composed of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Certificates</strong>;</p>
</li>
<li>
<p><strong>Certification Authorities (CA)</strong> issuing the certificates;</p>
</li>
<li>
<p><strong>Certificate Revocation Lists (CRL)</strong> issued by CAs; and</p>
</li>
<li>
<p><strong>OCSP responders</strong> providing information on the status of certificates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In turn, DSS within that model, can be used to implement Signature creation applications (SCA) and/or Signature Validation Applications (SVA)</p>
</div>
<div class="paragraph">
<p>Each of those concepts are further detailed in the next sections.</p>
</div>
</div>
<div class="sect3">
<h4 id="DigitalCertificate">3.3.2. Digital certificate</h4>
<div class="paragraph">
<p>As mentioned before, in the present context, digital signatures are supported by public key certificates. <strong>Public key certificates</strong> are data structures that binds an entity to a public key and that are signed by a third party, they provide a proof of authenticity of the public key.</p>
</div>
<div class="paragraph">
<p>The ITU-T X.509 Recommendation is a standard describing (among others) such a data structure, and public key certificates structured as per the specifications provided in that standard are commonly referred to as “X.509 public key certificates”.</p>
</div>
<div class="paragraph">
<p>Furthermore, the IETF published the RFC 5280 (<a href="#R21">[R21]</a>) which specifies a profile for X.509 public key certificates (and certificate revocation lists). For the remainder of this document, X.509 public key certificates are assumed to be profiled as per RFC 5280.</p>
</div>
<div class="paragraph">
<p>Certificates can be end-entity certificates or CA certificates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>End-entity certificates</strong> are certificates issued to entities that are not authorized to issue certificates, for instance a natural person;</p>
</li>
<li>
<p><strong>CA certificates</strong> are certificates issued to entities authorized to issue certificates, also known as Certification Authorities (CA).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certificates have a defined validity period during which the CA having issued the certificate guarantees the correctness of its content. During that validity period, they may however be revoked or suspended, for instance when the entity to which the certificate has been issued has lost control of the corresponding private key.</p>
</div>
<div class="paragraph">
<p>A certificate contains among other things information on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The entity to which the certificate has been issued, also referred to as the Subject;</p>
</li>
<li>
<p>The public key which is bound to the Subject;</p>
</li>
<li>
<p>The entity having issued the certificate (the CA), also referred to as the Issuer;</p>
</li>
<li>
<p>The validity period of the certificate;</p>
</li>
<li>
<p>The location where information on the revocation status of the certificate can be found;</p>
</li>
<li>
<p>Restriction applying to the usage of the public key contained in the certificate;</p>
</li>
<li>
<p>A digital signature created by the issuer of the certificate;</p>
</li>
<li>
<p>…</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="CRLsAndOCSP">3.3.3. CRLs and OCSP</h4>
<div class="paragraph">
<p>As previously mentionned, a certificate can be revoked or suspended. This information is usually provided in the form of a Certificate Revocation List (CRL), or through the Online Certificate Status Protocol (OCSP).</p>
</div>
<div class="paragraph">
<p>A CRL is a list of revoked (and/or suspended) certificates that is digitally signed and published by a CRL issuer. This issuer can be the CA having issued the certificates listed in the CRL, or it can be another CA in which case the CRL is called an “indirect CRL”. RFC 5280 (<a href="#R21">[R21]</a>) provides a profile for X.509 CRLs.</p>
</div>
<div class="paragraph">
<p>The OCSP is a protocol defined in RFC 6960 (<a href="#R22">[R22]</a>) that enables the determination of the (revocation) status of a certificate without the use of a CRL. An OCSP request, containing (among other things) information on the certificate for which the (revocation) status is requested, is sent to a server and a response, containing information of that (revocation) status, is provided by an OCSP responder. OCSP responses are signed by the OCSP responder, and the OCSP responder can be the CA having issued the certificate or another CA in which case the OCSP responder is called a “delegated OCSP responder”.</p>
</div>
<div class="paragraph">
<p><a href="https://datatracker.ietf.org/doc/html/rfc5280#section-6.3">RFC 5280 section 6.3</a> describes an algorithm for the validation of CRLs, while Common PKI v2.0 part 5 section 2.3 (<a href="#R23">[R23]</a>) describes an algorithm for checking the revocation status of a certificate using CRLs and OCSP responses.</p>
</div>
<div class="sect4">
<h5 id="CA">3.3.3.1. Certificate Authority</h5>
<div class="paragraph">
<p>Certification Authorities are entities issuing certificates and guaranteeing the correctness of their content. They manage the whole lifecycle of the certificates they issue, including the revocation services. Throughout this document, they will be denominated as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Issuing CA for the CAs that issue end-entity certificates:</p>
</li>
<li>
<p>Intermediate CA for CAs that issue certificates to other CAs and are not root CAs;</p>
</li>
<li>
<p>Root CA for the CAs that have at least one self-signed certificate.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="TrustAnchors">3.3.3.2. Trust Anchors and Trust Stores</h5>
<div class="paragraph">
<p>Without going into the details and inner workings of the hierarchical trust model (this document does not intend to discuss the soundness of this model, the soundness of transitivity of trust, etc.), when a user is looking to validate a certificate, that is the user needs to decide whether or not it can trust the binding between the public key and the subject of that certificate, it will make use of so called “trust anchors”.</p>
</div>
<div class="paragraph">
<p>A trust anchor, in the context of certificate validation, is a CA that is trusted by the user in such a way that if there exists a valid chain of certificate from that CA to a certificate, the user trusts the correctness of the information contained in that certificate taking into consideration the (revocation) status of that certificate.</p>
</div>
<div class="paragraph">
<p>The wording “valid chain of certificate” used above is voluntarily informal, but it can be more formally defined as meaning that there exists a prospective certification path such that the output of the certification validation path algorithm (see <a href="#CertificatePathValidation">Certificate Chain and Certification Path Validation</a>) provided with, as inputs, that prospective certification path, the trust anchor information and possibly other inputs, is a success indication.</p>
</div>
<div class="paragraph">
<p>Trust anchor information can be, and is often, provided as a (potentially self-signed) public key certificate.</p>
</div>
<div class="paragraph">
<p>A trust store is, in turn, a list of trust anchor information that can be, and is often, a list of directly trusted public key certificates.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_trusted_list_tl">3.3.4. Trusted List (TL)</h4>
<div class="sect4">
<h5 id="EUTL">3.3.4.1. EU MS Trusted List</h5>
<div class="paragraph">
<p>Trusted lists, as they are used in the EU/EEA, are a legal instrument used to provide, among other things, information on the qualified status of trust services.</p>
</div>
<div class="paragraph">
<p>Technically, they take the form of an XML structure formatted as specified in the standard ETSI TS 119 612 (<a href="#R11">[R11]</a>).</p>
</div>
<div class="paragraph">
<p>Trusted lists can be used in a similar way to trust stores in that one can use, for instance, the public key certificates that are listed as the digital identity of qualified trust services issuing qualified certificates as trust anchors for the purpose of validating certificates, however there are significant differences between the usage of trusted lists and the usage of classic trust stores. Below is a non-exhaustive list of such differences:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Trusted lists can be used to determine/confirm the legal type of a certificate i.e. verifying that a certificate is a certificate for electronic signature, for electronic seal or for website authentication, whereas trust store typically do not allow such determination.</p>
</li>
<li>
<p>Trusted list can be used to determine/confirm the qualified status of a certificate;</p>
</li>
<li>
<p>Trusted lists contain the status history of trust services, meaning that they allow the determination/confirmation of whether a certificate was qualified and of a particular type at a time in the past. Trust service entries are never removed from a trusted list whereas compromise of a trust anchor is usually reflected by the removal of the corresponding trust anchor information from a trust store (in a trusted list, this would be reflected by changing the current status of the corresponding trust service, while keeping the status history);</p>
</li>
<li>
<p>Trusted lists frequently (one might argue ‘mostly’) identify trust services issuing certificates through the certificates of issuing CAs, whereas trust store usually contain mostly root CAs.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="LOTL">3.3.4.2. List of Trusted Lists (LOTL)</h5>
<div class="paragraph">
<p>A List of Trusted Lists (LOTL) is a list that contains</p>
</div>
<div class="ulist">
<ul>
<li>
<p>links towards all the published EU MS Trusted Lists;</p>
</li>
<li>
<p>the certificates used to verify the signatures of these trusted lists.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the EU/EEA context, a LOTL is published by the European Commission at a secure location that is made publicly available on the Official Journal of the European Commission (OJEU). It is available in an XML format which is suitable for automated processing. This format of the LOTL is digitally signed/sealed, which allows to assure authenticity and integrity of the LOTL. The signing certificates of the LOTL are also made publicly available in the OJEU.</p>
</div>
<div class="paragraph">
<p>The LOTL is used to authenticate EU MS Trusted Lists and to provide an easy and trustworthy way to access these TLs.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/LOTL-TLs.jpg" alt="LOTL TLs" width="70%" height="70%">
</div>
</div>
<div class="paragraph">
<p>When the LOTL-signing certificates or the location of the LOTL changes, the modification needs to be published by the Commission. The update is done in the form of a “pivot LOTL”, which is a specific instance of a LOTL. Each new modification will create a new pivot LOTL. The pivot LOTLs are grouped in the current LOTL itself, under the &lt; SchemeInformationURI&gt; field. Consulting all the pivot LOTL from the most recent to the oldest gives a trace of all the signing certificates and locations of the LOTL back to the initial ones.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="CertificatePathValidation">3.3.5. Certificate Chain and Certification Path Validation</h4>
<div class="paragraph">
<p>The certificate path validation is an algorithm that seeks to verify the binding between the public key and the subject of a certificate, using trust anchor information. The complete processing is described in <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-6.1">RFC 5280 section 6.1</a>, and as stated there it verifies among other things that that a prospective certification path (a sequence of n certificates) satisfies the following conditions:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>for all x in {1, &#8230;&#8203;, n-1}, the subject of certificate x is the issuer of certificate x+1;</p>
</li>
<li>
<p>certificate 1 is issued by the trust anchor;</p>
</li>
<li>
<p>certificate n is the certificate to be validated (i.e., the target certificate); and</p>
</li>
<li>
<p>for all x in {1, &#8230;&#8203;, n}, the certificate was valid at the time in question.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Although RFC 5280 states that procedures performed to obtain the sequence of certificate that is provided to the certification path validation is outside of its scope, Common PKI v2.0 part 5 section 2.1 (<a href="#R23">[R23]</a>) provides one such possible procedure.</p>
</div>
<div class="paragraph">
<p>An intuitive approach to build a prospective certification path is to start by looking at the “Authority Information Access” (AIA) extension of the target certificate (see <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.2.1">RFC 5280 section 4.2.2.1</a>) which, if present, frequently includes information on how to retrieve the certificate of the issuer of that certificate. Repeating this action on the certificate retrieved can then allow to build a prospective certification path.</p>
</div>
<div class="paragraph">
<p>The wording "certificate chain" is often used interchangeably with "certification path".</p>
</div>
<div class="paragraph">
<p>In ETSI EN 319 102-1 (<a href="#R09">[R09]</a>) however, a prospective certificate chain is defined as a sequence of certificate that satisfies the conditions a. to c. above and for which the trust anchor is trusted according the validation policy in use.</p>
</div>
<div class="paragraph">
<p>An illustration of different certificate chains/certification paths is provided in the figure below.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/certificate-chain-detailed.jpg" alt="Certificate Chain" width="100%" height="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="SignatureCreation">3.3.6. Signature creation</h4>
<div class="sect4">
<h5 id="SignatureCreationProcess">3.3.6.1. Signature creation process</h5>
<div class="paragraph">
<p>Although other schemes exist, we assume here that creating a digital signature value consists in the encryption of a hash computed on the signed data.</p>
</div>
<div class="paragraph">
<p>The standard ETSI EN 319 102-1 clause 4 (<a href="#R09">[R09]</a>) provides a complete conceptual model for the creation of “AdES digital signatures”, but for the sake of simplicity we can extract from this model the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Receiving a (set of) document(s) or a (set of) hash(es) representing those documents, together with other inputs (such as so-called “signed attribute” values e.g. signer’s location, and constraints driving the creation of the signature such as the cryptographic algorithms to be used for the creation of the signature value);</p>
</li>
<li>
<p>Composing the “data to be signed” (DTBS) which is the data object that will be covered by the signature value (including thus the document(s) and attributes to be signed), and the associated “data to be signed formatted” (DTBSF) which can be taken as the format-specific byte-stream on which the signature value will be computed;</p>
</li>
<li>
<p>Creating the “data to be signed representation” (DTBSR) by applying the appropriate hash algorithm;</p>
</li>
<li>
<p>Computing the signature value by encrypting the DTBSR using the appropriate algorithm (this is usually done by activating the private key within a “Signature creation device” (SCDev), that will perform the operation);</p>
</li>
<li>
<p>Formatting the result into a “signed data object” (SDO) complying with the desired signature format (e.g. XAdES, PAdES, etc).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As mentionned above, the activation of the private key and the operation of creating the signature value is assumed to be performed by a specific device. It is in general desirable that this device is a secure (e.g. temper proof) device that require authentication for the activation of the key (e.g. using PIN codes).</p>
</div>
<div class="paragraph">
<p>When the private key contained in that device is controlled by an end-entity, this device is usually called “signature creation device” or <strong>SCDev</strong>. This can be a local SCDev such as a smartcard, but it can also be a remote SCDev managed by a CA or TSP.</p>
</div>
<div class="paragraph">
<p>When the private key is used by a CA for signing certificates, this device is usually called a “hardware security module” or <strong>HSM</strong>.</p>
</div>
<div class="paragraph">
<p>Frequently, when the private key is under the control of a legal entity (such as when the key is used to create electronic seals) the device is also called an HSM.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="SignatureValidationModel">3.3.7. Signature validation (introduction)</h4>
<div class="paragraph">
<p>Taking a very (or over) simplified model, validating a digital signature can be seen as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On one hand, verifying the cryptographic validity of the digital signature value (part of it consisting in decrypting the digital signature value and comparing the decrypted value with the hash of the signed data).</p>
</li>
<li>
<p>On the other hand, verifying the validity of the signing certificate (see certification path validation).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We’ll see that even such a simplified model is useful for the purpose of introducing common concepts in digital signature validation.</p>
</div>
<div class="paragraph">
<p>Let’s imagine that we want to validate a digital signature and the time when this validation occur is denoted as T<sub>val</sub>.</p>
</div>
<div class="paragraph">
<p>If the signing certificate successfully passes the certification path validation at T<sub>val</sub>, and the digital signature value is cryptographically valid, one can then say that the digital signature is valid at T<sub>val</sub>.</p>
</div>
<div class="paragraph">
<p>Now, if computing the hash of the signed data does not yield the same value as the decryption of the signature value, one can then say that the digital signature is invalid.</p>
</div>
<div class="paragraph">
<p>Beyond valid and invalid digital signature however, there are a lot of cases when one cannot determine the validity of a digital signature. Below are some examples where one cannot conclude that a digital signature is valid or invalid, in which case the validity status of the signature is indeterminate.</p>
</div>
<div class="paragraph">
<p>Let’s imagine that at T<sub>val</sub>, when we are trying to access the certification status information, that information is unavailable (e.g. the CRL cannot be downloaded, the OCSP responder is unavailable). Then it is not possible, at T<sub>val</sub>, to determine whether the signing certificate is valid or not because at that time we are lacking information to conclude on that validity status. Because the validity of the signing certificate cannot be determined, the validity of the overall signature cannot be determined either and the validity of the signature is indeterminate. However, this status is only indeterminate because we do not have the information that would allow us to conclude, retrying to validate the signature with more information (e.g. at a time when the CRLs can be downloaded) could result in a definite valid or invalid status.</p>
</div>
<div class="paragraph">
<p>A more complex example is when, at T<sub>val</sub>, revocation information indicates that the signing certificate is revoked since a time indicated as T<sub>rev</sub> (which is thus &lt; T<sub>val</sub>).</p>
</div>
<div class="paragraph">
<p>Then at T<sub>val</sub>, we can only conclude that the signing certificate is revoked and thus the signature cannot be determined as valid at T<sub>val</sub>. However, this does not mean necessarily that the signature was created when the signing certificate was revoked, it may very well be that the signature was created at a time prior to T<sub>rev</sub> and that, should we have validated the signature at that time, the validation would have been successful. Therefore we cannot conclude that the signature is invalid because we do not know in a definite manner if the signature was created before the revocation of the signing certificate.</p>
</div>
<div class="paragraph">
<p>For instance, if we had a proof that the signature existed before T<sub>rev</sub>, such as a signature timestamp indicating a time T<sub>poe</sub> &lt; T<sub>rev</sub>, then using that proof of existence (POE) we can conclude that the signature was created before the signing certificate was revoked and this could allow us to produce a definite conclusion.</p>
</div>
<div class="paragraph">
<p>On the other hand, if we had a proof that the signature could not have existed before T<sub>rev</sub>, such as a content timestamp indicating a time T<sub>cnt</sub> &gt; T<sub>rev</sub> (a content timestamp is necessarily created before the digital signature value), then we could definitely conclude that the signing certificate was revoked when the digital signature was created and thus that the digital signature is invalid.</p>
</div>
<div class="paragraph">
<p>Another issue that can be illustrated here is when one creates a digital signature using cryptographic algorithms that are not considered secure: In such a case, it may be possible for an malicious actor to create counterfeited signed documents.</p>
</div>
<div class="paragraph">
<p>When validating a signature, it is therefore necessary to verify that the signature was created using cryptographic algorithms and parameters that are considered as secure. This is usually done by comparing a POE of the digital signature value with a sunset date for the cryptographic algorithms and parameters involved. A sunset date for a cryptographic algorithm and/or parameter is called a cryptographic constraint, and the application validating the signature usually keeps a set of such dates and cryptographic algorithms and parameters; this set is what is called the set of cryptographic constraints.</p>
</div>
<div class="paragraph">
<p>In general, the validation of a signature is made against a set of constraints, which the cryptographic constraints are a part of, that is also sometimes referred to as a signature validation policy.</p>
</div>
<div class="paragraph">
<p>The standard ETSI EN 319 102-1 specifies a complete validation model and procedures for the validation of “AdES digital signatures”, which are implemented in DSS. The result of a validation process performed according to those procedures is a validation report and an indication which can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TOTAL-PASSED</code> indicating that the signature has passed verification and it complies with the signature validation policy.</p>
</li>
<li>
<p><code>INDETERMINATE</code> indicating that the format and digital signature verifications have not failed but there is insufficient information to determine if the electronic signature is valid.</p>
</li>
<li>
<p><code>TOTAL_FAILED</code> indicating that either the signature format is incorrect or that the digital signature value fails the verification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each of the validation checks/constraint (e.g. signature format, signing certificate validity), the validation process must provide information justifying the reasons for the resulting status indication as a result of the check against the applicable constraints. In addition, the ETSI standard defines a consistent and accurate way for justifying statuses under a set of sub-indications. This allows the user to determine whether the signature validation has succeeded or not and it helps him find out why.</p>
</div>
<div class="paragraph">
<p>The following table presents the indications and sub-indications that can be encountered at completion of a signature validation process. For a detailed description of their meaning, refer to ETSI EN 319 102-1 (<a href="#R09">[R09]</a>).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Signature validation indications and sub-indications</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">Indication</th>
<th class="tableblock halign-center valign-middle">Sub-indication</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">TOTAL-PASSED</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TOTAL-FAILED</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FORMAT_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">HASH_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">SIG_CRYPTO_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">REVOKED</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="19"><p class="tableblock">INDETERMINATE</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">SIG_CONSTRAINTS_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CHAIN_CONSTRAINTS_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CERTIFICATE_CHAIN_GENERAL_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CRYPTO_CONSTRAINTS_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">EXPIRED</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">NOT_YET_VALID</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">POLICY_PROCESSING_ERROR</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">SIGNATURE_POLICY_NOT_AVAILABLE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">TIMESTAMP_ORDER_FAILURE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">NO_SIGNING_CERTIFICATE_FOUND</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">NO_CERTIFICATE_CHAIN_FOUND</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">REVOKED_NO_POE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">REVOKED_CA_NO_POE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">OUT_OF_BOUNDS_NO_POE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CRYPTO_CONSTRAINTS_FAILURE_NO_POE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">NO_POE</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">TRY_LATER</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">SIGNED_DATA_NOT_FOUND</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">GENERIC</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Timestamps">3.3.8. Timestamping</h4>
<div class="paragraph">
<p>As illustrated in <a href="#SignatureValidationModel">Signature validation (introduction)</a>, validating a signature sometimes require a proof of existence of that signature at a given time.</p>
</div>
<div class="paragraph">
<p>Such proof of existence can be given in the form of a <strong>timestamp</strong>.</p>
</div>
<div class="paragraph">
<p>A digital timestamp is an assertion of proof that a data object existed at (or before) a particular date. This usually takes the form of a binding between a hash of a data object and a date and time issued and signed by a trustworthy timestamping authority.</p>
</div>
<div class="paragraph">
<p>When signing digitally, a date and time is already included into the signature but it corresponds to the computer’s local time. The latter can easily be modified prior to signing so that the time of signing is not the actual one. Thus, this signing time cannot be trusted. A trustworthy digital timestamp shall be used to prove existence of the signature (and its associated data) at a certain point in time.</p>
</div>
<div class="paragraph">
<p>This principle exists for handwritten signatures too. When a document is signed manually, it is done in the presence of a trustworthy notary, who verifies not only the identity of the signer but also the date and time of the signature.</p>
</div>
<div class="paragraph">
<p>Before explaining the timestamping process, let us define some concepts that are involved in this process</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Timestamp Authority (TSA) is a Trust Service Provider (cf. <a href="#TSP">Trust Service Provider</a>) that creates timestamp tokens using one or more Timestamping Units. The TSA must comply with the IETF RFC 3161 specifications (cf. <a href="#R08">[R08]</a>).</p>
</li>
<li>
<p>A Timestamping Unit (TU) is a set of hardware and software that contains a single signing key used by a TSA.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore, in the context of digital signatures, we usually distinguish timestamps depending on the data for which they provide a proof of existence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A content timestamp is a timestamp that is computed on the original data that is signed by a signature. It provides a proof of existence of the original data but not of the signature.</p>
</li>
<li>
<p>A signature timestamp is a timestamp that is computed on the digital signature value (in some case on the whole signed data object). It provides a proof of existence of the signature value.</p>
</li>
<li>
<p>An archive timestamp is a timestamp that is computed on the validation material of a signature (that is, the data necessary to validate a signature such as CRLs, OCSP responses, certificate chain, etc). They at least provide a proof of existence of that validation material, but as they are frequently in fact computed on the whole signed data object in which that validation material has been added, they often provide a proof of existence of the original data, signature value, signature timestamp, validation material, and possible other archive timestamps that are covered by them</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Timestamping, the process of adding a timestamp to a signature, can be broken down into the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The user creates a hash of the data for which a timestamp assertion is required(e.g. signature value).</p>
</li>
<li>
<p>The user sends the hash and the digest algorithm to a TSA.</p>
</li>
<li>
<p>The TSA groups the hash, the time of stamping (current date and time) and the identity of the TSA and signs it with a private key contained in a TU.</p>
</li>
<li>
<p>The timestamp token resulting from the previous step is returned to the client.</p>
</li>
<li>
<p>The timestamp token is added to the signature of the data that was sent as a hash in the first step.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>An illustration of that process for the creation of a signature timestamp is provided below.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Timestamp.jpg" alt="Timestamp" width="100%" height="100%">
</div>
</div>
<div class="paragraph">
<p>The timestamp token created by a TSA can be considered as trustworthy because</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the TSA is independent from the signing process;</p>
</li>
<li>
<p>the clock of the TSA is synchronized with an authoritative time source;</p>
</li>
<li>
<p>the timestamp is digitally signed by the TSA;</p>
</li>
<li>
<p>the TSA shall follow strict specifications.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_multiple_signatures">3.3.9. Multiple signatures</h4>
<div class="paragraph">
<p>Up until now, we only discussed the creation of a single signature. However, in most cases multiple signatures need to be created. In such cases, it is useful to note that multiple signatures can be created in parallel or in a sequential order.</p>
</div>
<div class="sect4">
<h5 id="ParallelSignatures">3.3.9.1. Parallel signatures</h5>
<div class="paragraph">
<p>Parallel signatures are stand-alone, mutually independent signatures where the ordering of the signatures is not important. All the involved parties can receive the data at the same time and sign in any order. The computation of these signatures is performed on exactly the same hash data but using different private keys associated to the different signers. The only dependance between the parallel signatures is that they shall all be present and valid for the associated data to be validly signed.</p>
</div>
<div class="paragraph">
<p>The following schema illustrates the creation of parallel signatures:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/parallel-signatures.jpg" alt="Parallel Signatures" width="60%" height="60%">
</div>
</div>
</div>
<div class="sect4">
<h5 id="SequentialSignatures">3.3.9.2. Sequential signatures</h5>
<div class="paragraph">
<p>Sequential signatures are mutually dependent signatures where the ordering of the signatures is important. A fixed signing order is defined and the next signer in the chain shall not sign before the preceding signers have signed the data. The computation of these signatures is not performed on the same data. A signer that is further in the signing chain will sign the initial data previously signed by the signers preceding him in the chain. Each signer uses his own private key to sign.</p>
</div>
<div class="paragraph">
<p>The following schema illustrates the creation of sequential signatures:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/sequential-signatures.jpg" alt="Sequential Signatures" width="80%" height="80%">
</div>
</div>
</div>
<div class="sect4">
<h5 id="CounterSignatures">3.3.9.3. Counter signatures</h5>
<div class="paragraph">
<p>A counter signature is an additional signature applied on data that has already been signed previously. This type of signature is used to show approval of the data and signature, to confirm the authenticity of the data. The computation of a counter signature is performed on the signed data and it is added to the signature as an unsigned attribute, i.e. added after initial signature creation.</p>
</div>
<div class="paragraph">
<p>Counter signatures are often created by trustworthy entities such as notaries, doctors or attorneys. Possible use cases are rental and mortgage applications, health documents, passports and visas.</p>
</div>
<div class="paragraph">
<p>The following schema illustrates the creation of counter signatures:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/counter-signatures.jpg" alt="Counter Signatures" width="60%" height="60%">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="SignaturePolicies">3.3.10. Signature Applicability Rules / Signature Policy</h4>
<div class="paragraph">
<p>The term "signature policy" is often used to refer to "Signature Applicability Rules", that is, a set of <strong>rules</strong> for the creation, validation and long-term management of one (or more) electronic signature(s).</p>
</div>
<div class="paragraph">
<p>A Signature Policy, in that meaning, <strong>contains</strong> general information such as</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the identifier of the signature policy</p>
</li>
<li>
<p>the name of the signature policy issuer</p>
</li>
<li>
<p>the date of issuance of the signature policy</p>
</li>
<li>
<p>the signing period</p>
</li>
<li>
<p>the field of application</p>
</li>
<li>
<p>…</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A Signature Policy is composed of <strong>three main parts</strong> that define technical and procedural requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Signature Creation Policy: requirements for the signer in creating a signature;</p>
</li>
<li>
<p>Signature Validation Policy: requirements for the verifier when validating a signature;</p>
</li>
<li>
<p>Signature (LTV) Management Policy: requirements for the long term management and preservation of a signature.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A signature policy is a way of <strong>expressing</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>who may sign</p>
</li>
<li>
<p>in what capacity an entity may sign</p>
</li>
<li>
<p>what data is being signed</p>
</li>
<li>
<p>in what circumstances the data is signed</p>
</li>
<li>
<p>why the data is being signed (i.e. what are the consequences).</p>
</li>
<li>
<p>the purpose for the signature</p>
</li>
<li>
<p>the context in which the signature will be used</p>
</li>
<li>
<p>the means for the creation , verification and long-term management of an electronic signature</p>
</li>
<li>
<p>the means for reproducing the formalities of signing</p>
</li>
<li>
<p>the requirements imposed on or committing the involved actors</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The exact information contained in a signature policy will depend on the use cases of the signature and on the involved parties as the signature policy can be negotiated between them. Therefore, it is not possible to define a single template policy to cover all use cases.</p>
</div>
<div class="paragraph">
<p>Having a signature policy, and thus all the above-mentioned information, available in a signature has several <strong>advantages</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It allows keeping a trace of the decisions that were made during the analysis of the signatures that will need to be created.</p>
</li>
<li>
<p>It allows a signature to be legally enforceable in any Member State</p>
</li>
<li>
<p>It makes the signature workflow transparent to all involved parties. This enhances trust in electronic signatures that comply with a signature policy.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Parties involved</strong> in a signature policy are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Signature policy issuer: a legal/natural entity that sets the rules that compose the signature policy.</p>
</li>
<li>
<p>Signature policy users: natural persons that can be one of the two following types of entities:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Signer: creates an electronic signature</p>
</li>
<li>
<p>Verifier: ensures the authenticity of the policy and decides whether the signed data is valid or not</p>
</li>
</ol>
</div>
</li>
<li>
<p>Trust Service Provider(s)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ETSI ESI has developped several standards to express signature applicability rules or "signature policy" in two <strong>forms</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In a human readable form: It can be assessed to meet the requirements of the legal and contractual context in which it is being applied. (cf. ETSI TS 119 172-1 <a href="#R17">[R17]</a>)</p>
</li>
<li>
<p>In a machine processable form (XML or ASN.1): To facilitate its automatic processing using the electronic rules. (cf. ETSI TS 119 172-2 <a href="#R18">[R18]</a> and ETSI TS 119 172-3 <a href="#R19">[R19]</a>)</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_signature_policy_at_creation_and_validation">3.3.10.1. Signature policy at creation and validation</h5>
<div class="paragraph">
<p>During signature <strong>creation</strong>, a signature creation policy can be added to the signature as a signed attributes of the signature. Signed attributes are information that can only be included upon signature creation and that cannot be added at a later point in the life of the signature. The signature creation policy can be added to the signature indirectly as a reference which is composed of the hash value of the policy and the hash algorithm that was used to hash the policy, or directly when it is in a machine processable form.</p>
</div>
<div class="paragraph">
<p>During signature <strong>validation</strong>, a mapping between acceptable signature creation policies and their corresponding
signature validation policies can be provided to the signature validation application (SVA). If the signature contains one signature creation policy identifier, which is part of the list of mappings, the SVA
can then apply the corresponding validation policy during validation.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resources">3.4. Resources</h3>
<div class="paragraph">
<p>Certain resources have been developed to improve the adoption of the eIDAS Regulation as well as improve information sharing about the eIDAS Regulation and related concepts.</p>
</div>
<div class="paragraph">
<p>The <a href="https://esignature.ec.europa.eu/efda/home/#/screen/home">EU Trust Services Dashboard</a> (EU TSD) is such a resource. It "proposes a centralized platform that enables interested parties and Digital Single Market players to easily and transparently access information and tools related to the trust services chapter of eIDAS".</p>
</div>
<div class="paragraph">
<p>It contains among others a <a href="https://esignature.ec.europa.eu/efda/tl-browser/#/screen/home">Trusted List Browser</a> to browse through the trusted lists of the different EU Member States.</p>
</div>
<div class="paragraph">
<p><a href="https://ec.europa.eu/futurium/en/content/eidas-implementing-acts.html">eIDAS implementing acts</a> have been issued and adopted by the Commission:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Commission Implementing Decision (EU) 2015/296: procedural arrangements for cooperation between Member States on electronic identification</p>
</li>
<li>
<p>Commission Implementing Decision (EU) 2015/1501: on the interoperability framework</p>
</li>
<li>
<p>Commission Implementing Decision (EU) 2015/1502: on setting out minimum technical specifications and procedures for assurance levels for electronic identification means</p>
</li>
<li>
<p>Commission Implementing Decision (EU) 2015/1984: circumstances, formats and procedures of notification</p>
</li>
<li>
<p>Commission Implementing Regulation (EU) 2015/806: specifications relating to the form of the EU trust mark for qualified trust services</p>
</li>
<li>
<p>Commission Implementing Decision (EU) 2015/1505: technical specifications and formats relating to trusted lists</p>
</li>
<li>
<p>Commission Implementing Decision (EU) 2015/1506: specifications relating to formats of advanced electronic signatures and advanced seals to be recognised by public sector bodies</p>
</li>
<li>
<p>Commission Implementing Decision (EU) 2016/650: standards for the security assessment of qualified signature and seal creation devices</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ETSI has developed standards that can be followed to be compliant with the eIDAS Regulation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_digital_signatures_in_dss">3.5. Digital signatures in DSS</h3>
<div class="sect3">
<h4 id="_tokens_in_dss">3.5.1. Tokens in DSS</h4>
<div class="paragraph">
<p>The Token class is the base class for the different types of tokens used in the process of signature validation which are certificates, OCSPs, CRLs and timestamps. These tokens can be described as follows</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CertificateToken:</strong> Whenever the signature validation process encounters an X509Certificate a certificateToken is created. This class encapsulates some frequently used information: a certificate comes from a certain context (Trusted List, CertStore, Signature), has revocation data, etc. To expedite the processing of such information, they are kept in cache.</p>
</li>
<li>
<p><strong>RevocationToken:</strong> Represents a revocation data token. It can be a CRLToken or an OCSPToken.</p>
<div class="ulist">
<ul>
<li>
<p><strong>CRLToken:</strong> Represents a CRL and provides the information about its validity.</p>
</li>
<li>
<p><strong>OCSPToken:</strong> OCSP Signed Token which encapsulate BasicOCSPResp (BC).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>TimestampToken:</strong> SignedToken containing a TimeStamp.</p>
<div class="ulist">
<ul>
<li>
<p><strong>PdfTimestampToken:</strong> Specific class for a PDF TimestampToken</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_compliance_to_etsi_standards">3.5.2. Compliance to ETSI standards</h4>
<div class="paragraph">
<p>XAdES digital signatures are compliant with ETSI EN 319 132 part 1-2 (<a href="#R01">[R01]</a>).</p>
</div>
<div class="paragraph">
<p>CAdES digital signatures are compliant with ETSI EN 319 122 part 1-2 (<a href="#R02">[R02]</a>).</p>
</div>
<div class="paragraph">
<p>PAdES digital signatures are compliant with ETSI EN 319 142 part 1-2 (<a href="#R03">[R03]</a>).</p>
</div>
<div class="paragraph">
<p>JAdES digital signatures are compliant with ETSI TS 119 182 part 1 (<a href="#R05">[R05]</a>).</p>
</div>
<div class="paragraph">
<p>ASiC signature containers are compliant with ETSI EN 319 162 part 1-2 (<a href="#R04">[R04]</a>).</p>
</div>
<div class="paragraph">
<p>Creation and validation of AdES digital signatures are compliant with ETSI EN 319 102-1 (<a href="#R09">[R09]</a>) and ETSI TS 119 102-2 (<a href="#R13">[R13]</a>).</p>
</div>
<div class="paragraph">
<p>The determination of the certificate qualification is compliant with ETSI TS 119 172-4 (<a href="#R10">[R10]</a>).</p>
</div>
<div class="paragraph">
<p>Trusted lists processes are compliant with ETSI TS 119 612 (<a href="#R11">[R11]</a>).</p>
</div>
<div class="paragraph">
<p>Procedures for using and interpreting EU Member States national trusted lists, such as determining the qualified status of a timestamp or of an SSL certificate, are compliant with ETSI TS 119 615 (<a href="#R14">[R14]</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_out_of_the_eu_context">3.5.3. Out of the EU context</h4>
<div class="paragraph">
<p>DSS is not limited to EU contexts. It can be used in non-EU contexts with all its basic functions, i.e. signature, augmentation, validation, etc.</p>
</div>
<div class="paragraph">
<p>An example would be the configuration of trust anchors (see section <a href="#TrustAnchorConfiguration">Trust anchor configuration from a certificate store</a>). The certificate sources can be configured from a TrustStore (kind of keystore which only contains certificates), a trusted list and/or a list of trusted lists.
In case of an EU context you could use any of these three trust anchors.
For a non-EU context you could use a trust store or a non-EU trusted list.
However, non-EU TLs are supported by DSS only if they have the same XML structure as EU TLs, i.e. if they are compliant with the XSD schema. Another constraint is that there is no guarantee for a proper qualification determination as the non-EU TL shall also be compliant with EU regulations.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_signature_creation">4. Signature creation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ades_specificities">4.1. AdES specificities</h3>
<div class="sect3">
<h4 id="_existing_formats">4.1.1. Existing formats</h4>
<div class="paragraph">
<p>The different formats of the digital signature make possible to cover a wide range of real live cases of use of this technique. Thus, we distinguish the following formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>XAdES</strong> - for XML Advanced Electronic Signatures (cf. <a href="#R01">[R01]</a>);</p>
</li>
<li>
<p><strong>CAdES</strong> - for CMS Advanced Electronic Signatures (cf. <a href="#R02">[R02]</a>);</p>
</li>
<li>
<p><strong>PAdES</strong> - for PDF Advanced Electronic Signatures (cf. <a href="#R03">[R03]</a>);</p>
</li>
<li>
<p><strong>JAdES</strong> - for JSON Advanced Electronic Signatures (cf. <a href="#R05">[R05]</a>);</p>
</li>
<li>
<p><strong>ASIC</strong> - for Associated Signature Containers (cf. <a href="#R04">[R04]</a>). XAdES and CAdES combinations are possible.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_signature_profiles">4.1.2. Signature profiles</h4>
<div class="paragraph">
<p>To ensure interoperability of electronic signatures in the EU, the eIDAS Regulation has declared through the Commission Implementing Decision (EU) 2015/1506 (cf. <a href="#R16">[R16]</a>) that the advanced electronic signatures in the EU shall comply with the baseline standards defined by the following ETSI technical specifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XAdES Baseline Profile: ETSI TS 103171 v.2.1.1</p>
</li>
<li>
<p>CAdES Baseline Profile: ETSI TS 103173 v.2.2.1</p>
</li>
<li>
<p>PAdES Baseline Profile: ETSI TS 103172 v.2.2.2</p>
</li>
<li>
<p>ASiC Baseline Profile: ETSI TS 103174 v.2.2.1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The baseline profile for a certain signature format provides the basic features required to assure interoperability in the EU for that format. Each baseline profile defines four different levels that correspond to the four signature classes described in the ETSI standard EN 319 102-1 (cf. <a href="#R09">[R09]</a>) and which are described in the following section.</p>
</div>
<div class="paragraph">
<p>Before the introduction of the baseline profiles, old extended profiles were used.
Below is a comparative table of old extended profiles and new baseline profiles for each signature format:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Signature supported profiles</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle" colspan="2">XAdES</th>
<th class="tableblock halign-center valign-middle" colspan="2">CAdES</th>
<th class="tableblock halign-center valign-middle" colspan="2">PAdES</th>
<th class="tableblock halign-center valign-middle">JAdES</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><strong>EXTENDED</strong></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><strong>BASELINE</strong></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><strong>EXTENDED</strong></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><strong>BASELINE</strong></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><strong>EXTENDED</strong></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><strong>BASELINE</strong></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><strong>BASELINE</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-E-BES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">XAdES-B-B</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-E-BES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">CAdES-B-B</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">PAdES-E-BES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">PAdES-B-B</p></td>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">JAdES-B-B</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-E-EPES</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-E-EPES</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">PAdES-E-EPES</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-E-T</p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock">XAdES-B-T</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-E-T</p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock">CAdES-B-T</p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock">PAdES-B-T</p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock">JAdES-B-T</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-E-C</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-E-C</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-E-X</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-E-X</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-E-X-L</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-B-LT</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-E-X-L</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-B-LT</p></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">PAdES-B-LT</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">JAdES-B-LT</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-E-A</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XAdES-B-LTA</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-E-A</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES-B-LTA</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">PAdES-E-LTV</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">PAdES-B-LTA</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">JAdES-B-LTA</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The DSS framework is compatible with the baseline profiles. However, it is not possible to use the extended profiles for signing purpose except for XAdES-E-A/C/X/XL. The validation of the signature has a basic support of old profiles.</p>
</div>
</div>
<div class="sect3">
<h4 id="SignatureClasses">4.1.3. Signature classes/levels</h4>
<div class="paragraph">
<p>The ETSI standard EN 319 102-1 (cf. <a href="#R09">[R09]</a>) defines four conformance classes to address the need to protect the validity of the signature in time. Henceforth, to denote the class of the signature the word "level" will be used. Follows the list of profiles implementing the four classes defined in the standard:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AdES-BASELINE-<strong>B</strong>: Profile implementing the signature class <em>Basic Signature</em><br>
The lowest and simplest version containing at least a signature value, a reference to or a copy of the signing certificate as a signed attribute, and optionally other signed or unsigned attributes.</p>
</li>
<li>
<p>AdES-BASELINE-<strong>T</strong>: Profile implementing the signature class <em>Signature with time</em><br>
A timestamp regarding the time of signing is added to protect against repudiation.</p>
</li>
<li>
<p>AdES-BASELINE-<strong>LT</strong>: Profile implementing the signature class <em>Signature with Long-Term Validation Material</em><br>
All the material or references to material required for validating the signature are embedded to allow verification in future even if their original source is not available. For example, this level has to prove that the certification path was valid, at the time of the validation of the signature, up to a trust point according to the naming constraints and the certificate policy constraints from the "Signature Validation Policy".</p>
</li>
<li>
<p>AdES-BASELINE-<strong>LTA</strong>: Profile implementing the signature class <em>Signature providing Long Term Availability and Integrity of Validation Material</em><br>
By using periodical timestamping (e.g. each year), the availability or integrity of the validation data is maintained. The validity could be limited due to cryptographic obsolescence of the algorithms, keys and parameters used, or due to expiration or revocation of the validation material. The <code>AdES-BASELINE-LTA</code> augmentation adds additional time-stamps for archiving signatures in a way that they are still protected, but also to be able to prove that the signatures were valid at the time when the used cryptographic algorithms were considered safe. Additional validation data can be included too.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The old levels -E-BES and -E-EPES are not supported anymore when signing. The old levels -E-C, -E-X, -E-XL, -E-A are supported only for XAdES.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following schema from the ETSI standard EN 319 102-1 (cf. <a href="#R09">[R09]</a>) illustrates the different classes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/signature-classes.jpg" alt="classes" width="100%" height="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="Packaging">4.1.4. Signature packaging</h4>
<div class="paragraph">
<p>When signing data, the resulting signature needs to be linked with the data to which it applies. This can be done either by creating a data set which combines the signature and the data (e.g. by enveloping the data with the signature or including a signature element in the data set) or placing the signature in a separate resource and having some external means for associating the signature with the data.</p>
</div>
<div class="paragraph">
<p>The choice is not obvious, because in one case the signature will alter the signed document and in the other case it is possible to lose the association between the signed document and its signature.</p>
</div>
<div class="paragraph">
<p>The following types of packaging can be defined for various signature formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ENVELOPED :</strong> when the signature applies to data that surround the rest of the document;</p>
</li>
<li>
<p><strong>ENVELOPING :</strong> when the signed data form a sub-element of the signature itself;</p>
</li>
<li>
<p><strong>DETACHED :</strong> when the signature relates to the external resource(s) separated from it;</p>
</li>
<li>
<p><strong>INTERNALLY-DETACHED :</strong> when the signature and the related signed data are both included in a parent element (only XML).</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sig-creation-packaging.jpg" alt="packaging" width="100%" height="100%">
</div>
</div>
<div class="paragraph">
<p>More information about packaging use in combination with available formats can be found in <a href="#SignatureProfileGuide">Signature profile guide</a>.</p>
</div>
<div class="sect4">
<h5 id="SignatureProfileGuide">4.1.4.1. Signature profile guide</h5>
<div class="paragraph">
<p>Below you can find a table specifying various signature possibilities with available in DSS signature&#8217;s profiles/formats.
The vertical column specifies available signature profiles and their extensions. The horizontal row specifies types of documents to be signed with the formats.</p>
</div>
<div style="page-break-after: always;"></div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. File formats and Signature types conformance</caption>
<colgroup>
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3333%;">
<col style="width: 8.3337%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle" colspan="3">Signature profiles</th>
<th class="tableblock halign-center valign-middle">XML</th>
<th class="tableblock halign-center valign-middle">JSON</th>
<th class="tableblock halign-center valign-middle">PDF</th>
<th class="tableblock halign-center valign-middle">Binary</th>
<th class="tableblock halign-center valign-middle">Digest</th>
<th class="tableblock halign-center valign-middle">Multiple files</th>
<th class="tableblock halign-center valign-middle">Multiple signatures</th>
<th class="tableblock halign-center valign-middle">Counter signature</th>
<th class="tableblock halign-center valign-middle">Stand-alone timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="10"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Enveloping</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Base64 encoded</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Embed XML</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XML only</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Manifest</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Canonicalization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XML only</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Enveloped</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">enveloped transformation</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">based on XPath</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">based on Filter2</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Canonicalization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XML only</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" colspan="2"><p class="tableblock">Detached</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" colspan="2"><p class="tableblock">Internally Detached</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">XML only</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-middle" colspan="2"><p class="tableblock">Enveloping</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" colspan="2"><p class="tableblock">Detached</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">PAdES</p></td>
<td class="tableblock halign-center valign-middle" colspan="2"><p class="tableblock">Enveloped</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="6"><p class="tableblock">JAdES</p></td>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock">Enveloping</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Compact Serialization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Flattened JSON Serialization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">JSON Serialization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="3"><p class="tableblock">Detached</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Compact Serialization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">SigD only</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Flattened JSON Serialization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">SigD only</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">JSON Serialization</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">SigD only</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="2"><p class="tableblock">ASiC</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ASiCS</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES / XAdES</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">ASiCE</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">CAdES / XAdES</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="_signature_algorithms">4.1.5. Signature algorithms</h4>
<div class="paragraph">
<p>DSS supports several signature algorithms (combination of an encryption algorithm and a digest algorithm). Below, you can find the supported combinations. The support of the algorithms depends on the registered OID (ASN1) or URI (XML).</p>
</div>
<div class="paragraph">
<p>In the next table, XAdES also applies to ASiC with embedded XAdES signatures and CAdES also concerns PAdES and ASiC with embedded CAdES signatures.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
SmartCards/HSMs don&#8217;t allow signing with all digest algorithms. Please refer to your SmartCard/HSM provider.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Supported algorithms</caption>
<colgroup>
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6923%;">
<col style="width: 7.6924%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top">SHA-1</th>
<th class="tableblock halign-center valign-top">SHA-224</th>
<th class="tableblock halign-center valign-top">SHA-256</th>
<th class="tableblock halign-center valign-top">SHA-384</th>
<th class="tableblock halign-center valign-top">SHA-512</th>
<th class="tableblock halign-center valign-top">SHA3-224</th>
<th class="tableblock halign-center valign-top">SHA3-256</th>
<th class="tableblock halign-center valign-top">SHA3-384</th>
<th class="tableblock halign-center valign-top">SHA3-512</th>
<th class="tableblock halign-center valign-top">MD2</th>
<th class="tableblock halign-center valign-top">MD5</th>
<th class="tableblock halign-center valign-top">RIPEMD160</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>RSA</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">JAdES</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>RSA-PSS</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">JAdES</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>ECDSA</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">JAdES</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>Ed25519</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>DSA</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">JAdES</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="13"><p class="tableblock"><strong>HMAC</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">CAdES</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">JAdES</p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
<td class="tableblock halign-center valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="DSSDocuments">4.2. Representation of documents in DSS</h3>
<div class="paragraph">
<p>DSS allows creation of different kinds of DSSDocument :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>InMemoryDocument</code> : fully loads the document in memory. This type of DSSDocument can be instantiated with an array of bytes or an InputStream.</p>
</li>
<li>
<p><code>FileDocument</code> : created from an existing local file.</p>
</li>
<li>
<p><code>DigestDocument</code> : only contains pre-computed digest values for a given document. That allows a user to avoid sending the full document (detached signatures).</p>
</li>
<li>
<p><code>CMSSignedDocument</code> : an internal implementation of a DSSDocument, loading a CMS Signed Data object.</p>
</li>
<li>
<p><code>HTTPHeader</code> : represents an HTTP Header used as a signed object within a JAdES implementation (see <a href="#JAdESDetachedPackaging">JAdES Detached Packaging</a>).</p>
</li>
<li>
<p><code>HTTPHeaderDigest</code> : represents an HTTP body message&#8217;s digest to be used as a signed HTTP Header within <a href="#JAdESDetachedPackaging">JAdES Detached Packaging</a>. The object is built from another DSSDocument (e.g. from binaries, digest document, etc.).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">InMemoryDocument</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// We can instantiate an InMemoryDocument from binaries</span>
DSSDocument binaryInMemoryDocument = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello World</span><span style="color:#710">&quot;</span></span>.getBytes());

<span style="color:#777">// Or from InputStream</span>
DSSDocument isInMemoryDocument;
<span style="color:#080;font-weight:bold">try</span> (<span style="color:#0a8;font-weight:bold">InputStream</span> is = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">FileInputStream</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/xml_example.xml</span><span style="color:#710">&quot;</span></span>)) {
        isInMemoryDocument = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello World</span><span style="color:#710">&quot;</span></span>.getBytes());
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">FileDocument</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Instantiate a FileDocument from a File</span>
DSSDocument fileDocument = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/xml_example.xml</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// Or from file path directly</span>
DSSDocument filePathDocument = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/xml_example.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">DigestDocument</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Firstly, we load a basic DSSDocument (FileDocument or InMemoryDocument)</span>
DSSDocument fileDocument = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/xml_example.xml</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// After that, we create a DigestDocument</span>
DigestDocument digestDocument = <span style="color:#080;font-weight:bold">new</span> DigestDocument(DigestAlgorithm.SHA1, fileDocument.getDigest(DigestAlgorithm.SHA1));
digestDocument.setName(fileDocument.getName());

<span style="color:#777">// We can add additional digest values when required. Eg : for a SHA-256 based signature</span>
digestDocument.addDigest(DigestAlgorithm.SHA256, fileDocument.getDigest(DigestAlgorithm.SHA256));

<span style="color:#777">// Or incorporate digest value as a String directly</span>
digestDocument.addDigest(DigestAlgorithm.SHA512, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T1h8Ss0fiK0pfo1chVoLumIhyIgR9I0g8IvPhJPxwnR5dPFhLDEMU5kpt3AE4xnU2dagh6JaMz1INaCkO0LItg==</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">HTTPHeader</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// An HTTPHeader shall be defined with a header name and a value</span>
DSSDocument httpHeader = <span style="color:#080;font-weight:bold">new</span> HTTPHeader(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">content-type</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">application/json</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// An `digest` HTTP Header can be created from a HTTP body message, using a DSSDocument and a desired DigestAlgorithm</span>
DSSDocument httpBodyMessage = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello World!</span><span style="color:#710">&quot;</span></span>.getBytes());
DSSDocument httpHeaderDigest = <span style="color:#080;font-weight:bold">new</span> HTTPHeaderDigest(httpBodyMessage, DigestAlgorithm.SHA256);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="SignatureTokens">4.3. Signature tokens</h3>
<div class="paragraph">
<p>The DSS framework is able to create signatures using different keystores: PKCS#11, PKCS#12, MS CAPI and Apple Keystore. To be independent of the signing media, the DSS framework uses an interface named SignatureTokenConnection to manage different implementations of the signing process. This base implementation is able to sign a stream of data in one step. That means that all the data to be signed needs to be sent to the SCDev. This is the case for MS CAPI. For the PKCS#11 and PKCS#12, which give the developer a finer control in the signature operation, the DSS framework implements the <code>AsyncSignatureTokenConnection</code> abstract class that allows executing the digest operation and signature operation in two different threads or even in two different hardwares.</p>
</div>
<div class="paragraph">
<p>This design also allows other card providers/adopters to create their own implementations. For example, this can be used for a direct connection to the Smartcard through Java PC/SC.</p>
</div>
<div class="sect3">
<h4 id="_pkcs11">4.3.1. PKCS#11</h4>
<div class="paragraph">
<p>PKCS#11 is widely used to access smart cards and HSMs. Most commercial software uses PKCS#11 to access the signature key of the CA or to enrol user certificates. In the DSS framework, this standard is encapsulated in the class <code>Pkcs11SignatureToken</code>. It requires some installed drivers (dll, sso,&#8230;&#8203;).</p>
</div>
<div class="listingblock">
<div class="title">Pkcs11SignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (Pkcs11SignatureToken token = <span style="color:#080;font-weight:bold">new</span> Pkcs11SignatureToken(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">C:</span><span style="color:#b0b">\\</span><span style="color:#D20">Windows</span><span style="color:#b0b">\\</span><span style="color:#D20">System32</span><span style="color:#b0b">\\</span><span style="color:#D20">beidpkcs11.dll</span><span style="color:#710">&quot;</span></span>)) {

        <span style="color:#0a8;font-weight:bold">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
        <span style="color:#080;font-weight:bold">for</span> (DSSPrivateKeyEntry entry : keys) {
                <span style="color:#0a8;font-weight:bold">System</span>.out.println(entry.getCertificate().getCertificate());
        }

        ToBeSigned toBeSigned = <span style="color:#080;font-weight:bold">new</span> ToBeSigned(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world</span><span style="color:#710">&quot;</span></span>.getBytes());
        SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span style="color:#00D">0</span>));

        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Signature value : </span><span style="color:#710">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pkcs12">4.3.2. PKCS#12</h4>
<div class="paragraph">
<p>This standard defines a file format commonly used to store the private key and corresponding public key certificate protecting them with a password. It allows signing with a PKCS#12 keystore (.p12 file).
In order to use this format with the DSS framework you have to go through the class <code>Pkcs12SignatureToken</code>.</p>
</div>
<div class="listingblock">
<div class="title">Pkcs12SignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (Pkcs12SignatureToken token = <span style="color:#080;font-weight:bold">new</span> Pkcs12SignatureToken(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/user_a_rsa.p12</span><span style="color:#710">&quot;</span></span>, <span style="color:#080;font-weight:bold">new</span> PasswordProtection(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span>.toCharArray()))) {

        <span style="color:#0a8;font-weight:bold">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
        <span style="color:#080;font-weight:bold">for</span> (DSSPrivateKeyEntry entry : keys) {
                <span style="color:#0a8;font-weight:bold">System</span>.out.println(entry.getCertificate().getCertificate());
        }

        ToBeSigned toBeSigned = <span style="color:#080;font-weight:bold">new</span> ToBeSigned(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world</span><span style="color:#710">&quot;</span></span>.getBytes());
        SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span style="color:#00D">0</span>));

        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Signature value : </span><span style="color:#710">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ms_capi">4.3.3. MS CAPI</h4>
<div class="paragraph">
<p>If the middleware for communicating with an SCDev provides a CSP based on MS CAPI (the Microsoft interface to communicate with SmartCards) specification, then you can use the MSCAPISignatureToken class to sign the documents.</p>
</div>
<div class="listingblock">
<div class="title">MSCAPISignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (MSCAPISignatureToken token = <span style="color:#080;font-weight:bold">new</span> MSCAPISignatureToken()) {

        <span style="color:#0a8;font-weight:bold">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
        <span style="color:#080;font-weight:bold">for</span> (DSSPrivateKeyEntry entry : keys) {
                <span style="color:#0a8;font-weight:bold">System</span>.out.println(entry.getCertificate().getCertificate());
        }

        ToBeSigned toBeSigned = <span style="color:#080;font-weight:bold">new</span> ToBeSigned(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world</span><span style="color:#710">&quot;</span></span>.getBytes());
        SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span style="color:#00D">0</span>));

        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Signature value : </span><span style="color:#710">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_apple_keystore">4.3.4. Apple Keystore</h4>
<div class="paragraph">
<p>Since DSS 5.10 a new class <code>AppleSignatureToken</code> is provided within the source code allowing to access a Keychain store in a MacOS environment.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The API does not use keys from a smartcard, as opposite to the MS CAPI implementation.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">AppleSignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (AppleSignatureToken token = <span style="color:#080;font-weight:bold">new</span> AppleSignatureToken()) {

    <span style="color:#0a8;font-weight:bold">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
    <span style="color:#080;font-weight:bold">for</span> (DSSPrivateKeyEntry entry : keys) {
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(entry.getCertificate().getCertificate());
    }

    ToBeSigned toBeSigned = <span style="color:#080;font-weight:bold">new</span> ToBeSigned(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world</span><span style="color:#710">&quot;</span></span>.getBytes());
    SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span style="color:#00D">0</span>));

    <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Signature value : </span><span style="color:#710">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_java_key_store">4.3.5. Java Key Store</h4>
<div class="paragraph">
<p>The JKSSignatureToken class allows signing with a Java Key Store (.jks file).</p>
</div>
<div class="listingblock">
<div class="title">JKSSignatureToken usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (<span style="color:#0a8;font-weight:bold">InputStream</span> is = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">FileInputStream</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/keystore.jks</span><span style="color:#710">&quot;</span></span>);
     JKSSignatureToken token = <span style="color:#080;font-weight:bold">new</span> JKSSignatureToken(is, <span style="color:#080;font-weight:bold">new</span> PasswordProtection(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dss-password</span><span style="color:#710">&quot;</span></span>.toCharArray()))) {

    <span style="color:#0a8;font-weight:bold">List</span>&lt;DSSPrivateKeyEntry&gt; keys = token.getKeys();
    <span style="color:#080;font-weight:bold">for</span> (DSSPrivateKeyEntry entry : keys) {
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(entry.getCertificate().getCertificate());
    }

    ToBeSigned toBeSigned = <span style="color:#080;font-weight:bold">new</span> ToBeSigned(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world</span><span style="color:#710">&quot;</span></span>.getBytes());
    SignatureValue signatureValue = token.sign(toBeSigned, DigestAlgorithm.SHA256, keys.get(<span style="color:#00D">0</span>));

    <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Signature value : </span><span style="color:#710">&quot;</span></span> + Utils.toBase64(signatureValue.getValue()));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_other_implementations">4.3.6. Other Implementations</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The DSS also provides the support for MOCCA framework to communicate with the Smartcard with PC/SC, but it involves the installation of the MOCCA and IAIK libraries.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As you can see, it is easy to add another implementation of the SignatureTokenConnection, thus enabling the framework to use other API than provided within the framework. For example, it is likely that in the future PC/SC will be the preferred way of accessing a Smartcard. Although PKCS#11 is currently the most used API, DSS framework is extensible and can use PC/SC. For our design example we propose to use PC/SC to communicate with the Smartcard.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="SignatureCreationThreeSteps">4.4. Signature creation in 3 stateless methods</h3>
<div class="paragraph">
<p>In the DSS framework, there are two alternatives for signing a document which are illustrated in the following schema.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/three-stateless-methods.jpg" alt="sigCreationSteps" width="40%">
</div>
</div>
<div class="paragraph">
<p>The first path consists in 3 atomic steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Compute the data to be signed (DTBS);</p>
</li>
<li>
<p>Sign the DTBS to obtain the signature value;</p>
</li>
<li>
<p>Sign the document (add the signature value).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The alternative is to use the following 4 steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Compute the data to be signed (DTBS);</p>
</li>
<li>
<p>Compute the digest of the DTBS to obtain the data to be signed representation (DTBSR);</p>
</li>
<li>
<p>Sign the DTBSR to obtain the signature value;</p>
</li>
<li>
<p>Sign the document (add the signature value).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Usually, the signature creation is done using the 3 stateless methods approach.</p>
</div>
<div class="paragraph">
<p>DSS fully manages the first and last steps of the document signature process.
The signature operation (signing the DTBS or the DTBSR respectively) needs to be specified. DSS offers some implementations in the dss-token module. During this step, the signing keys are not retrieved. Instead, a communication channel that allows sending the DTBS/DTBSR to the keys is opened.</p>
</div>
<div class="paragraph">
<p>The following code presents the three stateless steps.</p>
</div>
<div class="listingblock">
<div class="title">Three stateless steps</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// step 1: generate ToBeSigned data</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, signatureParameters);

<span style="color:#777">// step 2: sign ToBeSigned data using a private key</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span style="color:#777">// step 3: sign document using a SignatureValue obtained on the previous step</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, signatureParameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first step uses the <code>getDataToSign()</code> method, which receives the following arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the document to be signed;</p>
</li>
<li>
<p>the previously selected settings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This step returns the DTBS. In the case of a XAdES, it corresponds to the <a href="https://www.w3.org/TR/xmldsig-core1/#sec-SignedInfo">SignedInfo XMLDSig</a> element. For XAdES and CAdES, the DTBS is composed of the digest of the original document and the signed attributes. For JAdES, it is not the case.</p>
</div>
<div class="paragraph">
<p>The second step is a call to the function <code>sign()</code>, which is invoked on the object token representing the KeyStore and not on the service. This method takes three parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the array of bytes that must be signed. It is obtained by the previous method invocation.</p>
</li>
<li>
<p>the algorithm used to create the digest. There is the choice between, for example, SHA256 and SHA512. This list is not exhaustive. For an exhaustive list see <a href="https://github.com/esig/dss/blob/master/dss-enumerations/src/main/java/eu/europa/esig/dss/enumerations/DigestAlgorithm.java">this class</a>.</p>
</li>
<li>
<p>the private key entry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The third and last step of this process is the integration of the signature value in the signature and linking of that one to the signed document based on the selected packaging method. This is done using the method <code>signDocument()</code> on the service. It requires three parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the document to sign;</p>
</li>
<li>
<p>the signature parameters (the same as the ones used in the first step);</p>
</li>
<li>
<p>the value of the signature obtained in the previous step.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This separation into three steps allows use cases where different environments have their precise responsibilities: specifically the distinction between communicating with the token and executing the business logic.</p>
</div>
<div class="paragraph">
<p>The following code presents the alternative with four stateless steps.</p>
</div>
<div class="listingblock">
<div class="title">Four stateless steps</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">include::</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first and last steps, which compute the DTBS and sign the document, are the same as for the alternative with three steps.</p>
</div>
<div class="paragraph">
<p>The second step uses the <code>getDigest</code> method, which takes the following arguments</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the digest algorithm;</p>
</li>
<li>
<p>the DTBS computed during the first step.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns the data to be signed representation (DTBSR) of a DTBS, i.e. is computes the digest.</p>
</div>
<div class="paragraph">
<p>The step that signs the digest and returns the signature value uses the method <code>signDigest</code>, which takes the following arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the DTBSR.</p>
</li>
<li>
<p>the algorithm used to create the digest. There is the choice between, for example, SHA256 and SHA512. This list is not exhaustive. For an exhaustive list see <a href="https://github.com/esig/dss/blob/master/dss-enumerations/src/main/java/eu/europa/esig/dss/enumerations/DigestAlgorithm.java">this class</a>.</p>
</li>
<li>
<p>the private key entry.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_cryptographic_signature_value_creation">4.5. Cryptographic signature value creation</h3>
<div class="sect3">
<h4 id="_one_step_hash_encrypt_in_one_go">4.5.1. One step (hash + encrypt in one go)</h4>

</div>
<div class="sect3">
<h4 id="_two_steps_hash_on_clientserver_side_encrypt_on_hsm_side">4.5.2. Two steps (hash on client/server side + encrypt on HSM side)</h4>

</div>
</div>
<div class="sect2">
<h3 id="_creating_a_xades_baseline_b_signature">4.6. Creating a XAdES baseline B signature</h3>
<div class="paragraph">
<p>The simplest way to address the digital signature passes through the XAdES format. Indeed, it allows visualization of the signature content with a simple text editor. Thus, it becomes much easier to make the connection between theoretical concepts and their implementation. Before embarking on the use of the DSS framework, it is advisable to read the following documents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XAdES Specifications (cf. <a href="#R01">[R01]</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The referenced specifications define the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To digitally sign a document, a signing certificate (that proves the signer&#8217;s identity) and the access to its associated private key is needed.</p>
</li>
<li>
<p>To digitally validate a signed document the signer&#8217;s certificate containing the public key is needed. To give a more colourful example: when a digitally signed document is sent to a given person or organization in order to be validated, the certificate with the public key, associated to the private key used to create the signature, must also be provided.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To start, let&#8217;s take a simple XML document:</p>
</div>
<div id="xml_example.xml" class="listingblock">
<div class="title">xml_example.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;test&gt;</span>Hello World !<span style="color:#070;font-weight:bold">&lt;/test&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To instantiate a document from a file in DSS, refer to the section about <a href="#DSSDocuments">DSSDocuments</a>.</p>
</div>
<div class="paragraph">
<p>Since this is an XML document, we will use the XAdES signature and more particularly the XAdES-BASELINE-B level.
For our example, we will use the ENVELOPED packaging.</p>
</div>
<div class="paragraph">
<p>To write our Java code, we still need to specify the type of KeyStore to use for signing our document. In other words, we need to specify where the private key can be found. To know more about the use of the different signature tokens, please consult the <a href="#SignatureTokens">Signature tokens</a> section.</p>
</div>
<div class="paragraph">
<p>In our example the class: <code>Pkcs12SignatureToken</code> will be used. A file in PKCS#12 format must be provided to the constructor of the class. It contains a private key accompanying the X.509 public key certificate and protected by a password. The certificate chain can also be included in this file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is possible to generate dummy certificates and their chains with OpenSSL. Please visit <a href="http://www.openssl.org/" class="bare">http://www.openssl.org/</a> for more details and <a href="http://dss.nowina.lu/pki-factory/keystore/list" class="bare">http://dss.nowina.lu/pki-factory/keystore/list</a> to access dummy certificates and their chains.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is the complete code example that allows you to sign an XML document:</p>
</div>
<div class="listingblock">
<div class="title">Create a XAdES-BASELINE-B signature</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing parameters for the XAdES signature</span>
XAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();
<span style="color:#777">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
<span style="color:#777">// We choose the type of the signature packaging (ENVELOPED, ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
<span style="color:#777">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span style="color:#777">// same parameter when you invoke the method sign on the token. The default value is SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

<span style="color:#777">// Create XAdES service for signature</span>
XAdESService service = <span style="color:#080;font-weight:bold">new</span> XAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo XML segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);

<span style="color:#777">// We invoke the service to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To summarize, signing a document in DSS requires to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create an object based on the <code>SerializableSignatureParameters</code> class. Generally, the number of specified parameters depends on the format, profile and level of the signature. This object also defines some default parameters.</p>
</li>
<li>
<p>Choose the level, packaging and signature digest algorithm.</p>
</li>
<li>
<p>Indicate the private key entry as well as the associated signing certificate and certificate chain.</p>
</li>
<li>
<p>Instantiate the adequate signature service based on the format of the signature. In our case it is an XML file, so we will instantiate a XAdES service.</p>
</li>
<li>
<p>Carry out the signature process (three or four steps). in our case, the process of signing takes place in three stages.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The encryption algorithm is determined by the private key and therefore shall not be compelled by the setter of the signature parameters object. It would cause an inconsistency in the signature making its validation impossible. This setter can be used in a particular context where the signing process is distributed on different machines and the private key is known only to the signature value creation process.</p>
</div>
<div class="paragraph">
<p>Setting the signing certificate and the certificate chain shall always be done. They can be set even if the private key is only known to the signature value creation process and there is no access to the private key at DTBS preparation.
However, of course, the signing certificate shall be associated to the private key that will be used at the signature value creation step.
Integrating the certificate chain in the signature simplifies the build of a prospective certificate chain during the validation process.</p>
</div>
<div class="paragraph">
<p>When the specific service is instantiated a certificate verifier must be set. It is recommended to read section <a href="#certificateVerifier">CertificateVerifier configuration</a> for information on the configuration of a <code>CertificateVerifier</code>.</p>
</div>
<div class="paragraph">
<p>The code above produces the signature that can be found <a href="https://github.com/esig/dss/tree/master/dss-cookbook/src/main/asciidoc/_samples/xades-b.adoc">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_of_attributes_in_dss">4.7. Configuration of attributes in DSS</h3>
<div class="sect3">
<h4 id="_signed_and_unsigned_attributes">4.7.1. Signed and unsigned attributes</h4>
<div class="paragraph">
<p>A signature is composed of signed and unsigned attributes.</p>
</div>
<div class="paragraph">
<p>Signed attributes shall be included in a signature. These are BASELINE-B attributes that are set upon signature creation. They cannot be changed after the signature has been created.</p>
</div>
<div class="paragraph">
<p>Unsigned attributes are not obligatory and can be added after the signature creation during signature augmentation.</p>
</div>
<div class="sect4">
<h5 id="_table_with_all_attributes_per_format_and_class">4.7.1.1. Table with all attributes per format and class</h5>
<div style="page-break-after: always;"></div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. File formats and Signature types conformance</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"></th>
<th class="tableblock halign-left valign-top">DSS classes and methods</th>
<th class="tableblock halign-left valign-top">XAdES</th>
<th class="tableblock halign-left valign-top">CAdES</th>
<th class="tableblock halign-left valign-top">PAdES</th>
<th class="tableblock halign-left valign-top">JAdES</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="28"><p class="tableblock">B-Level</p></td>
<td class="tableblock halign-left valign-top" rowspan="26"><p class="tableblock">Signed attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setSigningDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SigningTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signing-time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sigT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signing-certificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signing-certificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class xxxSignatureParameters<br>
                                                                (class AbstractSignatureParameters)<br>
                                                                setSigningCertificate<br>
                                                                getSigningCertificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SigningCertificateV2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signing-certificate-v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signing-certificate-v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x5t#o / sigX5ts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class BLevelParameters<br>
                                                                setClaimedSignerRoles<br>
                                                                getClaimedSignerRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SignerRoleV2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signer-attributes-v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signer-attributes-v2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">srAts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataObjectFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class BLevelParameters<br>
                                                                setCommitmentTypeIndications<br>
                                                                getCommitmentTypeIndications</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CommitmentTypeIndication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commitment-type-indication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commitment-type-indication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">srCms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class BLevelParameters<br>
                                                                (class SignerLocation)<br>
                                                                setSignerLocation<br>
                                                                getSignerLocation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SignatureProductionPlaceV2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signer-location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">entry with key Location in the Signature Dictionary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sigPl</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">For XAdES only: class AllDataObjectsTimeStampBuilder<br>
                                                                setContentTimestamps<br>
                                                                getContentTimestamps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllDataObjectsTimeStamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">adoTst</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IndividualDataObjectsTimeStamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class Policy<br>
                                                                setId<br>
                                                                getId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SignaturePolicyIdentifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signature-policy-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signature-policy-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sigPId</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">message-digest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">message-digest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-hints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mime-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-time-stamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-time-stamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">content-identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">alg</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cty</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x5u</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x5c</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">crit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x5t#S256</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sigD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">b64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Unsigned attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">classes XAdESCounterSignatureParameters<br>
                                                                CAdESCounterSignatureParameters<br>
                                                                JAdESCounterSignatureParameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CounterSignature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">countersignature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cSig</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class SignaturePolicyStore<br>
                                                                class xxxService:<br>
                                                                addSignaturePolicyStore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SignaturePolicyStore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signature-policy-store</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sigPSt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">T-Level</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Unsigned attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">class xxxSignatureParameters<br>
                                                                getSignatureTimestampParameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SignatureTimeStamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signature-time-stamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">signature-time-stamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sigTst</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">document-time-stamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="5"><p class="tableblock">LT-Level</p></td>
<td class="tableblock halign-left valign-top" rowspan="5"><p class="tableblock">Unsigned attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CertificateValues</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xVals</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AttrAuthoritiesCertValues</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">axVals</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RevocationValues</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rVals</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AttributeRevocationValues</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arVals</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TimeStampValidationData</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tstVD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">LTA-Level</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Unsigned attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">class xxxSignatureParameters<br>
                                                                getArchiveTimestampParameters<br>
                                                                for PAdES only: setArchiveTimestampParameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ArchiveTimeStamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">archive-time-stamp-v3<br>
                                                                                                                                                               &#8594; ats-hash-index-v3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">document-time-stamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">arcTst</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RenewedDigests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect3">
<h4 id="_signed_attributes">4.7.2. Signed attributes</h4>
<div class="paragraph">
<p>Additional signed attributes can be added to the basic signature configuration as presented in the following example of a XAdES-BASELINE-B signature.</p>
</div>
<div id="SignXmlXadesBPropertiesTest.java" class="listingblock">
<div class="title">XAdES signature with additional signed attributes</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">XAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();

<span style="color:#777">// Basic signature configuration</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPING);
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
parameters.setDigestAlgorithm(DigestAlgorithm.SHA512);
parameters.setSigningCertificate(privateKey.getCertificate());
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Configuration of several signed attributes like ...</span>
BLevelParameters bLevelParameters = parameters.bLevel();

<span style="color:#777">// Contains claimed roles assumed by the signer when creating the signature</span>
bLevelParameters.setClaimedSignerRoles(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Manager</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// signer location</span>
SignerLocation signerLocation = <span style="color:#080;font-weight:bold">new</span> SignerLocation();
signerLocation.setCountry(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">BE</span><span style="color:#710">&quot;</span></span>);
signerLocation.setStateOrProvince(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Luxembourg</span><span style="color:#710">&quot;</span></span>);
signerLocation.setPostalCode(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1234</span><span style="color:#710">&quot;</span></span>);
signerLocation.setLocality(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SimCity</span><span style="color:#710">&quot;</span></span>);
<span style="color:#777">// Contains the indication of the purported place where the signer claims to have produced the signature</span>
bLevelParameters.setSignerLocation(signerLocation);

<span style="color:#777">// Identifies the commitment undertaken by the signer in signing (a) signed data object(s)</span>
<span style="color:#777">// in the context of the selected signature policy</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;CommitmentType&gt; commitmentTypeIndications = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;&gt;();
commitmentTypeIndications.add(CommitmentTypeEnum.ProofOfOrigin);
commitmentTypeIndications.add(CommitmentTypeEnum.ProofOfApproval);
<span style="color:#777">// NOTE: CommitmentType supports also IDQualifier and documentationReferences.</span>
<span style="color:#777">// To use it, you need to have a custom implementation of the interface.</span>
bLevelParameters.setCommitmentTypeIndications(commitmentTypeIndications);

CommonCertificateVerifier verifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
XAdESService service = <span style="color:#080;font-weight:bold">new</span> XAdESService(verifier);
service.setTspSource(getOnlineTSPSource());

<span style="color:#777">// Allows setting of content-timestamp (part of the signed attributes)</span>
TimestampToken contentTimestamp = service.getContentTimestamp(toSignDocument, parameters);
parameters.setContentTimestamps(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(contentTimestamp));

<span style="color:#777">// Signature process with its 3 stateless steps</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the XAdES format the following types of Content Timestamp can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AllDataObjectsTimeStamp</strong> - each time-stamp token within this property covers the full set of references defined in the Signature&#8217;s SignedInfo element, excluding references of type "SignedProperties".</p>
</li>
<li>
<p><strong>IndividualDataObjectsTimeStamp</strong> - each time-stamp token within this property covers selected signed data objects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, the AllDataObjectsTimeStamp is used. The IndividualDataObjectsTimeStamp can be configured manually.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To set the Content Timestamp, a TSP source needs to be set. The method <code>getOnlineTSPSource()</code> is not a core feature of DSS and shall be implemented by the user.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Concerning the signing date, the framework uses the current date time by default. In the case where it is necessary to indicate a different time it is possible to use the setter <code>setSigningDate(Date)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Set the date of the signature.</span>
parameters.bLevel().setSigningDate(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Date</span>());</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above produces the signature that can be found <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_samples/xades-b-properties.adoc">here</a>.</p>
</div>
<div class="sect4">
<h5 id="signaturePolicy">4.7.2.1. Signature Policy</h5>
<div class="paragraph">
<p>The signature policy is a BASELINE-B signed attribute that is set upon signature creation. Thus, this attribute cannot be changed after the signature has been created.</p>
</div>
<div class="paragraph">
<p>The DSS framework allows you to reference a signature policy, which is a set of rules for the creation and validation of an electronic signature. For more information on the signature policy refer to section <a href="#SignaturePolicies">Signature Applicability Rules / Signature Policy</a>.</p>
</div>
<div class="paragraph">
<p>The signer may reference the policy either implicitly or explicitly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An implied policy means the signer follows the rules of a policy but the signature does not indicate which policy. It is assumed the choice of policy is clear from the context in which the signature is used and the <code>SignaturePolicyIdentifier</code> element will be empty.</p>
</li>
<li>
<p>When the policy is explicit, the signature contains an <code>ObjectIdentifier</code> that uniquely identifies the version of the policy in use. The signature also contains a hash of the policy document to make sure that the signer and verifier agree on the content of the policy document.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This example demonstrates an implicit policy identifier. To implement this alternative, you must set <code>SignaturePolicyId</code> to an empty string.</p>
</div>
<div class="listingblock">
<div class="title">XAdES with implicit policy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">BLevelParameters bLevelParameters = parameters.bLevel();

<span style="color:#0a8;font-weight:bold">Policy</span> policy = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Policy</span>();
policy.setId(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);

bLevelParameters.setSignaturePolicy(policy);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following XML segment will be added to the signature&#8217;s qualifying and signed properties (&lt;QualifyingProperties&gt;&lt;SignedProperties&gt;):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;xades:SignaturePolicyIdentifier&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;xades:SignaturePolicyImplied</span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/xades:SignaturePolicyIdentifier&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example demonstrates the use of an explicit policy identifier. This is obtained by setting the BASELINE-B profile signature policy and assigning values to the policy parameters. The Signature Policy Identifier is a URI or OID that uniquely identifies the version of the policy document. The signature will contain the identifier of the hash algorithm and the hash value of the policy document. The DSS framework does not automatically calculate the hash value; it is up to the developer to proceed with the computation. It is important to keep the policy file intact in order to keep the hash constant. It would be wise to make the policy file read-only.</p>
</div>
<div class="listingblock">
<div class="title">XAdES with explicit policy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">BLevelParameters bLevelParameters = parameters.bLevel();

<span style="color:#777">// Get and use the explicit policy</span>
<span style="color:#0a8;font-weight:bold">String</span> signaturePolicyId = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.example.com/policy.txt</span><span style="color:#710">&quot;</span></span>;
DigestAlgorithm signaturePolicyHashAlgo = DigestAlgorithm.SHA256;
DSSDocument policyContent = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Policy text to digest</span><span style="color:#710">&quot;</span></span>.getBytes());
<span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> digestedBytes = DSSUtils.digest(signaturePolicyHashAlgo, policyContent);

<span style="color:#0a8;font-weight:bold">Policy</span> policy = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Policy</span>();
policy.setId(signaturePolicyId);
policy.setDigestAlgorithm(signaturePolicyHashAlgo);
policy.setDigestValue(digestedBytes);

bLevelParameters.setSignaturePolicy(policy);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following XML segment will be added to the signature qualifying and signed properties (&lt;QualifyingProperties&gt;&lt;SignedProperties&gt;):</p>
</div>
<div class="listingblock">
<div class="title">XAdES Signature Policy element</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;xades:SignaturePolicyIdentifier&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;xades:SignaturePolicyId&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;xades:SigPolicyId&gt;</span>
                        <span style="color:#070;font-weight:bold">&lt;xades:Identifier&gt;</span>http://www.example.com/policy.txt<span style="color:#070;font-weight:bold">&lt;/xades:Identifier&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/xades:SigPolicyId&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;xades:SigPolicyHash&gt;</span>
                        <span style="color:#070;font-weight:bold">&lt;ds:DigestMethod</span> <span style="color:#b48">Algorithm</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/04/xmlenc#sha256</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;ds:DigestValue&gt;</span>Uw3PxkrX4SpF03jDvkSu6Zqm9UXDxs56FFXeg7MWy0c=<span style="color:#070;font-weight:bold">&lt;/ds:DigestValue&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/xades:SigPolicyHash&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/xades:SignaturePolicyId&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/xades:SignaturePolicyIdentifier&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_signature_policy_store">4.7.2.2. Signature Policy Store</h5>
<div class="paragraph">
<p>DSS provides a possibility of incorporation of a Signature Policy Store element as an unsigned property to the existing signature file.</p>
</div>
<div class="paragraph">
<p>The following signature formats support the Signature Policy Store addition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XAdES (as well as ASiC with XAdES);</p>
</li>
<li>
<p>CAdES (as well as ASiC with CAdES);</p>
</li>
<li>
<p>JAdES.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Being an unsigned component, the Signature Policy Store is not protected by a digital signature, unlike for example a Signature Policy Identifier incorporated into the signed properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before incorporating of a Signature Policy Store, you need to ensure the target signature contains the matching Signature Policy Identifier element (see section <a href="#signaturePolicy">Signature Policy</a>).</p>
</div>
<div class="paragraph">
<p>An example of a Signature Policy Store creation is available below:</p>
</div>
<div class="listingblock">
<div class="title">Add SignaturePolicyStore</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Create the SignaturePolicyStore object</span>
SignaturePolicyStore signaturePolicyStore = <span style="color:#080;font-weight:bold">new</span> SignaturePolicyStore();
<span style="color:#777">// Provide the policy content referenced within the Signature Policy Identifier</span>
signaturePolicyStore.setSignaturePolicyContent(policyContent);
<span style="color:#777">// Define the Id of the policy</span>
SpDocSpecification spDocSpec = <span style="color:#080;font-weight:bold">new</span> SpDocSpecification();
spDocSpec.setId(signaturePolicyId);
signaturePolicyStore.setSpDocSpecification(spDocSpec);

<span style="color:#777">// Add the SignaturePolicyStore</span>
XAdESService xadesService = <span style="color:#080;font-weight:bold">new</span> XAdESService(commonCertificateVerifier);
DSSDocument signedDocumentWithSignaturePolicyStore = xadesService.addSignaturePolicyStore(signedDocument, signaturePolicyStore);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_trust_anchor_inclusion_policy">4.7.3. Trust Anchor Inclusion Policy</h4>
<div class="paragraph">
<p>In DSS, it is possible to indicate whether to include or not the certificate related to the trust anchor in the signature. Refer to section <a href="#TrustAnchors">Trust Anchors and Trust Stores</a> for information on trust anchors.</p>
</div>
<div class="paragraph">
<p>By default, when a BASELINE-B signature is constructed the trust anchor is not included, only the certificates previous to the trust anchor are included.
When a <code>BASELINE-LT</code> signature is constructed the trust anchor is included.</p>
</div>
<div class="paragraph">
<p>It is possible to indicate to the framework that the certificate related to the trust anchor should be included to the signature even at the BASELINE-B level. The setter <code>setTrustAnchorBPPolicy(trustAnchorBPPolicy)</code> of the <code>BLevelParameters</code> class should be used for this purpose.</p>
</div>
<div class="paragraph">
<p>By default, the argument <code>trustAnchorBPPolicy</code> is set to true so that only the certificates previous to the trust anchor are included. It should be set to false in order to include all certificates, including the trust anchor.</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_parameters">4.7.4. [Other parameters]</h4>
<div class="sect4">
<h5 id="_xades">4.7.4.1. XAdES</h5>
<div class="paragraph">
<p>For XAdES the following parameters shall also be present from BASELINE-B level on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ds:KeyInfo/X509Data</p>
</li>
<li>
<p>ds:SignedInfo/ds:CanonicalizationMethod</p>
</li>
<li>
<p>ds:Reference (and ds:Reference/ds:Transforms may be present)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_pades">4.7.4.2. PAdES</h5>
<div class="paragraph">
<p>The framework allows creation of PDF files with visible signature as specified in ETSI EN 319 142 (cf. <a href="#R03">[R03]</a>) and allows the insertion of a visible signature to an existing field.
For more information on the possible parameters see section <a href="#PAdESVisibleSignature">PAdES Visible Signature</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_signatures_2">4.8. Multiple signatures</h3>
<div class="sect3">
<h4 id="_parallel_signatures">4.8.1. Parallel signatures</h4>
<div class="paragraph">
<p>Parallel signatures, described in section <a href="#ParallelSignatures">Parallel signatures</a>, can be created in DSS according to the corresponding AdES formats.</p>
</div>
<div class="listingblock">
<div class="title">Parallel signatures creation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Load the user token to create the first signature</span>
<span style="color:#080;font-weight:bold">try</span> (SignatureTokenConnection goodUserToken = getPkcs12Token()) {

    <span style="color:#777">// Preparing parameters for the XAdES signature</span>
    XAdESSignatureParameters parameters = initSignatureParameters();

    <span style="color:#777">// ENVELOPED SignaturePackaging should be used for a parallel signature creation</span>
    parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);

    <span style="color:#777">// Set the signing certificate and a certificate chain for the used token</span>
    DSSPrivateKeyEntry privateKey = goodUserToken.getKeys().get(<span style="color:#00D">0</span>);
    parameters.setSigningCertificate(privateKey.getCertificate());
    parameters.setCertificateChain(privateKey.getCertificateChain());

    <span style="color:#777">// Sign in three steps</span>
    ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);
    SignatureValue signatureValue = goodUserToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);
    signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);
}

signingAlias = RSA_SHA3_USER;
<span style="color:#777">// Load the second user token</span>
<span style="color:#080;font-weight:bold">try</span> (SignatureTokenConnection rsaUserToken = getPkcs12Token()) {

    <span style="color:#777">// Preparing parameters for the XAdES signature</span>
    XAdESSignatureParameters parameters = initSignatureParameters();

    <span style="color:#777">// ENVELOPED SignaturePackaging should be used for a parallel signature creation</span>
    parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);

    <span style="color:#777">// Set the signing certificate and a certificate chain for the used token</span>
    DSSPrivateKeyEntry privateKey = rsaUserToken.getKeys().get(<span style="color:#00D">0</span>);
    parameters.setSigningCertificate(privateKey.getCertificate());
    parameters.setCertificateChain(privateKey.getCertificateChain());

    <span style="color:#777">// Sign in three steps using the document obtained after the first signature</span>
    ToBeSigned dataToSign = service.getDataToSign(signedDocument, parameters);
    SignatureValue signatureValue = rsaUserToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);
    doubleSignedDocument = service.signDocument(signedDocument, parameters, signatureValue);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sequential_signatures">4.8.2. Sequential signatures</h4>
<div class="paragraph">
<p>DSS allows creation of sequential signatures according to the PAdES formats (cf. <a href="#SequentialSignatures">Sequential signatures</a>).</p>
</div>
<div class="listingblock">
<div class="title">Sequential signatures creation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">include::{sourcetestdir}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_counter_signatures">4.9. Counter signatures</h3>
<div class="paragraph">
<p>DSS allows creation of counter signatures according to the corresponding AdES formats (cf. <a href="#CounterSignatures">Counter signatures</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A counter signature does not provide a Proof Of Existence for a signed signature! Use signature augmentation / timestamping for this purpose.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following formats are supported for the counter signature creation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>XAdES</code> - multiple, nested and augmented counter signatures (up to LTA level) are allowed;</p>
</li>
<li>
<p><code>CAdES</code> - B-level counter signatures are allowed, as well as multiple counter signatures. This limitation comes from the cryptography library (bouncyCastle) and not from the standard;</p>
</li>
<li>
<p><code>JAdES</code> - multiple, nested and augmented signatures (up to LTA level) are allowed;</p>
</li>
<li>
<p><code>ASiC</code> - counter signatures are allowed according to the used format (XAdES or CAdES).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to create a counter signature, the DSS Identifier (or XML Id for XAdES) of the target signature you want to sign shall be provided within the parameters. The example below presents a counter signature creation:</p>
</div>
<div class="listingblock">
<div class="title">Counter signature creation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Initialize counter signature parameters</span>
XAdESCounterSignatureParameters counterSignatureParameters = <span style="color:#080;font-weight:bold">new</span> XAdESCounterSignatureParameters();
<span style="color:#777">// Set signing certificate parameters</span>
counterSignatureParameters.setSigningCertificate(privateKey.getCertificate());
counterSignatureParameters.setCertificateChain(privateKey.getCertificateChain());
<span style="color:#777">// Set target level of the counter signature</span>
counterSignatureParameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);

<span style="color:#777">// Next step is to extract and set the Id of a signature to be counter signed</span>

<span style="color:#777">// Initialize a validator over the signedDocument in order to extract the master signature Id</span>
DocumentValidator validator = SignedDocumentValidator.fromDocument(signedDocument);
<span style="color:#777">// Get list of signatures</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;AdvancedSignature&gt; signatures = validator.getSignatures();
<span style="color:#777">// Get Id of the target signature</span>
AdvancedSignature signature = signatures.iterator().next();
<span style="color:#0a8;font-weight:bold">String</span> signatureId = signature.getId();
<span style="color:#777">// For XAdES, the XML Id can be used</span>
signatureId = signature.getDAIdentifier();
<span style="color:#777">// Set the Id to parameters</span>
counterSignatureParameters.setSignatureIdToCounterSign(signatureId);

<span style="color:#777">// Initialize a new service for the counter signature creation</span>
<span style="color:#777">// The counter signature will be created in three steps, similarly as a normal signature</span>
XAdESService service = <span style="color:#080;font-weight:bold">new</span> XAdESService(commonCertificateVerifier);
<span style="color:#777">// First step is to get toBeSigned, which represents a SignatureValue of the master signature</span>
ToBeSigned dataToBeCounterSigned = service.getDataToBeCounterSigned(signedDocument, counterSignatureParameters);
<span style="color:#777">// Second step is to compute the signatureValue on the dataToBeCounterSigned</span>
SignatureValue signatureValue = signingToken.sign(dataToBeCounterSigned, counterSignatureParameters.getDigestAlgorithm(), privateKey);
<span style="color:#777">// Third step is to create the counter signed signature document</span>
DSSDocument counterSignedSignature = service.counterSignSignature(signedDocument, counterSignatureParameters, signatureValue);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extract_the_original_document_from_a_signature">4.10. Extract the original document from a signature</h3>
<div class="paragraph">
<p>DSS is able to retrieve the original data from a valid signature.</p>
</div>
<div class="listingblock">
<div class="title">Retrieve the original data from a signed document</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// We have our signed document, we want to retrieve the original/signed data</span>
DSSDocument signedDocument = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/test/resources/signature-pool/signedXmlXadesB.xml</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// We create an instance of DocumentValidator. DSS automatically selects the validator depending on the</span>
<span style="color:#777">// signature file</span>
SignedDocumentValidator documentValidator = SignedDocumentValidator.fromDocument(signedDocument);

<span style="color:#777">// We set a certificate verifier. It handles the certificate pool, allows to check the certificate status,...</span>
documentValidator.setCertificateVerifier(<span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier());

<span style="color:#777">// We retrieve the found signatures</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;AdvancedSignature&gt; signatures = documentValidator.getSignatures();

<span style="color:#777">// We select the wanted signature (the first one in our current case)</span>
AdvancedSignature advancedSignature = signatures.get(<span style="color:#00D">0</span>);

<span style="color:#777">// We call get original document with the related signature id (DSS unique ID)</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;DSSDocument&gt; originalDocuments = documentValidator.getOriginalDocuments(advancedSignature.getId());

<span style="color:#777">// We can have one or more original documents depending on the signature (ASiC, PDF,...)</span>
DSSDocument original = originalDocuments.get(<span style="color:#00D">0</span>);

<span style="color:#777">// Save the extracted original document if needed</span>
original.save(targetPath);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specificities_of_signature_creation_in_different_signature_formats">5. Specificities of signature creation in different signature formats</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_xades_xml">5.1. XAdES (XML)</h3>
<div class="sect3">
<h4 id="_versions_support">5.1.1. Versions support</h4>
<div class="paragraph">
<p>DSS supports the following XAdES formats :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Supported XAdES versions</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top"></th>
<th class="tableblock halign-center valign-top">B-level</th>
<th class="tableblock halign-center valign-top">T-level</th>
<th class="tableblock halign-center valign-top">LT-level</th>
<th class="tableblock halign-center valign-top">LTA-level</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES 1.1.1</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES 1.2.2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon red"><i class="fa fa-times-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES 1.3.2</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><span class="icon lime"><i class="fa fa-check-circle"></i></span></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">XAdES 1.4.1</p></td>
<td class="tableblock halign-center valign-top" colspan="4"><p class="tableblock">The format contains qualifying properties for XAdES 1.3.2 LTA level</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The XAdES Profile, as well as a customizable prefixes can be set with following methods :</p>
</div>
<div class="listingblock">
<div class="title">XAdES formats and prefixes</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Allows setting of a XAdES namespace (changes a XAdES format)</span>
<span style="color:#777">// Default : XAdESNamespaces.XADES_132 (produces XAdES 1.3.2)</span>
parameters.setXadesNamespace(XAdESNamespaces.XADES_132);

<span style="color:#777">// Defines an XmlDSig prefix</span>
<span style="color:#777">// Default : XAdESNamespaces.XMLDSIG</span>
parameters.setXmldsigNamespace(<span style="color:#080;font-weight:bold">new</span> DSSNamespace(XMLSignature.XMLNS, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myPrefix</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// Defines a XAdES 1.4.1 format prefix</span>
<span style="color:#777">// Default : XAdESNamespaces.XADES_141</span>
parameters.setXades141Namespace(XAdESNamespaces.XADES_141);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="RefTransformations">5.1.2. Reference Transformations</h4>
<div class="paragraph">
<p>In case of 'Enveloping', 'Enveloped' and 'Internally Detached' signatures, it is possible to apply custom transformations for signing references in order to compute a proper digest result. You can find an example of definition reference transformations below:</p>
</div>
<div id="SignXmlXadesBWithTransformsTest.java" class="listingblock">
<div class="title">Custom transformations definition</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Prepare transformations in the proper order</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;DSSTransform&gt; transforms = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;&gt;();
DSSTransform envelopedTransform = <span style="color:#080;font-weight:bold">new</span> EnvelopedSignatureTransform();
transforms.add(envelopedTransform);
DSSTransform canonicalization = <span style="color:#080;font-weight:bold">new</span> CanonicalizationTransform(CanonicalizationMethod.EXCLUSIVE_WITH_COMMENTS);
transforms.add(canonicalization);

<span style="color:#777">// Assign reference to the document</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;DSSReference&gt; references = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;&gt;();
DSSReference dssReference = <span style="color:#080;font-weight:bold">new</span> DSSReference();
dssReference.setContents(toSignDocument);
dssReference.setId(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">r-</span><span style="color:#710">&quot;</span></span> + toSignDocument.getName());
dssReference.setTransforms(transforms);
<span style="color:#777">// set empty URI to cover the whole document</span>
dssReference.setUri(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);
dssReference.setDigestMethodAlgorithm(DigestAlgorithm.SHA256);
references.add(dssReference);

<span style="color:#777">// Initialize signature parameters</span>
XAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
<span style="color:#777">// set references</span>
parameters.setReferences(references);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Current version of DSS supports the following transformations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EnvelopedSignatureTransform</code> - removes the current <code>Signature</code> element from the digest calculation of the reference.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Enveloped Signature Transform does not support parallel signatures!
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSTransform envelopedTransform = <span style="color:#080;font-weight:bold">new</span> EnvelopedSignatureTransform();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CanonicalizationTransform</code> - any canonicalization algorithm that can be used for 'CanonicalizationMethod' can be used as a transform:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSTransform canonicalization = <span style="color:#080;font-weight:bold">new</span> CanonicalizationTransform(CanonicalizationMethod.EXCLUSIVE_WITH_COMMENTS);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Base64Transform</code> - this transform is used if the application needs to sign RAW data (binaries, images, audio or other formats). The 'Base64 Transform' is not compatible with the following:</p>
<div class="ulist">
<ul>
<li>
<p>Other reference transformations. The reference shall not contain other transforms, the <code>Base64Transform</code> shall be the sole element of the reference transformation;</p>
</li>
<li>
<p>setEmbedXML(true) - embedded setting cannot be used;</p>
</li>
<li>
<p>setManifestSignature(true) - As is apparent from the previous point, Manifest cannot be used with the Base64 Transform as well since it shall also be embedded to the signature;</p>
</li>
<li>
<p>ENVELOPED, DETACHED or INTERNALLY DETACHED packaging.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSTransform base64Transform = <span style="color:#080;font-weight:bold">new</span> Base64Transform();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>XPathTransform</code> - allows signing a custom node in a signature or embedded document. DSS contains an additional class <code>XPathEnvelopedSignatureTransform</code> allowing to exclude signatures from the digested content (used for Enveloped signatures by default). Additional information about the 'XPath Transform' can be found <a href="https://www.w3.org/TR/xpath20/">by the link</a>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSTransform envelopedTransform = <span style="color:#080;font-weight:bold">new</span> XPathTransform(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">not(ancestor-or-self::ds:Signature)</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>XPath2FilterTransform</code> - an alternative to 'XPath Transform'. Additional information about the 'XPath2Filter Transform' can be found <a href="https://www.w3.org/TR/xmldsig-filter2/">by the link</a>. DSS contains an additional class <code>XPath2FilterEnvelopedSignatureTransform</code> allowing to exclude signatures from the digest calculation.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In DSS, the XPath-2-Filter transform is used by default for ENVELOPED signature packaging.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSTransform envelopedTransform = <span style="color:#080;font-weight:bold">new</span> XPath2FilterTransform(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">descendant::ds:Signature</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">subtract</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>XsltTransform</code> - This transform requires a 'org.w3.dom.Document' as an input, compatible with the normative <a href="https://www.w3.org/TR/xslt-30/">XSLT Specification</a>. Must be a sole transform.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All transformations, except Base64, can be applied only to XML objects.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_specific_schema_version">5.1.3. Specific schema version</h4>
<div class="paragraph">
<p>Some signatures may have been created with an older version of the XAdES format using different schema definition. To take into account the validation of such signatures the <code>interface eu.europa.esig.dss.xades.definition.XAdESPaths</code> was created. This interface allows providing the different needed XPath expressions which are used to explore the elements of the signature. The DSS framework proposes 3 implementations :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XAdES132Paths (XAdES 1.3.2 / 1.4.1)</p>
</li>
<li>
<p>XAdES122Paths (XAdES 1.2.2)</p>
</li>
<li>
<p>XAdES111Paths (XAdES 1.1.1)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, all XAdES are supported and DSS loads/parses all versions of XAdES. It is possible to restrict to only one version of XAdES with the following code :</p>
</div>
<div class="listingblock">
<div class="title">Customize the supported XAdES version(s) at the validation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">XMLDocumentValidator xmlDocumentValidator = <span style="color:#080;font-weight:bold">new</span> XMLDocumentValidator(xmlDocument);
xmlDocumentValidator.setCertificateVerifier(certificateVerifier);

<span style="color:#777">// Restrict the current XMLDocumentValidator to XAdES 1.3.2 (and 1.4.1 for</span>
<span style="color:#777">// archival timestamps)</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;XAdESPaths&gt; xadesPathsHolders = xmlDocumentValidator.getXAdESPathsHolder();
xadesPathsHolders.clear();
xadesPathsHolders.add(<span style="color:#080;font-weight:bold">new</span> XAdES132Paths());

Reports reports = xmlDocumentValidator.validateDocument();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cades_signature_cms">5.2. CAdES signature (CMS)</h3>
<div class="paragraph">
<p>To familiarize yourself with this type of signature it is advisable to read the following document:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CAdES Specifications (cf. <a href="#R02">[R02]</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To implement this form of signature you can use the XAdES examples. You only need to instantiate the CAdES object service and change the SignatureLevel parameter value. For an extensive example see section <a href="#CAdES">CAdES</a> of the Annex.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pades_signature_pdf">5.3. PAdES signature (PDF)</h3>
<div class="paragraph">
<p>The standard ISO 32000-1 (cf. <a href="#R06">[R06]</a>) allows defining a file format for portable electronic documents (PDF). The standard defines the PDF version 1.7 of Adobe Systems. Concerning the advanced electronic signature, the PAdES standard is used (cf. <a href="#R03">[R03]</a>).</p>
</div>
<div class="paragraph">
<p>The DSS implementation supports main operations for PAdES signatures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding a digital signature to a document,</p>
</li>
<li>
<p>Providing a placeholder field for signatures,</p>
</li>
<li>
<p>Checking signatures for validity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To familiarize yourself with this type of signature it is advisable to read the documents referenced above.</p>
</div>
<div class="paragraph">
<p>An example of code to perform a <code>PAdES-BASELINE-B</code> type signature can be found in section <a href="#PAdES">PAdES</a> of the Annex.</p>
</div>
<div class="sect3">
<h4 id="PAdESVisibleSignature">5.3.1. PAdES Visible Signature</h4>
<div class="paragraph">
<p>The framework also allows creation of PDF files with visible signatures as specified in ETSI EN 319 142 (cf. <a href="#R03">[R03]</a>).
In the <code>PAdESSignatureParameters</code> object, there is a special attribute named <code>SignatureImageParameters</code>.
This parameter allows you to customize the visual signature (with text, with image or with image and text).
An example of code to perform a PAdES-BASELINE-B type signature with a visible signature can be found in section <a href="#PAdESVisibleSignatureAnnex">PAdES Visible Signature</a> of the Annex.</p>
</div>
<div class="paragraph">
<p>Additionally, DSS also allows you to insert a visible signature to an existing field. This is illustrated in section <a href="#PAdESVisibleSignatureAnnex">PAdES Visible Signature</a> of the Annex.</p>
</div>
<div class="paragraph">
<p>In case of placing an image or text to an existing field, the visible signature will fill out the whole available area of the field.</p>
</div>
<div class="sect4">
<h5 id="_visible_signature_parameters_image_and_text">5.3.1.1. Visible signature parameters (image and text)</h5>
<div class="paragraph">
<p>This chapter introduces existing parameters for creation of visible signatures with DSS.
DSS has three implementations for visible signature drawing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OpenPDF (iText)</strong> - supports separate image and text drawing;</p>
</li>
<li>
<p><strong>PDFBox Default</strong> - supports separate image and text drawing, as well as a joint drawing of image and text together. It transforms text to an image;</p>
</li>
<li>
<p><strong>PDFBox Native</strong> - supports separate image and text drawing, as well as a joint drawing of image and text together. It prints text in a native way, that increases quality of the produced signature.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_positioning">5.3.1.1.1. Positioning</h6>
<div class="paragraph">
<p>DSS provides a set of functions allowing to place the signature field on a specific place in the PDF page.
For an illustrative example see section <a href="#Positioning">Positioning</a> in the Annex.</p>
</div>
</div>
<div class="sect5">
<h6 id="_dimensions">5.3.1.1.2. Dimensions</h6>
<div class="paragraph">
<p>DSS framework provides a set of functions to manage the signature field size.
See section <a href="#Dimensions">Dimensions</a> in the Annex for a concrete example.</p>
</div>
</div>
<div class="sect5">
<h6 id="_text_parameters">5.3.1.1.3. Text Parameters</h6>
<div class="paragraph">
<p>The available implementation allows placing of a visible text in a signature field.
See section <a href="#TextParameters">Text Parameters</a> in the Annex for a concrete example.</p>
</div>
</div>
<div class="sect5">
<h6 id="_text_and_image_combination">5.3.1.1.4. Text and image combination</h6>
<div class="paragraph">
<p>DSS provides a set of functions to align a text with respect to an image.
The parameters must be applied to a 'SignatureImageTextParameters' object.
See section <a href="#TextImageCombi">Text and image combination</a> in the Annex for a concrete example.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_fonts_usage">5.3.1.2. Fonts usage</h5>
<div class="paragraph">
<p>To customize a text representation a custom font can be defined. The font must be added as an instance of the <code>DSSFont</code> interface to a <code>SignatureImageTextParameters</code> object.</p>
</div>
<div class="paragraph">
<p>DSS provides the following common implementations for the <code>DSSFont</code> interface:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DSSFileFont</code> for use of physical fonts, which must be embedded to the produced PDF document. To create an instance of the class, you must pass to a <code>DSSFileFont</code> constructor an object of <code>DSSDocument</code> type or an InputStream of the font file;</p>
</li>
<li>
<p><code>DSSJavaFont</code> for use of logical fonts (default Java fonts). The logical Java fonts allow you to significantly reduce the document size, because these fonts cannot be embedded to the final PDF document. Be aware that, because of the latter fact, use of logical fonts does not allow producing PDF documents satisfying the PDF/A standard. To create an instance of this class, you should pass as an input a <code>java.awt.Font</code> object or target font parameters (name, style, size).</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Logical fonts may have different implementations depending on the PAdES Visible signature service or Operating System (OS) used. Keep this in mind when switching from an implementation or system environment to another.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additionally, there are implementation-dependent classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ITextNativeFont</code> to be used with <code>ITextSignatureDrawerFactory</code>;</p>
</li>
<li>
<p><code>PdfBoxNativeFont</code> to be used with <code>PdfBoxNativeObjectFactory</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find an example of how to create a custom font for a physical font, for a logical font and for a native font in section <a href="#Fonts">Fonts usage</a>.</p>
</div>
<div class="paragraph">
<p>By default, DSS uses a Google font : 'PT Serif Regular' (its physical implementation).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The 'Native PDFBox Drawer' implementation supports only one of the following fonts: SERIF, SANS-SERIF, MONOSPACED, DIALOG and DIALOG_INPUT.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_iso_32000_1_pdf_signature_pkcs7">5.4. ISO 32000-1 PDF signature (PKCS#7)</h3>
<div class="paragraph">
<p>The ISO 32000-1 standard gives a specification for the creation of electronic signatures in the PDF format. However, these signatures are not in the AdES format defined by ETSI.</p>
</div>
<div class="paragraph">
<p>The Public Key Cryptographic Standard Number 7 (PKCS#7) is a common format of a signature included in a PDF which has been created by Adobe PDF Reader. The PKCS#7 signature format is described in the ISO 32000-1 standard (cf. <a href="#R06">[R06]</a>) and must conform to the RFC 2315 (cf. <a href="#R15">[R15]</a>). To familiarize yourself with this type of signature you can read these documents.</p>
</div>
<div class="paragraph">
<p>DSS only supports AdES formats (e.g. PAdES for PDF) and thus does not support signature creation for PKCS#7. DSS only provides a limited support for the augmentation and validation of PKCS#7 signatures.</p>
</div>
<div class="paragraph">
<p>There is no specific validation standard for PKCS#7 nor any augmentation formats in the ISO 32000-1 standard. Thus, DSS validates and augments PKCS#7 according to rules defined in ETSI standards. It validates PKCS#7 signatures according to the AdES validation algorithm, and it adds the same components as when augmenting PADES-BASELINE-B to PAdES-BASELINE-T.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jades_signature_jws">5.5. JAdES signature (JWS)</h3>
<div class="paragraph">
<p>DSS includes a possibility of creation and validation of JSON Advanced signatures (JAdES).</p>
</div>
<div class="paragraph">
<p>The JSON format for AdES Signatures (cf. <a href="#R05">[R05]</a>) represents an extension of JSON Web Signatures (JWS) as specified in <a href="https://tools.ietf.org/html/rfc7515">IETF RFC 7515</a>.</p>
</div>
<div class="paragraph">
<p>A typical example of a JAdES signature creation can be found in section <a href="#JAdES">JAdES</a> of the Annex.</p>
</div>
<div class="paragraph">
<p>The specific parameters for JAdES signature are described in the next sections.</p>
</div>
<div class="sect3">
<h4 id="_jws_serialization_type">5.5.1. JWS Serialization type</h4>
<div class="paragraph">
<p>A JWS signature can be represented in different forms which are supported by the JAdES standard as well:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>COMPACT_SERIALIZATION</code> represents a compact, URL-safe serialization. It has no JWS Unprotected Header, therefore only <code>JAdES-BASELINE-B</code> level is possible with this format.</p>
</li>
<li>
<p><code>JSON_SERIALIZATION</code> represents a JSON object with a collection of signatures inside the <code>'signatures'</code> header that allows parallel signing. It allows <code>JAdES-BASELINE-T/-LT/-LTA</code> signature augmentation levels.</p>
</li>
<li>
<p><code>FLATTENED_JSON_SERIALIZATION</code> represents a JSON object with a single signature container. It allows <code>JAdES-BASELINE-T/-LT/-LTA</code> signature augmentation levels.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">JWS Serialization type usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Choose the form of the signature (COMPACT_SERIALIZATION, JSON_SERIALIZATION, FLATTENED_JSON_SERIALIZATION)</span>
parameters.setJwsSerializationType(JWSSerializationType.COMPACT_SERIALIZATION);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sigd_header_parameter">5.5.2. SigD header parameter</h4>
<div class="paragraph">
<p>JAdES signatures allow two types of JWS Payload (signed data) inclusion: <code>ENVELOPING</code> and <code>DETACHED</code>.</p>
</div>
<div class="sect4">
<h5 id="_enveloping_packaging">5.5.2.1. Enveloping packaging</h5>
<div class="paragraph">
<p>With <code>ENVELOPING</code> packaging the JWS Payload is enveloped into the JAdES Signature. The type only allows signing one document.</p>
</div>
</div>
<div class="sect4">
<h5 id="JAdESDetachedPackaging">5.5.2.2. Detached packaging</h5>
<div class="paragraph">
<p>A simple JWS signature allows a <code>DETACHED</code> packaging by omitting the JWS Payload in the created signature. For the validation process the detached content shall be provided and it is treated in the same way as if it were attached.</p>
</div>
<div class="paragraph">
<p>To create such a signature, the parameter <code>SigDMechanism.NO_SIG_D</code> shall be set. The solution allows signing of only one document.</p>
</div>
<div class="paragraph">
<p>The JAdES standard <a href="#R05">[R05]</a> provides a possibility for signing multiple documents within one signature in a detached way.</p>
</div>
<div class="paragraph">
<p>The following mechanisms are possible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HTTP_HEADERS</code> is used to sign an HTTP request. The signature may explicitly sign several HTTP headers (represented by the class <code>HTTPHeader</code>), as well as the HTTP message body (see the <code>HTTPHeaderDigest</code> class).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Configuration for signing with detached mechanism HttpHeaders</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Set Detached packaging</span>
parameters.setSignaturePackaging(SignaturePackaging.DETACHED);
<span style="color:#777">// Set Mechanism HttpHeaders for 'sigD' header</span>
parameters.setSigDMechanism(SigDMechanism.HTTP_HEADERS);
<span style="color:#777">// The HttpHeaders mechanism shall be used with unencoded JWS payload (&quot;b64&quot;=&quot;false&quot;)</span>
parameters.setBase64UrlEncodedPayload(<span style="color:#069">false</span>);
<span style="color:#777">// Create a list of headers to be signed</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;DSSDocument&gt; documentsToSign = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;&gt;();
documentsToSign.add(<span style="color:#080;font-weight:bold">new</span> HTTPHeader(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">content-type</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">application/json</span><span style="color:#710">&quot;</span></span>));
documentsToSign.add(<span style="color:#080;font-weight:bold">new</span> HTTPHeader(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x-example</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">HTTP Headers Example</span><span style="color:#710">&quot;</span></span>));
documentsToSign.add(<span style="color:#080;font-weight:bold">new</span> HTTPHeader(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x-example</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Duplicated Header</span><span style="color:#710">&quot;</span></span>));
<span style="color:#777">// Add a document representing the HTTP message body (optional)</span>
<span style="color:#777">// Requires the message body content + digest algorithm to compute the hash to be signed</span>
documentsToSign.add(<span style="color:#080;font-weight:bold">new</span> HTTPHeaderDigest(toSignDocument, DigestAlgorithm.SHA1));</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OBJECT_ID_BY_URI</code> can be used for signing of multiple documents. The signed files are dereferenced by URIs and their content is concatenated for generation of the JWS Payload.</p>
</li>
<li>
<p><code>OBJECT_ID_BY_URI_HASH</code> similarly provides a possibility to sign multiple documents, by signing the computed digests of the original documents. The JWS Payload for this format stays empty.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Configuration for signing with detached mechanism ObjectIdByURIHash</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">parameters.setSignaturePackaging(SignaturePackaging.DETACHED);
parameters.setSigDMechanism(SigDMechanism.OBJECT_ID_BY_URI_HASH);
<span style="color:#777">// Prepare the documents to be signed</span>
documentsToBeSigned = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;&gt;();
documentsToBeSigned.add(<span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/hello-world.pdf</span><span style="color:#710">&quot;</span></span>));
documentsToBeSigned.add(<span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/xml_example.xml</span><span style="color:#710">&quot;</span></span>));</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_base64url_encoding">5.5.3. Base64Url encoding</h4>
<div class="paragraph">
<p>The <code>Base64Url</code> represents a Base64 encoded format with URI safe alphabet (see <a href="https://tools.ietf.org/html/rfc4648">RFC 4648</a>).</p>
</div>
<div class="paragraph">
<p>JAdES signatures (as well as JWS) force some values to be Base64Url-encoded, while providing a possibility to customize the format for some of them.</p>
</div>
<div class="paragraph">
<p>DSS provides options to configure encoding for the following elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JWS Payload can be represented as Base64Url encoded octets (by default), and can be present in its initial form (with the protected header <code>b64</code> set to <code>false</code>).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Use unencoded JWS Payload</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">parameters.setBase64UrlEncodedPayload(<span style="color:#069">false</span>);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The components of the unsigned header <code>'etsiU'</code> can occur either as Base64Url encoded strings (by default), or as clear JSON objects.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All components inside the <code>'etsiU'</code> header shall be present in the same form (Base64Url encoded or as clear JSON).
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The current version of DSS does not allow <code>JAdES-BASELINE-LTA</code> level creation for <code>'etsiU'</code> components in their clear JSON representation.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Represent EtsiU components as clear JSON instances</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">parameters.setBase64UrlEncodedEtsiUComponents(<span style="color:#069">false</span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asic_signature_containers">5.6. ASiC signature (containers)</h3>
<div class="paragraph">
<p>The ETSI EN 319 162 standard (cf. <a href="#R04">[R04]</a>) offers a standardized use of container forms to establish a common way for associating data objects with advanced signatures or time-stamp tokens. It is an alternative to the packaging types presented in section <a href="#Packaging">Signature packaging</a>.</p>
</div>
<div class="paragraph">
<p>A number of application environments use ZIP-based container formats to package sets of files together with meta-information. ASiC technical specification is designed to operate with a range of such ZIP-based application environments. Rather than enforcing a single packaging structure, ASiC describes how these package formats can be used to associate advanced electronic signatures with any data objects.</p>
</div>
<div class="paragraph">
<p>The standard defines two types of containers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ASiC-S</strong> is a simple container that allows you to associate one or more signatures with a single data element (zip-container). In this case, the structure of the signature can be based (in a general way) on a single CAdES signature or on multiple XAdES signatures or finally on a single TST;</p>
</li>
<li>
<p><strong>ASiC-E</strong> is an extended container that includes multiple data objects. Each data object may be signed by one or more signatures whose structure is similar to ASiC-S. This second type of container is compatible with OCF, UCF and ODF formats.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DSS framework has some restrictions on the containers you can generate, depending on the input file. If the input file is already an ASiC container, the output container must be the same type of container based on the same type of signature. If the input is any other file, the output does not have any restriction.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. ASiC containers</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S CAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S CAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S XAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S XAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E CAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E CAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E XAdES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-E XAdES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASiC-S CAdES, ASiC-S XAdES, ASiC-E CAdES, ASiC-E XAdES</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Typical examples of the source code for signing a document using ASiC-S based on XAdES-BASELINE-B and ASiC-E based on XAdES-BASELINE-B can be found in sections <a href="#ASiC-S">ASiC-S</a> and <a href="#ASiC-E">ASiC-E</a> respectively.</p>
</div>
<div class="paragraph">
<p>You need to pass only few parameters to the service. Other parameters, although they are positioned, will be overwritten by the internal implementation of the service. Therefore, the obtained signature is always based on the DETACHED packaging no matter the packaging that was specified.</p>
</div>
<div class="paragraph">
<p>It is also possible with the DSS framework to make an augmentation of an ASiC container to the levels <code>BASELINE-T</code>, <code>BASELINE-LT</code> or <code>BASELINE-LTA</code>, respectively for XAdES and CAdES formats.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="RevocationDataManagement">6. Revocation data management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Revocation data management is an essential part in the lifecycle of a digital certificate and thus of a digital signature too.</p>
</div>
<div class="sect2">
<h3 id="_tokens_and_sources">6.1. Tokens and sources</h3>
<div class="paragraph">
<p>DSS provides utilities for processing and validation of both CRL and OCSP tokens, containing a revocation information about a certificate (see <a href="#CRLsAndOCSP">CRLs and OCSP</a> for more information on CRLs and OCSP)</p>
</div>
<div class="paragraph">
<p>For every certificate, the validity has to be checked via CRL or OCSP responses. The information may originate from different CRLSources or OCSPSources:
For easing the usage of such sources, DSS implements a <code>CRLSource</code> and <code>OCSPSource</code> interfaces (which inherit from <code>RevocationSource</code>), which offer a generic and uniform way of accessing CRL and OCSP sources, respectively. Furthermore, a caching mechanism can be easily attached to those sources, optimizing the access time to revocation information by reducing network connections to online servers.</p>
</div>
<div class="paragraph">
<p>The interface <code>CRLSource</code> defines the method which returns a <code>CRLToken</code> for the given certificate/issuer certificate couple:</p>
</div>
<div class="listingblock">
<div class="title">CRLSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CRLToken crlToken = crlSource.getRevocationToken(certificateToken, issuerCertificateToken);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The interface <code>OCSPSource</code> defines the method which returns <code>OCSPToken</code> for the given certificate/issuer certificate couple:</p>
</div>
<div class="listingblock">
<div class="title">OCSPSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">OCSPToken ocspToken = ocspSource.getRevocationToken(certificateToken, issuerCertificateToken);</code></pre>
</div>
</div>
<div class="paragraph">
<p>We use these classes during the certificate validation process through <code>validationContext</code> object (based on <code>ValidationContext</code> class) which is a "cache" for a validation request that contains every object required for a complete validation process. This object in turn instantiates a "verifier" based on <code>RevocationDataLoadingStrategy</code> class whose role is to fetch revocation data by querying an OCSP or CRL source in the defined order and return the succeeded result (see <a href="#RevocationLoadingStrategy">Revocation data loading strategy</a> for more details).</p>
</div>
<div class="paragraph">
<p>In general, we can distinguish three main sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Offline sources (<code>OfflineRevocationSource</code>);</p>
</li>
<li>
<p>Online sources (<code>OnlineRevocationSource</code>);</p>
</li>
<li>
<p>Sources with the cache mechanism.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As well as a list of sources (<code>ListRevocationSource</code>) with a collection of several sources.</p>
</div>
</div>
<div class="sect2">
<h3 id="_caching">6.2. Caching</h3>
<div class="paragraph">
<p>The above-mentioned class allows caching of CRL and OCSP responses to a user-chosen source. By default, DSS provides a JDBC based implementation for this class, but other implementations also can be created. The class contains a complete set of functions to save revocation data to a database, extract, update and remove it.<br>
Furthermore, the <code>RepositoryRevocationSource</code> allows the implementer to define a backup revocation source, for the case if the database does not contain the certificate&#8217;s revocation data yet.</p>
</div>
<div class="paragraph">
<p>List of cached Revocation sources implemented in DSS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JdbcRevocationSource</code></p>
<div class="ulist">
<ul>
<li>
<p><code>JdbcCacheCRLSource</code></p>
</li>
<li>
<p><code>JdbcCacheOCSPSource</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
A database table shall be initialized before you start working with the cached revocation repository.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_crl">6.2.1. CRL</h4>
<div class="paragraph">
<p>An example for JdbcCacheCRLSource :</p>
</div>
<div class="listingblock">
<div class="title">JdbcCacheCRLSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Creates an instance of JdbcCacheCRLSource</span>
JdbcCacheCRLSource cacheCRLSource = <span style="color:#080;font-weight:bold">new</span> JdbcCacheCRLSource();

<span style="color:#777">// Initialize the JdbcCacheConnector</span>
JdbcCacheConnector jdbcCacheConnector = <span style="color:#080;font-weight:bold">new</span> JdbcCacheConnector(dataSource);

<span style="color:#777">// Set the JdbcCacheConnector</span>
cacheCRLSource.setJdbcCacheConnector(jdbcCacheConnector);

<span style="color:#777">// Allows definition of an alternative dataLoader to be used to access a revocation</span>
<span style="color:#777">// from online sources if a requested revocation is not present in the repository or has been expired (see below).</span>
cacheCRLSource.setProxySource(onlineCRLSource);

<span style="color:#777">// All setters accept values in seconds</span>
<span style="color:#0a8;font-weight:bold">Long</span> oneWeek = (<span style="color:#339;font-weight:bold">long</span>) (<span style="color:#00D">60</span> * <span style="color:#00D">60</span> * <span style="color:#00D">24</span> * <span style="color:#00D">7</span>); <span style="color:#777">// seconds * minutes * hours * days</span>

<span style="color:#777">// If &quot;nextUpdate&quot; field is not defined for a revocation token, the value of &quot;defaultNextUpdateDelay&quot; </span>
<span style="color:#777">// will be used in order to determine when a new revocation data should be requested. </span>
<span style="color:#777">// If the current time is not beyond the &quot;thisUpdate&quot; time + &quot;defaultNextUpdateDelay&quot;, </span>
<span style="color:#777">// then a revocation data will be retrieved from the repository source, otherwise a new revocation data </span>
<span style="color:#777">// will be requested from a proxiedSource. </span>
<span style="color:#777">// Default : null (a new revocation data will be requested of &quot;nestUpdate&quot; field is not defined).</span>
cacheCRLSource.setDefaultNextUpdateDelay(oneWeek);

<span style="color:#777">// Defines a custom maximum possible nextUpdate delay. Allows limiting of a time interval </span>
<span style="color:#777">// from &quot;thisUpdate&quot; to &quot;nextUpdate&quot; defined in a revocation data. </span>
<span style="color:#777">// Default : null (not specified, the &quot;nextUpdate&quot; value provided in a revocation is used).</span>
cacheCRLSource.setMaxNextUpdateDelay(oneWeek); <span style="color:#777">// force refresh every week (eg : ARL)</span>

<span style="color:#777">// Defines if a revocation should be removed on its expiration. </span>
<span style="color:#777">// Default : true (removes revocation from a repository if expired).</span>
cacheCRLSource.setRemoveExpired(<span style="color:#069">true</span>);

<span style="color:#777">// Creates an SQL table</span>
cacheCRLSource.initTable();

<span style="color:#777">// Extract CRL for a certificate</span>
CRLToken crlRevocationToken = cacheCRLSource.getRevocationToken(certificateToken, issuerCertificateToken);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ocsp">6.2.2. OCSP</h4>
<div class="paragraph">
<p>An example for JdbcCacheOCSPSource :</p>
</div>
<div class="listingblock">
<div class="title">JdbcCacheOCSPSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JdbcCacheOCSPSource cacheOCSPSource = <span style="color:#080;font-weight:bold">new</span> JdbcCacheOCSPSource();
JdbcCacheConnector jdbcCacheConnector = <span style="color:#080;font-weight:bold">new</span> JdbcCacheConnector(dataSource);
cacheOCSPSource.setJdbcCacheConnector(jdbcCacheConnector);
cacheOCSPSource.setProxySource(onlineOCSPSource);
<span style="color:#0a8;font-weight:bold">Long</span> threeMinutes = (<span style="color:#339;font-weight:bold">long</span>) (<span style="color:#00D">60</span> * <span style="color:#00D">3</span>);
cacheOCSPSource.setDefaultNextUpdateDelay(threeMinutes); <span style="color:#777">// default nextUpdateDelay (if not defined in the revocation data)</span>
cacheOCSPSource.initTable();
OCSPToken ocspRevocationToken = cacheOCSPSource.getRevocationToken(certificateToken, certificateToken);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_online_fetching">6.3. Online fetching</h3>
<div class="paragraph">
<p>DSS provides utilities for online fetching of revocation data from remote sources, during the signature augmentation and validation processes.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
By default, revocation data are not fetched from untrusted sources. In other words, revocation data are not fetched when the prospective certificate chain does not contain a trust anchor.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_crl_2">6.3.1. CRL</h4>
<div class="paragraph">
<p>This is a representation of an Online CRL repository. This implementation will download the CRL using the protocol referenced in the certificate (e.g. HTTP, LDAP). The URIs of CRL server will be extracted from this property (OID value: 1.3.6.1.5.5.7.48.1.3).</p>
</div>
<div class="paragraph">
<p>It allows the following configuration :</p>
</div>
<div class="listingblock">
<div class="title">OnlineCRLSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Instantiates a new OnlineCRLSource</span>
OnlineCRLSource onlineCRLSource = <span style="color:#080;font-weight:bold">new</span> OnlineCRLSource();

<span style="color:#777">// Allows setting an implementation of `DataLoader` interface, </span>
<span style="color:#777">// processing a querying of a remote revocation server. </span>
<span style="color:#777">// `CommonsDataLoader` instance is used by default.</span>
onlineCRLSource.setDataLoader(<span style="color:#080;font-weight:bold">new</span> CommonsDataLoader());

<span style="color:#777">// Sets a preferred protocol that will be used for obtaining a CRL.</span>
<span style="color:#777">// E.g. for a list of urls with protocols HTTP, LDAP and FTP, with a defined preferred protocol as FTP, </span>
<span style="color:#777">// the FTP url will be called first, and in case of an unsuccessful result other url calls will follow. </span>
<span style="color:#777">// Default : null (urls will be called in a provided order).</span>
onlineCRLSource.setPreferredProtocol(Protocol.FTP);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ocsp_2">6.3.2. OCSP</h4>
<div class="paragraph">
<p>This is a representation of an Online OCSP repository. This implementation will access the OCSP responder using the access point defined in the certificate. Note that the certificate&#8217;s Authority Information Access (AIA) extension is used to find issuer&#8217;s resources location like Online Certificate Status Protocol (OCSP). The URIs of OCSP server will be extracted from this property (OID value: 1.3.6.1.5.5.7.48.1).</p>
</div>
<div class="paragraph">
<p>It allows the following configuration :</p>
</div>
<div class="listingblock">
<div class="title">OnlineOCSPSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Instantiates a new OnlineOCSPSource object</span>
OnlineOCSPSource onlineOCSPSource = <span style="color:#080;font-weight:bold">new</span> OnlineOCSPSource();

<span style="color:#777">// Allows setting an implementation of the `DataLoader` interface,</span>
<span style="color:#777">// processing a querying of a remote revocation server. </span>
<span style="color:#777">// `CommonsDataLoader` instance is used by default.</span>
onlineOCSPSource.setDataLoader(<span style="color:#080;font-weight:bold">new</span> OCSPDataLoader());

<span style="color:#777">// Defines an arbitrary integer used in OCSP source querying in order to prevent a replay attack. </span>
<span style="color:#777">// Default : null (not used by default).</span>
onlineOCSPSource.setNonceSource(<span style="color:#080;font-weight:bold">new</span> SecureRandomNonceSource());

<span style="color:#777">// Defines a DigestAlgorithm being used to generate a CertificateID in order to complete an OCSP request. </span>
<span style="color:#777">// OCSP servers supporting multiple hash functions may produce a revocation response </span>
<span style="color:#777">// with a digest algorithm depending on the provided CertificateID's algorithm. </span>
<span style="color:#777">// Default : SHA1 (as a mandatory requirement to be implemented by OCSP servers. See RFC 5019).</span>
onlineOCSPSource.setCertIDDigestAlgorithm(DigestAlgorithm.SHA1);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_other_implementations_of_crl_and_ocsp_sources">6.4. Other implementations of CRL and OCSP Sources</h3>
<div class="paragraph">
<p>Other revocation sources find the status of a certificate either from a list stored locally or using the information contained in the advanced signature or online way. Here is the list of sources already implemented in the DSS framework:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CRL sources</p>
<div class="ulist">
<ul>
<li>
<p><code>OfflineCRLSource</code> : This class implements the <code>OfflineRevocationSource</code> and retrieves the revocation data from extracted information. The code is common for all signature formats and CRL contents are injected by its sub-classes :</p>
<div class="ulist">
<ul>
<li>
<p><code>CMSCRLSource</code> : Extracts CRLs and CRL references from a CMS Signed Data :</p>
<div class="ulist">
<ul>
<li>
<p><code>CAdESCRLSource</code> : Sub-class of <code>CMSCRLSource</code> for a CAdES Signature;</p>
</li>
<li>
<p><code>TimestampCRLSource</code>: Sub-class of <code>CMSCRLSource</code> for a Timestamp token (RFC 3161);</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>PAdESCRLSource</code> : Extracts CRLs and CRL references from a PAdES signature.</p>
</li>
<li>
<p><code>XAdESCRLSource</code> : Extracts CRLs and CRL references from a XAdES signature.</p>
</li>
<li>
<p><code>ExternalResourcesCRLSource</code> : A class that can instantiate a list of certificate revocation lists from a directory where the individual lists should be.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>OnlineCRLSource</code> : Retrieves CRL files from online sources with the CRL Distribution Points information from the certificate.</p>
</li>
<li>
<p><code>JdbcCacheCrlSource</code> : Implementation of the <code>JdbcRevocationSource</code>. This implementation allows storage of valid CRL entries to a defined <code>DataSource'</code> and retrieve them locally.</p>
</li>
</ul>
</div>
</li>
<li>
<p>OCSP sources</p>
<div class="ulist">
<ul>
<li>
<p><code>OfflineOCSPSource</code> : This class implements the <code>OfflineRevocationSource</code> and retrieves the revocation data from extracted information. The code is common for all signature formats and OCSP responses are injected by its sub-classes :</p>
<div class="ulist">
<ul>
<li>
<p><code>CMSOCSPSource</code> : Extracts OCSP responses and OCSP references from a CMS Signed Data :</p>
<div class="ulist">
<ul>
<li>
<p><code>CAdESOCSPSource</code> : Sub-class of <code>CMSOCSPSource</code> for a CAdES Signature;</p>
</li>
<li>
<p><code>TimestampOCSPSource</code>: Sub-class of <code>CMSOCSPSource</code> for a Timestamp token (RFC 3161);</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>PAdESOCSPSource</code> : Extracts OCSP responses and OCSP references from a PAdES signature.</p>
</li>
<li>
<p><code>XAdESOCSPSource</code> : Extracts OCSP responses and OCSP references from a XAdES signature.</p>
<div class="ulist">
<ul>
<li>
<p><code>ExternalResourcesOCSPSource</code> : A class that can instantiate a list of OCSPToken from a directory where should be the individual DER Encoded X509 certificates files.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>OnlineOCSPSource</code> : Retrieves OCSP responses from online source.</p>
</li>
<li>
<p><code>JdbcCacheOcspSource</code> : Implementation of the <code>JdbcRevocationSource</code>. This implementation allows storage of valid OCSP entries to a defined <code>DataSource</code> and retrieve them locally.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="RevocationLoadingStrategy">6.5. Revocation data loading strategy</h3>
<div class="paragraph">
<p>Since version 5.9, DSS allows the use of a RevocationDataLoadingStrategy. The latter defines logic for loading OCSP or CRL data. Two strategies are available in the core package of DSS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OCSPFirstRevocationDataLoadingStrategy</code>: loads OCSP first, if not available or the response is invalid, then tries to load CRL and returns the first succeeded result. This strategy is used by default for revocation retrieving.</p>
</li>
<li>
<p><code>CRLFirstRevocationDataLoadingStrategy</code>: fetches firstly CRL response, if not available, tries OCSP and returns the first succeeded result.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See section <a href="#certificateVerifier">CertificateVerifier configuration</a> for an example of how to customize a used <code>RevocationDataLoadingStrategy</code>.</p>
</div>
<div class="paragraph">
<p>Using an OCSP first (i.e. <code>OCSPFirstRevocationDataLoadingStrategy</code>) has some advantages:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>There is a potential benefit of freshness compared to using CRLs: in case the OSCP sends queries to a database that is updated in real time or every x hours, the information fetched by the OCSP is more recent (thisUpdate field) than the information contained in the CRL, given that the CRL is built from that database. In the worst case, the OCSP uses the data contained in the CRL and they both have the same thisUpdate field. The information fetched by an OCSP will never be older than the one obtained from a CRL.</p>
</li>
<li>
<p>The certificate that signed the OCSP response might contain an OCSPNoCheck extension. This extension indicates that the revocation data of the certificate that contains the public key linked to the private key that was used to sign the OCSP response does not need to be checked.</p>
</li>
<li>
<p>Getting a response takes less time and less memory space for OCSP than with CRLs. A CRL can take a lot of space and a long time to be downloaded due its big size. There is also no obligation to sort CRLs according to serial number which means that the whole list needs to be browsed until finding the searched serial number.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="SignatureValidation">7. Signature Validation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="CertificateValidation">7.1. Validation of a certificate</h3>
<div class="paragraph">
<p>The signature validation starts from a validation of a certificate chain (cf. <a href="#CertificatePathValidation">Certificate Chain and Certification Path Validation</a>). For a given certificate, the framework builds a certificate path until a known trust anchor (trusted list, keystore,&#8230;&#8203;), validates each found certificate (OCSP / CRL) and determines its European "qualification".</p>
</div>
<div class="paragraph">
<p>To determine the certificate qualification, DSS follows the standard ETSI TS 119 615 (<a href="#R14">[R14]</a>). It analyses the certificate properties (QCStatements, Certificate Policies, etc.) and applies possible overrules from the related trusted list ("catched" qualifiers from a trust service). More information about qualifiers can be found in the standard ETSI TS 119 612 (<a href="#R11">[R11]</a>).</p>
</div>
<div class="paragraph">
<p>DSS always computes the status at 2 different times: certificate issuance and signing/validation time. The certificate qualification can evolve in time, its status is not immutable (e.g.: a trust service provider can lose the granted status). The eIDAS regulation (<a href="#R12">[R12]</a>) clearly defines these different times in the Article 32 and related Annex I.</p>
</div>
<div class="listingblock">
<div class="title">Validate a certificate and retrieve its qualification level</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Firstly, we load the certificate to be validated</span>
CertificateToken token = DSSUtils.loadCertificate(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/keystore/ec.europa.eu.1.cer</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// We need a certificate verifier and configure it  (see specific chapter about the CertificateVerifier configuration)</span>
CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

<span style="color:#777">// We create an instance of the CertificateValidator with the certificate</span>
CertificateValidator validator = CertificateValidator.fromCertificate(token);
validator.setCertificateVerifier(cv);

<span style="color:#777">// Allows specifying which tokens need to be extracted in the diagnostic data (Base64).</span>
<span style="color:#777">// Default : NONE)</span>
validator.setTokenExtractionStrategy(TokenExtractionStrategy.EXTRACT_CERTIFICATES_AND_REVOCATION_DATA);

<span style="color:#777">// We execute the validation</span>
CertificateReports certificateReports = validator.validate();

<span style="color:#777">// We have 3 reports</span>
<span style="color:#777">// The diagnostic data which contains all used and static data</span>
DiagnosticData diagnosticData = certificateReports.getDiagnosticData();

<span style="color:#777">// The detailed report which is the result of the process of the diagnostic data and the validation policy</span>
DetailedReport detailedReport = certificateReports.getDetailedReport();

<span style="color:#777">// The simple report is a summary of the detailed report or diagnostic data (more user-friendly)</span>
SimpleCertificateReport simpleReport = certificateReports.getSimpleReport();</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="TrustAnchorConfiguration">7.1.1. Trust anchor configuration from a certificate store</h4>
<div class="paragraph">
<p>Trust anchors are an essential part of the validation process of a signature as described in section <a href="#TrustAnchors">Trust Anchors and Trust Stores</a>. DSS allows configuring of various trusted certificate source(s). These sources can be defined from a TrustStore (kind of keystore which only contains certificates), a trusted list or a list of trusted lists.</p>
</div>
<div class="sect4">
<h5 id="_trust_store_initialization">7.1.1.1. Trust store initialization</h5>
<div class="paragraph">
<p>If you have a collection of certificates to trust, the easier way to provide them to DSS it to use a KeyStore / TrustStore (cf. <a href="#TrustAnchors">Trust Stores</a>).</p>
</div>
<div class="listingblock">
<div class="title">Trust anchor initialization from a Trust Store</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> CertificateSource trustStoreSource() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {
        KeyStoreCertificateSource keystore = <span style="color:#080;font-weight:bold">new</span> KeyStoreCertificateSource(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/keystore.p12</span><span style="color:#710">&quot;</span></span>), <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">PKCS12</span><span style="color:#710">&quot;</span></span>, getPassword());

        CommonTrustedCertificateSource trustedCertificateSource = <span style="color:#080;font-weight:bold">new</span> CommonTrustedCertificateSource();
        trustedCertificateSource.importAsTrusted(keystore);

        <span style="color:#777">// Optionally, certificates can also be directly added</span>
        trustedCertificateSource.addCertificate(DSSUtils.loadCertificateFromBase64EncodedString(
                        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">MIIC9TCCAd2gAwIBAgIBAjANBgkqhkiG9w0BAQUFADArMQswCQYDVQQGEwJBQTEMMAoGA1UEChMDRFNTMQ4wDAYDVQQDEwVJQ0EgQTAeFw0xMzEyMDIxNzMzMTBaFw0xNTEyMDIxNzMzMTBaMDAxCzAJBgNVBAYTAkFBMQwwCgYDVQQKEwNEU1MxEzARBgNVBAMTCnVzZXIgQSBSU0EwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJUHHAphmSDdQ1t62tppK+dLTANsE2nAj+HCpasS3ohlBsrhteRsvTAbrDyIzCmTYWu/nVI4TGvbzBESwV/QitlkoMLpYFw32MIBf2DLmECzGJ3vm5haw6u8S9quR1h8Vu7QWd+5KMabZuR+j91RiSuoY0xS2ZQxJw1vhvW9hRYjAgMBAAGjgaIwgZ8wCQYDVR0TBAIwADAdBgNVHQ4EFgQU9ESnTWfwg13c3LQZzqqwibY5WVYwUwYDVR0jBEwwSoAUIO1CDsBSUcEoFZxKaWf1PAL1U+uhL6QtMCsxDDAKBgNVBAoTA0RTUzELMAkGA1UEBhMCQUExDjAMBgNVBAMTBVJDQSBBggEBMAsGA1UdDwQEAwIHgDARBgNVHSAECjAIMAYGBFUdIAAwDQYJKoZIhvcNAQEFBQADggEBAGnhhnoyVUhDnr/BSbZ/uWfSuwzFPG+2V9K6WxdIaaXOORFGIdFwGlAwA/Qzpq9snfBxuTkAykxq0uEDhHTj0qXxWRjQ+Dop/DrmccoF/zDvgGusyY1YXaABd/kc3IYt7ns7z3tpiqIz4A7a/UHplBRXfqjyaZurZuJQRaSdxh6CNhdEUiUBxkbb1SdMjuOgjzSDjcDjcegjvDquMKdDetvtu2Qh4ConBBo3fUImwiFRWnbudS5H2HE18ikC7gY/QIuNr7USf1PNyUgcG2g31cMtemj7UTBHZ2V/jPf7ZXqwfnVSaYkNvM3weAI6R3PI0STjdxN6a9qjt9xld40YEdw=</span><span style="color:#710">&quot;</span></span>));

        <span style="color:#080;font-weight:bold">return</span> trustedCertificateSource;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To generate the trust store, there&#8217;s an utility class CreateKeyStoreApp in the dss-cookbook module.</p>
</div>
</div>
<div class="sect4">
<h5 id="_trusted_list_certificate_source">7.1.1.2. Trusted List Certificate Source</h5>
<div class="paragraph">
<p>In several countries, a list of Trust Service Providers (TSP) is published. This list is usually published in a machine processable format (XML) and sometimes in a human-readable format (PDF). A standard (ETSI TS 119 612 <a href="#R11">[R11]</a>) exists with the specifications for the XML format.</p>
</div>
<div class="paragraph">
<p>DSS contains all needed resources to download, parse, validate and interpret the trusted list contents. In DSS, it is possible to configure one or more independent trusted list(s) (aka not linked to a list of trusted lists) and/or one or more list of trusted lists.</p>
</div>
<div class="paragraph">
<p>If you want to collect your trusted certificates from trusted list(s), the TrustedListsCertificateSource is required. The trusted list(s) loading can require some times (connection time-out, xml parsing, xml validation,&#8230;&#8203;). This process is usually executed in background. An instance of TrustedListsCertificateSource needs to be created. That will be synchronized with the TLValidationJob.</p>
</div>
<div class="listingblock">
<div class="title">Trusted List Certificate Source</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> CertificateSource trustedListSource() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TrustedListsCertificateSource();
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_multiple_trusted_sources_usage">7.1.1.3. Multiple Trusted Sources usage</h5>
<div class="paragraph">
<p>DSS provides a possibility to use multiple trusted certificate sources at one time. An example of the configuration is provided below:</p>
</div>
<div class="listingblock">
<div class="title">Multiple trusted certificate sources usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
cv.setTrustedCertSources(trustStoreSource(), trustedListSource());</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_certificate_chain_in_dss">7.1.2. Certificate chain in DSS</h4>
<div class="paragraph">
<p>The validation of a certificate requires the access to some other certificates from multiple sources like trusted lists, trust store, the signature itself: certificates can be contained inside any other source.
Within the framework, an X509 certificate is wrapped through the class:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.model.x509.CertificateToken</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This encapsulation helps make certificate handling more suited to the needs of the validation in the context of trust. The framework associates two internal identifiers to the certificate: the DSS Id based on the certificate binary (unique for each certificate) and the Entity Id based on its public key (common to cross-signed certificates).</p>
</div>
<div class="paragraph">
<p>Certificate tokens are grouped into sources. A certificate token can be declared in several sources. The class that models a source is called:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.spi.x509.CertificateSource</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This class stores all extracted/injected certificates for a specific source (Signature, OCSP Response, Trust store, Trusted-list, etc.). All source types are specified in the enumeration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.enumerations.CertificateSourceType</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This information is used, for example, to distinguish between the certificate from a trusted source and the others. A source has one and only one type, but a certificate token can be found in multiple sources.
The DSS framework supplies some standard implementations, but also gives the possibility to implement custom solutions. Among the standard solutions you can find:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.spi.x509.CommonCertificateSource</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the superclass of almost of the certificate sources. It stores the extracted certificates and implements the common methods from the <code>CertificateSource</code> to retrieve certificate(s) by subject, public key, subject key identifier (ski), etc.</p>
</div>
<div class="paragraph">
<p>It also exposes the method <code>CommonCertificateSource#addCertificate</code> which gives the possibility to add manually any <code>CertificateToken</code> as a part of this source.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.spi.x509.CommonTrustedCertificateSource</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The CommonTrustedCertificateSource is a certificate source for trusted certificates. All added certificates are marked as trust anchors and no revocation data are required for these certificates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.validation.SignatureCertificateSource</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This class and its sub-classes are used to extract and collect certificates from signatures / timestamps. It also has methods to retrieve certificates / certificate references by their origin (e.g. SigningCertificate attribute, DSS Dictionary, etc.).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.spi.tsl.TrustedListsCertificateSource</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certificates coming from the list of Trusted Lists. This class inherits of <code>CommonTrustedCertificateSource</code> and  gives the mechanism to define the set of trusted certificates (trust anchors). They are used in the validation process to decide if the prospective certificate chain has a trust anchor. See section <a href="#tlValidationJob">Configuration of TL validation job</a> to get more information about trusted lists loading (e.g. EU Trusted List).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.spi.x509.ListCertificateSource</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This class follows the composite design pattern with a list of CertificateSources. That is used in the validation to retrieve all sources from the signatures / timestamps / revocation data / trusted lists / etc. It contains some methods which check over all sources to retrieve certificates or verify if a certificate is trusted.</p>
</div>
<div class="sect4">
<h5 id="_retrieving_certificates_by_aia">7.1.2.1. Retrieving certificates by AIA</h5>
<div class="paragraph">
<p>In case when intermediate certificates are not present within a signature document, nor in trusted/adjunct sources, a certificate chain can still be built using AIA URL obtained from a certificate (See <a href="#CertificatePathValidation">Certificate Chain and Certification Path Validation</a>).</p>
</div>
<div class="paragraph">
<p>To use AIA URLs DSS provides the interface <code>AIASource</code> with the following implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DefaultAIASource</code> - the default implementation used in DSS, allowing retrieving of certificates by AIA URL from online sources. The class allows configuring a list of accepted protocols to be used for remote requests.</p>
</li>
<li>
<p><code>JdbcCacheAIASource</code> - a cache AIA Source, allowing storing and accessing of certificates from a JDBC database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of <code>DefaultAIASource</code> configuration can be found below:</p>
</div>
<div class="listingblock">
<div class="title">DefaultAIASource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">Set</span>&lt;CertificateToken&gt; certificates = aiaSource.getCertificatesByAIA(certificateToken);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_revocation_data_handling">7.1.3. Revocation data handling</h4>
<div class="paragraph">
<p>For information on how revocation of data is handled, see chapter <a href="#RevocationDataManagement">Revocation data management</a>.</p>
</div>
<div class="sect4">
<h5 id="_revocation_freshness">7.1.3.1. Revocation freshness</h5>
<div class="paragraph">
<p>The revocation freshness constraint (RFC) is a time interval indicating that the validation accepts CRLs that were emitted at a point in time after the validation time minus the RFC: <code>valTime - RFC &lt; CRL.thisUpdate</code>.</p>
</div>
<div class="paragraph">
<p>If the RFC is respected by a CRL then that CRL can be used. Otherwise, the CRl shall be rejected and shall not be used to determine whether the certificate is revoked or not. Another CRL can be searched online. If no CRL respecting the RFC is found, then it cannot be determined whether the certificate is valid, and it is thus not possible to determine whether the signature is valid.</p>
</div>
<div class="paragraph">
<p>In case of a signature with a <code>BASELINE-T</code> level, the validation time can be replaced by the best-signature-time when checking the constraint. Revocation data should be issued after the best-signature-time, provided by a signature timestamp.</p>
</div>
<div class="paragraph">
<p>In case of a <code>BASELINE-B</code> level, there is no timestamp among the unsigned attributes. If the RFC is equal to 0 then the validation time needs to be smaller than the <code>CRL.thisUpdate</code>. This means that the revocation data needs to have been issued after the validation process is concluded which is not possible.</p>
</div>
<div class="paragraph">
<p>According to the ETSI TS 119 172-4 (cf. <a href="#R10">[R10]</a>) standard, the RFC shall be set to 0. If DSS had had an RFC equal to 0 then it would invalidate all B-level signatures without a signature timestamp. Therefore, revocation freshness is not checked in DSS by default. The validation level of the check is set to <code>IGNORE</code>, meaning users are shown that the check exists, but it is not executed in the validation process.</p>
</div>
<div class="paragraph">
<p>As DSS allows using a custom validation policy (see <a href="#validationPolicy">AdES validation constraints/policy</a>), it is possible to change the validation level of the check and to define a revocation freshness constraint. The validation level and time interval are defined within the <code>&lt;Revocation&gt;&lt;RevocationFreshness /&gt;&lt;/Revocation&gt;</code> constraint.</p>
</div>
<div class="paragraph">
<p>In the current policy it is not possible to define different time intervals for different certificate chains (i.e. signing certificate, CA certificate, timestamp cert, etc.), but it is possible to enforce different validation levels for the different certificate chains (e.g. <code>FAIL</code> for signing certificate, <code>WARN</code> for CA certificate, etc). The validation level for specific certificate tokens can be enforced within <code>&lt;BasicSignatureConstraints&gt;&lt;RevocationDataFreshness /&gt;&lt;/BasicSignatureConstraints&gt;</code> constraint inside a specific token&#8217;s element, respectively.</p>
</div>
<div class="paragraph">
<p>For example for the current RevocationFreshness and the current RevocationDataFreshness:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;Revocation&gt;</span><span style="color:#070;font-weight:bold">&lt;RevocationFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Unit</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DAYS</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span> … <span style="color:#070;font-weight:bold">&lt;/Revocation&gt;</span>
<span style="color:#070;font-weight:bold">&lt;CACertificate&gt;</span> <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span> … <span style="color:#070;font-weight:bold">&lt;/CACertificate&gt;</span>
<span style="color:#070;font-weight:bold">&lt;SigningCertificate&gt;</span><span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span><span style="color:#070;font-weight:bold">&lt;/SigningCertificate&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The RevocationDataFreshness check of the CA certificate will result in a warning if the RevocationFreshness fails which is the case if the revocation data is older than 2 days.</p>
</li>
<li>
<p>The RevocationDataFreshness check of the signing certificate will fail if the RevocationFreshness fails which is the case if the revocation data is older than 2 days.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>No matter the certificate, the revocation data shall have been issued no later than two days prior to the validation process. However, the validation levels for the signing and CA certificates of this example are different.</p>
</div>
<div class="paragraph">
<p>In case of a custom validation policy with the following RevocationFreshness and RevocationDataFreshness of a CA certificate:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;Revocation&gt;</span><span style="color:#070;font-weight:bold">&lt;RevocationFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">IGNORE</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Unit</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DAYS</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span> … <span style="color:#070;font-weight:bold">&lt;/Revocation&gt;</span>
<span style="color:#070;font-weight:bold">&lt;CACertificate&gt;</span> <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span> … <span style="color:#070;font-weight:bold">&lt;/CACertificate&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the validation level of the RevocationFreshness is set to IGNORE, it will never fail. Any CA certificate revocation data will be usable no matter how long ago it was issued.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="certificateVerifier">7.1.4. CertificateVerifier configuration</h4>
<div class="paragraph">
<p>The <code>CertificateVerifier</code> and its implementation <code>CommonCertificateVerifier</code> determines how DSS accesses the external resources and how it should react in some occasions. This object is used to provide four different sources of information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the source of trusted certificates (based on the trusted list(s) specific to the context);</p>
</li>
<li>
<p>the source of intermediate certificates used to build the certificate chain until the trust anchor. This source is only needed when these certificates are not included in the signature itself;</p>
</li>
<li>
<p>the source of OCSP;</p>
</li>
<li>
<p>the source of CRL.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the current implementation this object is only used when profiles <code>BASELINE-LT</code> or <code>BASELINE-LTA</code> are created.
This configuration shall be provided into both augmentation and validation processes.</p>
</div>
<div class="listingblock">
<div class="title">CertificateVerifier usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

<span style="color:#777">// The AIA source is used to collect certificates from external resources (AIA)</span>
cv.setAIASource(aiaSource);

<span style="color:#777">// The adjunct certificate source is used to provide missing intermediate certificates</span>
<span style="color:#777">// (not trusted certificates)</span>
cv.setAdjunctCertSources(adjunctCertSource);

<span style="color:#777">// The trusted certificate source is used to provide trusted certificates </span>
<span style="color:#777">// (the trust anchors where the certificate chain building should stop)</span>
cv.setTrustedCertSources(trustedCertSource);

<span style="color:#777">// The CRL Source to be used for external accesses (can be configured with a</span>
<span style="color:#777">// cache,...)</span>
cv.setCrlSource(crlSource);

<span style="color:#777">// The OCSP Source to be used for external accesses (can be configured with a</span>
<span style="color:#777">// cache,...)</span>
cv.setOcspSource(ocspSource);

<span style="color:#777">// Sets the default digest algorithm that will be used for digest calculation</span>
<span style="color:#777">// of tokens used during the validation process. </span>
<span style="color:#777">// The values will be used in validation reports.</span>
<span style="color:#777">// Default : DigestAlgorithm.SHA256</span>
cv.setDefaultDigestAlgorithm(DigestAlgorithm.SHA512);

<span style="color:#777">// Define the behavior to be followed by DSS in case of revocation checking for</span>
<span style="color:#777">// certificates issued from an unsure source (DSS v5.4+)</span>
<span style="color:#777">// Default : revocation check is disabled for unsure sources (security reasons)</span>
cv.setCheckRevocationForUntrustedChains(<span style="color:#069">false</span>);

<span style="color:#777">// DSS v5.4+ : The 3 below configurations concern the extension mode (LT/LTA</span>
<span style="color:#777">// extension)</span>

<span style="color:#777">// Defines a behavior in case of missing revocation data</span>
<span style="color:#777">// Default : ExceptionOnStatusAlert -&gt; interrupt the process</span>
cv.setAlertOnMissingRevocationData(<span style="color:#080;font-weight:bold">new</span> ExceptionOnStatusAlert());

<span style="color:#777">// Defines a behavior if a TSU certificate chain is not covered with a</span>
<span style="color:#777">// revocation data (timestamp generation time &gt; CRL/OCSP production time).</span>
<span style="color:#777">// Default : LogOnStatusAlert -&gt; a WARN log</span>
cv.setAlertOnUncoveredPOE(<span style="color:#080;font-weight:bold">new</span> LogOnStatusAlert(<span style="color:#0a8;font-weight:bold">Level</span>.WARN));

<span style="color:#777">// Defines a behavior if a revoked certificate is present</span>
<span style="color:#777">// Default : ExceptionOnStatusAlert -&gt; interrupt the process</span>
cv.setAlertOnRevokedCertificate(<span style="color:#080;font-weight:bold">new</span> ExceptionOnStatusAlert());

<span style="color:#777">// Defines a behavior if an invalid timestamp is found</span>
<span style="color:#777">// Default : ExceptionOnStatusAlert -&gt; interrupt the process</span>
cv.setAlertOnInvalidTimestamp(<span style="color:#080;font-weight:bold">new</span> ExceptionOnStatusAlert());

<span style="color:#777">// DSS v5.5+ : defines a behavior in case if there is no valid revocation</span>
<span style="color:#777">// data with thisUpdate time after the best signature time</span>
<span style="color:#777">// Example: if a signature was extended to T level then the obtained revocation </span>
<span style="color:#777">// must have thisUpdate time after production time of the signature timestamp.</span>
<span style="color:#777">// Default : LogOnStatusAlert -&gt; a WARN log</span>
cv.setAlertOnNoRevocationAfterBestSignatureTime(<span style="color:#080;font-weight:bold">new</span> LogOnStatusAlert(<span style="color:#0a8;font-weight:bold">Level</span>.ERROR));

<span style="color:#777">// DSS 5.9+ :</span>
<span style="color:#777">// Defines behavior in case if the signing certificate or its related POE(s) have been expired</span>
<span style="color:#777">// Default : ExceptionOnStatusAlert -&gt; interrupt the process</span>
cv.setAlertOnExpiredSignature(<span style="color:#080;font-weight:bold">new</span> ExceptionOnStatusAlert());

<span style="color:#777">// DSS 5.9+ :</span>
<span style="color:#777">// RevocationDataLoadingStrategy defines logic for loading OCSP or CRL data</span>
<span style="color:#777">// Default : OCSPFirstRevocationDataLoadingStrategy -&gt; loads OCSP first,</span>
<span style="color:#777">//                          if not available or the response is invalid, then tries to load CRL</span>
cv.setRevocationDataLoadingStrategy(<span style="color:#080;font-weight:bold">new</span> OCSPFirstRevocationDataLoadingStrategy());</code></pre>
</div>
</div>
<div class="paragraph">
<p>See section <a href="#Alerts">Use of Alerts throughout the framework</a> in the Annex for more information on alerts.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validationPolicy">7.2. AdES validation constraints/policy</h3>
<div class="paragraph">
<p>The validation process is driven by a set of constraints that are contained in the XML policy file.</p>
</div>
<div class="paragraph">
<p>In order to run a validation process with a custom validation policy, an XML file shall be created in compliance with the <a href="https://github.com/esig/dss/blob/master/dss-policy-jaxb/src/main/resources/xsd/policy.xsd">policy.xsd</a> schema and passed to the relevant <code>DocumentValidator</code> as shown below.</p>
</div>
<div class="listingblock">
<div class="title">Custom validation policy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Reports reports = validator.validateDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/path/to/validation/policy.xml</span><span style="color:#710">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_xml_policy_structure">7.2.1. XML policy structure</h4>
<div class="paragraph">
<p>The validation policy allows defining different behavior for various token types or signature formats. The following groups are considered:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ContainerConstraints</code> - defines rules for processing of ASiC containers validation;</p>
</li>
<li>
<p><code>SignatureConstraints</code> - defines rules for signature basic building blocks processing and the related certificate chain;</p>
</li>
<li>
<p><code>CounterSignatureConstraints</code> - allows defining custom rules for counter signature processing;</p>
</li>
<li>
<p><code>Timestamp</code> - defines rules for timestamp validation;</p>
</li>
<li>
<p><code>Revocation</code> - defines rules for revocation data validation;</p>
</li>
<li>
<p><code>Cryptographic</code> - defines common rules for cryptographic validation of used algorithms. The general constraints are used when no cryptographic constraints are defined for a particular token type;</p>
</li>
<li>
<p><code>Model</code> - defines the way of a certificate chain processing;</p>
</li>
<li>
<p><code>eIDAS</code> - defines rules for validation of Trusted Lists.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_constraints">7.2.2. Constraints</h4>
<div class="paragraph">
<p>Each constraint defined in the policy forces an execution of a relevant check in the validation process.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If a constraint is missing in the policy - the check is not processed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following constraint types are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LevelConstraint</code> - a simple constraint type with a defined processing <code>Level</code>;</p>
</li>
<li>
<p><code>MultiValuesConstraint</code> - allows to define a set of accepted values relatively to the using constraint.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_level">7.2.3. Level</h4>
<div class="paragraph">
<p>The <code>Level</code> attribute of a constraint defines a validation process behavior in case of a check failure. While used, the following behaviors apply in case of a check failure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FAIL</code> - brakes the validation process and returns the relevant indication;</p>
</li>
<li>
<p><code>WARN</code> - continues the validation process and returns a warning message to the validation process output;</p>
</li>
<li>
<p><code>INFORM</code> - continues the validation process and returns an information message to the validation process output;</p>
</li>
<li>
<p><code>IGNORE</code> - processes the check in a silent mode. The check is shown in the output report, but does not have impact on the process (equivalent to a not defined constraint).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_multi_values_constraint">7.2.4. Multi Values Constraint</h4>
<div class="paragraph">
<p>When using the <code>MultiValuesConstraint</code>, a list of acceptable values shall be defined in the list of <code>&lt;Id&gt;&#8230;&#8203;&lt;/Id&gt;</code> elements, one for each accepted value. While doing, the following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Empty list of values &#8594; accept only empty values for the item in question, fails otherwise;</p>
</li>
<li>
<p><code>"*"</code> constraint value &#8594; accepts all values, reject empty list of values;</p>
</li>
<li>
<p>Custom values &#8594; accepts only item values matching the constraint.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_cryptographic_constraints">7.2.5. Cryptographic constraints</h4>
<div class="paragraph">
<p>Cryptographic constraints define a list of acceptable cryptographic algorithms and their expiration dates when needed. The following settings are possible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AcceptableEncryptionAlgo</code> - defines a list of acceptable encryption algorithms. All tokens and signatures using other algorithms will be rejected.</p>
</li>
<li>
<p><code>MiniPublicKeySize</code> - defines the minimal allowed public key size to be used with the defined encryption algorithms. An algorithm with a key size less than the defined one will be rejected. The minimal key size if required to be defined for an encryption algorithm, otherwise all used key sizes will be rejected.</p>
</li>
<li>
<p><code>AcceptableDigestAlgo</code> - defines a list of acceptable digest algorithms. All tokens and signatures using other algorithms will be rejected.</p>
</li>
<li>
<p><code>AlgoExpirationDate</code> - defines expiration dates for the algorithms. The algorithm is rejected when it is used after the defined date. If the algorithm expiration date is not defined, or set to null, the algorithm is treated as reliable for an unlimited time.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_the_default_xml_policy">7.2.6. The default XML policy</h4>
<div class="paragraph">
<p>The default XML validation policy is present below.</p>
</div>
<div class="listingblock">
<div class="title">constraint.xml (default policy is provided in dss-policy-jaxb module)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;ConstraintsParameters</span> <span style="color:#b48">Name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">QES AdESQC TL based</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss.esig.europa.eu/validation/policy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Description&gt;</span>Validate electronic signatures and indicates whether they are Advanced electronic Signatures (AdES), AdES supported by a Qualified Certificate (AdES/QC) or a
        Qualified electronic Signature (QES). All certificates and their related chains supporting the signatures are validated against the EU Member State Trusted Lists (this includes
        signer's certificate and certificates used to validate certificate validity status services - CRLs, OCSP, and time-stamps).
    <span style="color:#070;font-weight:bold">&lt;/Description&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;ContainerConstraints&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AcceptableContainerTypes</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>ASiC-S<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>ASiC-E<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/AcceptableContainerTypes&gt;</span>
        <span style="color:#777">&lt;!--                 &lt;ZipCommentPresent Level=&quot;WARN&quot; /&gt; --&gt;</span>
        <span style="color:#777">&lt;!--                 &lt;AcceptableZipComment Level=&quot;WARN&quot;&gt; --&gt;</span>
        <span style="color:#777">&lt;!--                         &lt;Id&gt;mimetype=application/vnd.etsi.asic-s+zip&lt;/Id&gt; --&gt;</span>
        <span style="color:#777">&lt;!--                         &lt;Id&gt;mimetype=application/vnd.etsi.asic-e+zip&lt;/Id&gt; --&gt;</span>
        <span style="color:#777">&lt;!--                 &lt;/AcceptableZipComment&gt; --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;MimeTypeFilePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AcceptableMimeTypeFileContent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>application/vnd.etsi.asic-s+zip<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>application/vnd.etsi.asic-e+zip<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/AcceptableMimeTypeFileContent&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ManifestFilePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;SignedFilesPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AllFilesSigned</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/ContainerConstraints&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;SignatureConstraints&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;StructuralValidation</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AcceptablePolicies</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>ANY_POLICY<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>NO_POLICY<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/AcceptablePolicies&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;PolicyAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;PolicyHashMatch</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AcceptableFormats</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>*<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/AcceptableFormats&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;BasicSignatureConstraints&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataExistence</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ManifestEntryObjectExistence</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SignatureIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SignatureDuplicated</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ProspectiveCertificateChain</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SignerInformationStore</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;PdfPageDifference</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;PdfAnnotationOverlap</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;PdfVisualDifference</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;TrustedServiceTypeIdentifier Level=&quot;WARN&quot;&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/Svctype/CA/QC&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;/TrustedServiceTypeIdentifier&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;TrustedServiceStatus Level=&quot;FAIL&quot;&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/undersupervision&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/accredited&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/supervisionincessation&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;/TrustedServiceStatus&gt; --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Recognition</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;AuthorityInfoAccessPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationInfoAccessPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;KeyUsage</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>nonRepudiation<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/KeyUsage&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;SerialNumberPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationIssuerNotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotSelfSigned</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;Qualification Level=&quot;WARN&quot; /&gt; --&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;SupportedByQSCD Level=&quot;WARN&quot; /&gt; --&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;QcLegislationCountryCodes Level=&quot;WARN&quot; /&gt; --&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;IssuedToNaturalPerson Level=&quot;INFORM&quot; /&gt; --&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;IssuedToLegalPerson Level=&quot;INFORM&quot; /&gt; --&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;UsePseudonym</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">INFORM</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/SigningCertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CACertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/CACertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/BasicSignatureConstraints&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;SignedAttributes&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;UnicitySigningCertificate</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificateRefersCertificateChain</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CertDigestPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CertDigestMatch</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;IssuerSerialMatch</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningTime</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;MessageDigestOrSignedPropertiesPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#777">&lt;!--                &lt;ContentType Level=&quot;FAIL&quot; value=&quot;1.2.840.113549.1.7.1&quot; /&gt;
                        &lt;ContentHints Level=&quot;FAIL&quot; value=&quot;*&quot; /&gt;
                        &lt;CommitmentTypeIndication Level=&quot;FAIL&quot;&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.1&lt;/Id&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.4&lt;/Id&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.5&lt;/Id&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.6&lt;/Id&gt;
                        &lt;/CommitmentTypeIndication&gt;
                        &lt;SignerLocation Level=&quot;FAIL&quot; /&gt;
                        &lt;ContentTimeStamp Level=&quot;FAIL&quot; /&gt; --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/SignedAttributes&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;UnsignedAttributes&gt;</span>
            <span style="color:#777">&lt;!--                &lt;CounterSignature Level=&quot;IGNORE&quot; /&gt; check presence --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/UnsignedAttributes&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/SignatureConstraints&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;CounterSignatureConstraints&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;BasicSignatureConstraints&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataExistence</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SignatureIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SignatureDuplicated</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ProspectiveCertificateChain</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;TrustedServiceTypeIdentifier Level=&quot;WARN&quot;&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/Svctype/CA/QC&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;/TrustedServiceTypeIdentifier&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;TrustedServiceStatus Level=&quot;FAIL&quot;&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/undersupervision&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/accredited&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/supervisionincessation&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/granted&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                                 &lt;Id&gt;http://uri.etsi.org/TrstSvc/TrustedList/Svcstatus/withdrawn&lt;/Id&gt; --&gt;</span>
            <span style="color:#777">&lt;!--                         &lt;/TrustedServiceStatus&gt; --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Recognition</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;AuthorityInfoAccessPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationInfoAccessPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;KeyUsage</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>nonRepudiation<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/KeyUsage&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;SerialNumberPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotSelfSigned</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;Qualification Level=&quot;WARN&quot; /&gt; --&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;SupportedByQSCD Level=&quot;WARN&quot; /&gt; --&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;IssuedToNaturalPerson Level=&quot;INFORM&quot; /&gt; --&gt;</span>
                <span style="color:#777">&lt;!--                                 &lt;IssuedToLegalPerson Level=&quot;INFORM&quot; /&gt; --&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;UsePseudonym</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">INFORM</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/SigningCertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CACertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/CACertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/BasicSignatureConstraints&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;SignedAttributes&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CertDigestPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CertDigestMatch</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;IssuerSerialMatch</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningTime</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;MessageDigestOrSignedPropertiesPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#777">&lt;!--                &lt;ContentType Level=&quot;FAIL&quot; value=&quot;1.2.840.113549.1.7.1&quot; /&gt;
                        &lt;ContentHints Level=&quot;FAIL&quot; value=&quot;*&quot; /&gt;
                        &lt;CommitmentTypeIndication Level=&quot;FAIL&quot;&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.1&lt;/Id&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.4&lt;/Id&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.5&lt;/Id&gt;
                            &lt;Id&gt;1.2.840.113549.1.9.16.6.6&lt;/Id&gt;
                        &lt;/CommitmentTypeIndication&gt;
                        &lt;SignerLocation Level=&quot;FAIL&quot; /&gt;
                        &lt;ContentTimeStamp Level=&quot;FAIL&quot; /&gt; --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/SignedAttributes&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/CounterSignatureConstraints&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Timestamp&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;TimestampDelay</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">IGNORE</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Unit</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DAYS</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;RevocationTimeAgainstBestSignatureTime</span>        <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;BestSignatureTimeBeforeExpirationDateOfSigningCertificate</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;Coherence</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;BasicSignatureConstraints&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataExistence</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SignatureIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ProspectiveCertificateChain</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Recognition</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;ExtendedKeyUsage</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;Id&gt;</span>timeStamping<span style="color:#070;font-weight:bold">&lt;/Id&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/ExtendedKeyUsage&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotSelfSigned</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/SigningCertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CACertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/CACertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/BasicSignatureConstraints&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;SignedAttributes&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#777">&lt;!-- &lt;UnicitySigningCertificate Level=&quot;WARN&quot; /&gt; RFC 5816 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificateRefersCertificateChain</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CertDigestPresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;IssuerSerialMatch</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/SignedAttributes&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;TSAGeneralNameContentMatch</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/Timestamp&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Revocation&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;RevocationFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">IGNORE</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Unit</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DAYS</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;UnknownStatus</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;SelfIssuedOCSP</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;BasicSignatureConstraints&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataExistence</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ReferenceDataIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SignatureIntact</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ProspectiveCertificateChain</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;SigningCertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Recognition</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/SigningCertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;CACertificate&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Signature</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataAvailable</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;CRLNextUpdatePresent</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;RevocationDataFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotRevoked</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;NotOnHold</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/CACertificate&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/BasicSignatureConstraints&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/Revocation&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;Cryptographic</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AcceptableEncryptionAlgo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>RSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>DSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#777">&lt;!--                 &lt;Algo&gt;Ed25519&lt;/Algo&gt;                                 Not referenced in ETSI/SOGIS --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/AcceptableEncryptionAlgo&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;MiniPublicKeySize&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1024</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>DSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1024</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>RSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">160</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">160</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#777">&lt;!--                 &lt;Algo Size=&quot;24&quot;&gt;Ed25519&lt;/Algo&gt;                 Not referenced in ETSI/SOGIS --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/MiniPublicKeySize&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AcceptableDigestAlgo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>MD2<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>MD5<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA1<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA224<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA256<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA384<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA512<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA3-224<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA3-256<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA3-384<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>SHA3-512<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>RIPEMD160<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo&gt;</span>WHIRLPOOL<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/AcceptableDigestAlgo&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;AlgoExpirationDate</span> <span style="color:#b48">Format</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yyyy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#777">&lt;!-- Digest algorithms --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2005</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>MD2<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- The same as for MD5 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2005</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>MD5<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2009</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA1<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.0.0 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2023</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA224<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA256<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA384<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA512<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA3-224<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA3-256<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA3-384<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>SHA3-512<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2011</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>RIPEMD160<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.0.0 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2015</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>WHIRLPOOL<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.1.1 --&gt;</span>
            <span style="color:#777">&lt;!-- end Digest algorithms --&gt;</span>
            <span style="color:#777">&lt;!-- Encryption algorithms --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2013</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1024</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>DSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2023</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2048</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>DSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">3072</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>DSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2009</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1024</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>RSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.0.0 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2016</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1536</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>RSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2023</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1900</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>RSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">3000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>RSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2013</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">160</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2013</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">192</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2016</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">224</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">256</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">384</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">512</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2013</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">160</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2013</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">192</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI TS 102 176-1 (Historical) V2.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2016</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">224</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.1.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">256</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">384</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;Algo</span> <span style="color:#b48">Date</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2026</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Size</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">512</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PLAIN-ECDSA<span style="color:#070;font-weight:bold">&lt;/Algo&gt;</span> <span style="color:#777">&lt;!-- ETSI 119 312 V1.3.1 --&gt;</span>

            <span style="color:#777">&lt;!--                 &lt;Algo Date=&quot;2026&quot; Size=&quot;32&quot;&gt;Ed25519&lt;/Algo&gt;                 Not referenced in ETSI/SOGIS --&gt;</span>
            <span style="color:#777">&lt;!-- end Encryption algorithms --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/AlgoExpirationDate&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/Cryptographic&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;Model</span> <span style="color:#b48">Value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">SHELL</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- eIDAS REGL 910/EU/2014 --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;eIDAS&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;TLFreshness</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Unit</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">HOURS</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">Value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">6</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;TLNotExpired</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;TLWellSigned</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">WARN</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;TLVersion</span> <span style="color:#b48">Level</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FAIL</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">5</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/eIDAS&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/ConstraintsParameters&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="signatureValidationProcess">7.3. Signature validation in one method and 4 outputs</h3>
<div class="paragraph">
<p>Generally, a signature validation process outputs an indication status and a validation report as described in section <a href="#SignatureValidationModel">Signature validation (introduction)</a>.</p>
</div>
<div class="paragraph">
<p>In DSS, the result of the validation process consists of four elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#SimpleReport">Simple Report</a>,</p>
</li>
<li>
<p>the <a href="#DetailedReport">Detailed Report</a> ,</p>
</li>
<li>
<p>the <a href="#DiagnosticData">Diagnostic Data</a> and</p>
</li>
<li>
<p>the <a href="#ETSIValidationReport">ETSI Validation Report</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All these reports are encoded using XML, which allows the implementer to easily manipulate and extract information for further analysis. For each report, XML Schema and JaxB model are available as maven dependencies.</p>
</div>
<div class="paragraph">
<p>DSS also provides XSLT for generation of PDF or HTML reports (simple and detailed reports).</p>
</div>
<div class="paragraph">
<p>You will find below a detailed description of each of these elements.</p>
</div>
<div class="sect3">
<h4 id="_validating_a_xades_baseline_b_signature">7.3.1. Validating a XAdES baseline B signature</h4>
<div class="paragraph">
<p>The DSS validation process is based on the ETSI standard EN 319 102-1 <a href="#R09">[R09]</a>. It is driven by the validation policy and allows long term signature validation. It not only verifies the existence of certain data and their validity, but it also checks the temporal dependencies between those elements. The signature check is done following basic building blocks. On the simplified diagram below, showing the process of the signature validation, you can follow the relationships between each building block which represents a logic set of checks used in validation process.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/sig_validation_process.jpg" alt="sig validation process">
</div>
<div class="title">Figure 1. Signature Validation Process</div>
</div>
<div class="paragraph">
<p>Note that depending on a used signature format and packaging, the whole or only a part of the original data is signed. Thus, in XAdES the signed content depends on the used transforms within a reference element, and in case of CAdES or PAdES signature the whole document must be signed.</p>
</div>
<div class="paragraph">
<p>At the end of the validation process four reports are created. They contain different detail levels concerning the validation result. They provide different kinds of visions for the validation process: macroscopic, microscopic, validation data and ETSI Validation report conformant with the standard <a href="#R09">[R09]</a>. For more information about these reports, please refer to <a href="#SimpleReport">Simple Report</a>, <a href="#DetailedReport">Detailed Report</a>, <a href="#DiagnosticData">Diagnostic Data</a> and <a href="#ETSIValidationReport">ETSI Validation Report</a> chapters respectively.</p>
</div>
<div class="paragraph">
<p>Below is the simplest example of signature validation from an input document. The first step consists in instantiating an object named validator, which orchestrates the verification of the different rules. To perform this, it is necessary to invoke a static method <code>fromDocument()</code> on the abstract class <code>SignedDocumentValidator</code>. This method returns the object in question whose type is chosen dynamically based on the type of source document.</p>
</div>
<div class="paragraph">
<p>The next step is to create an object that will check the status of a certificate using the Trusted List model (see <a href="#TrustedLists">Trusted Lists</a> for more information). In order to achieve this, an instance of a <code>CertificateVerifier</code> must be created with a defined source of trusted certificates. In our example, the trusted source is instantiated with <code>CommonTrustedCertificateSource</code> class. As well as a trusted source, the <code>CertificateVerifier</code> object needs an OCSP and/or CRL source and a TSL source (which defines how the certificates are retrieved from the Trusted Lists). See chapter <a href="#RevocationDataManagement">Revocation Data Management</a> for more information about revocation sources.</p>
</div>
<div class="listingblock">
<div class="title">Validation of a signature</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// First, we need a Certificate verifier</span>
CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

<span style="color:#777">// We can inject several sources. eg: OCSP, CRL, AIA, trusted lists</span>

<span style="color:#777">// Capability to download resources from AIA</span>
cv.setAIASource(<span style="color:#080;font-weight:bold">new</span> DefaultAIASource());

<span style="color:#777">// Capability to request OCSP Responders</span>
cv.setOcspSource(<span style="color:#080;font-weight:bold">new</span> OnlineOCSPSource());

<span style="color:#777">// Capability to download CRL</span>
cv.setCrlSource(<span style="color:#080;font-weight:bold">new</span> OnlineCRLSource());

<span style="color:#777">// Create an instance of a trusted certificate source</span>
CommonTrustedCertificateSource trustedCertSource = <span style="color:#080;font-weight:bold">new</span> CommonTrustedCertificateSource();
<span style="color:#777">// import the keystore as trusted</span>
trustedCertSource.importAsTrusted(keystoreCertSource);

<span style="color:#777">// Add trust anchors (trusted list, keystore,...) to a list of trusted certificate sources</span>
<span style="color:#777">// Hint : use method {@code CertificateVerifier.setTrustedCertSources(certSources)} in order to overwrite the existing list</span>
cv.addTrustedCertSources(trustedCertSource);

<span style="color:#777">// Additionally add missing certificates to a list of adjunct certificate sources</span>
cv.addAdjunctCertSources(adjunctCertSource);

<span style="color:#777">// Here is the document to be validated (any kind of signature file)</span>
DSSDocument document = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/test/resources/signature-pool/signedXmlXadesLT.xml</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// We create an instance of DocumentValidator</span>
<span style="color:#777">// It will automatically select the supported validator from the classpath</span>
SignedDocumentValidator documentValidator = SignedDocumentValidator.fromDocument(document);

<span style="color:#777">// We add the certificate verifier (which allows to verify and trust certificates)</span>
documentValidator.setCertificateVerifier(cv);

<span style="color:#777">// Here, everything is ready. We can execute the validation (for the example, we use the default and embedded</span>
<span style="color:#777">// validation policy)</span>
Reports reports = documentValidator.validateDocument();

<span style="color:#777">// We have 3 reports</span>
<span style="color:#777">// The diagnostic data which contains all used and static data</span>
DiagnosticData diagnosticData = reports.getDiagnosticData();

<span style="color:#777">// The detailed report which is the result of the process of the diagnostic data and the validation policy</span>
DetailedReport detailedReport = reports.getDetailedReport();

<span style="color:#777">// The simple report is a summary of the detailed report (more user-friendly)</span>
SimpleReport simpleReport = reports.getSimpleReport();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using the <code>TrustedListsCertificateSource</code> class, for performance reasons, consider creating a single instance of this class and initialize it only once.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In general, the signature must cover the entire document so that the DSS framework can validate it. However, e.g. in the case of a XAdES signature, some transformations can be applied on the XML document. They can include operations such as canonicalization, encoding/decoding, XSLT, XPath, XML schema validation, or XInclude. XPath transforms permit the signer to derive an XML document that omits portions of the source document. Consequently, those excluded portions can change without affecting signature validity.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="signedDocumentValidator">7.3.1.1. SignedDocumentValidator</h5>
<div class="paragraph">
<p>For execution of the validation process, DSS uses the <code>SignedDocumentValidator</code> class. The DSS framework provides the following implementations of the validator:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>XMLDocumentValidator</code> - validates documents in XML format (XAdES format);</p>
</li>
<li>
<p><code>CMSDocumentValidator</code> - validates documents in CMS format (CAdES format);</p>
</li>
<li>
<p><code>PDFDocumentValidator</code> - validates documents in PDF format (PADES format);</p>
</li>
<li>
<p><code>JWSCompactDocumentValidator</code> - validates documents with base64url encoded content (JAdES compact format);</p>
</li>
<li>
<p><code>JWSSerializationDocumentValidator</code> - validates documents in JSON format (JAdES serialization formats);</p>
</li>
<li>
<p><code>ASiCContainerWithXAdESValidator</code> - validates ASiC with XAdES containers;</p>
</li>
<li>
<p><code>ASiCContainerWithCAdESValidator</code> - validates ASiC with CAdES containers;</p>
</li>
<li>
<p><code>DetachedTimestampValidator</code> - validates CMS timestamps provided alone.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DSS initializes a relevant validator based on specific characteristics of an input file (e.g. a PDF file version declaration for a PDF file). It checks the file format and loads the required validator from a classpath. Below you can find a list of settings that can be used for the configuration of the class.</p>
</div>
<div class="listingblock">
<div class="title">SignedDocumentValidator usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// The method allows instantiation of a related validator for a provided document </span>
<span style="color:#777">// independently on its format (the target dss module must be added as dependency)</span>
SignedDocumentValidator documentValidator = SignedDocumentValidator.fromDocument(document);

<span style="color:#777">// Allows specifying a custom certificate verifier (online or offline)</span>
documentValidator.setCertificateVerifier(<span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier());

<span style="color:#777">// Allows specifying which tokens need to be extracted in the diagnostic data (Base64).</span>
<span style="color:#777">// Default : NONE)</span>
documentValidator.setTokenExtractionStrategy(TokenExtractionStrategy.EXTRACT_CERTIFICATES_AND_TIMESTAMPS);

<span style="color:#777">// Allows providing signing certificate(s) in the explicit way, in case if the</span>
<span style="color:#777">// certificate is not provided in the signature itself (can be used for non-ASiC signatures)</span>
CertificateSource signingCertificateSource = <span style="color:#080;font-weight:bold">new</span> CommonCertificateSource();
signingCertificateSource.addCertificate(DSSUtils.loadCertificateFromBase64EncodedString(
                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">MIIC9TCCAd2gAwIBAgIBAjANBgkqhkiG9w0BAQUFADArMQswCQYDVQQGEwJBQTEMMAoGA1UEChMDRFNTMQ4wDAYDVQQDEwVJQ0EgQTAeFw0xMzEyMDIxNzMzMTBaFw0xNTEyMDIxNzMzMTBaMDAxCzAJBgNVBAYTAkFBMQwwCgYDVQQKEwNEU1MxEzARBgNVBAMTCnVzZXIgQSBSU0EwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAJUHHAphmSDdQ1t62tppK+dLTANsE2nAj+HCpasS3ohlBsrhteRsvTAbrDyIzCmTYWu/nVI4TGvbzBESwV/QitlkoMLpYFw32MIBf2DLmECzGJ3vm5haw6u8S9quR1h8Vu7QWd+5KMabZuR+j91RiSuoY0xS2ZQxJw1vhvW9hRYjAgMBAAGjgaIwgZ8wCQYDVR0TBAIwADAdBgNVHQ4EFgQU9ESnTWfwg13c3LQZzqqwibY5WVYwUwYDVR0jBEwwSoAUIO1CDsBSUcEoFZxKaWf1PAL1U+uhL6QtMCsxDDAKBgNVBAoTA0RTUzELMAkGA1UEBhMCQUExDjAMBgNVBAMTBVJDQSBBggEBMAsGA1UdDwQEAwIHgDARBgNVHSAECjAIMAYGBFUdIAAwDQYJKoZIhvcNAQEFBQADggEBAGnhhnoyVUhDnr/BSbZ/uWfSuwzFPG+2V9K6WxdIaaXOORFGIdFwGlAwA/Qzpq9snfBxuTkAykxq0uEDhHTj0qXxWRjQ+Dop/DrmccoF/zDvgGusyY1YXaABd/kc3IYt7ns7z3tpiqIz4A7a/UHplBRXfqjyaZurZuJQRaSdxh6CNhdEUiUBxkbb1SdMjuOgjzSDjcDjcegjvDquMKdDetvtu2Qh4ConBBo3fUImwiFRWnbudS5H2HE18ikC7gY/QIuNr7USf1PNyUgcG2g31cMtemj7UTBHZ2V/jPf7ZXqwfnVSaYkNvM3weAI6R3PI0STjdxN6a9qjt9xld40YEdw=</span><span style="color:#710">&quot;</span></span>));
documentValidator.setSigningCertificateSource(signingCertificateSource);

<span style="color:#777">// Sets the detached contents that were used for the detached signature creation</span>
documentValidator.setDetachedContents(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(<span style="color:#080;font-weight:bold">new</span> InMemoryDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world!</span><span style="color:#710">&quot;</span></span>.getBytes())));

<span style="color:#777">// Allows defining a custom Process Executor</span>
<span style="color:#777">// By default used {@code new DefaultSignatureProcessExecutor()}</span>
documentValidator.setProcessExecutor(<span style="color:#080;font-weight:bold">new</span> DefaultSignatureProcessExecutor());

<span style="color:#777">// Sets custom Signature Policy Provider</span>
documentValidator.setSignaturePolicyProvider(<span style="color:#080;font-weight:bold">new</span> SignaturePolicyProvider());

<span style="color:#777">// Sets an expected signature validation level</span>
<span style="color:#777">// The recommended level is ARCHIVAL_DATA (maximal level of the validation)</span>
<span style="color:#777">// Default : ValidationLevel.ARCHIVAL_DATA</span>
documentValidator.setValidationLevel(ValidationLevel.ARCHIVAL_DATA);

<span style="color:#777">// Sets if the ETSI validation report must be created </span>
<span style="color:#777">// If true, it will become accessible through the method below</span>
<span style="color:#777">// Default : true</span>
documentValidator.setEnableEtsiValidationReport(<span style="color:#069">true</span>);

<span style="color:#777">// Sets if the semantics for Indication / SubIndication must be included in the</span>
<span style="color:#777">// Simple Report (see table 5 / 6 of the ETSI TS 119 102-1)</span>
<span style="color:#777">// Default : false</span>
documentValidator.setIncludeSemantics(<span style="color:#069">true</span>);

<span style="color:#777">// Executes the validation process and produces validation reports:</span>
<span style="color:#777">// Simple report, Detailed report, Diagnostic data and ETSI Validation Report (if enabled)</span>
Reports reports = documentValidator.validateDocument();

<span style="color:#777">// Returns ETSI Validation Report (if enabled, NULL otherwise)</span>
ValidationReportType etsiValidationReport = reports.getEtsiValidationReportJaxb();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="SimpleReport">7.3.2. Simple report</h4>
<div class="paragraph">
<p>The result of the validation process is based on very complex rules. The purpose of this report is to make as simple as possible the information while keeping the most important elements. Thus the end user can, at a glance, have a synthetic view of the validation. To build this report the framework uses some simple rules and the detailed report as input.</p>
</div>
<div class="paragraph">
<p>A sample of the simple validation report can be found <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_samples/simple-report-example.xml">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="DetailedReport">7.3.3. Detailed report</h4>
<div class="paragraph">
<p>The structure of a Detailed Report is based on the ETSI EN 319 102-1 standard (<a href="#R09">[R09]</a>).</p>
</div>
<div class="paragraph">
<p>It is a representation of steps performed during the validation process, as defined in the ETSI EN 319 102-1 standard, and structured using the processes and blocks defined in that standard:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Basic Building Blocks;</p>
</li>
<li>
<p>Validation Process for Basic Signatures;</p>
</li>
<li>
<p>Time-stamp validation building block;</p>
</li>
<li>
<p>Validation process for Signatures with Time and Signatures with Long-Term Validation Material;</p>
</li>
<li>
<p>Validation process for Signatures providing Long Term Availability and Integrity of Validation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example the Basic Building Blocks are divided into seven elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>FC</strong> - Format Checking</p>
</li>
<li>
<p><strong>ISC</strong> - Identification of the Signing Certificate</p>
</li>
<li>
<p><strong>VCI</strong> - Validation Context Initialization</p>
</li>
<li>
<p><strong>RFC</strong> - Revocation Freshness Checker</p>
</li>
<li>
<p><strong>XCV</strong> - X.509 certificate validation</p>
</li>
<li>
<p><strong>CV</strong> - Cryptographic Verification</p>
</li>
<li>
<p><strong>SAV</strong> - Signature Acceptance Validation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following additional elements also can be executed in case of validation in the past :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>PCV</strong> - Past Certificate Validation</p>
</li>
<li>
<p><strong>VTS</strong> - Validation Time Sliding process</p>
</li>
<li>
<p><strong>POE extraction</strong> - Proof Of Existence extraction</p>
</li>
<li>
<p><strong>PSV</strong> - Past Signature Validation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To process the revocation data, DSS performs the following additional checks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CRS</strong> (CertificateRevocationSelector) - validates a set of revocation data for a given certificate and returns the latest valid entry known to contain information about the concerned certificate.</p>
</li>
<li>
<p><strong>RAC</strong> (RevocationAcceptanceCheck) - verifies whether one single revocation data is known to contain information about the concerned certificate.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Past certificate/signature validation is used when basic validation of a certificate/signature fails at the current time with an `INDETERMINATE `status such that the provided proofs of existence may help to go to a determined status. The process shall initialize the <em>best-signature-time</em> either to a time indication for a related POE provided, or the current time when this parameter has not been used by the algorithm.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Best-signature-time</strong> is an internal variable for the algorithm denoting the earliest time when it can be trusted by the SVA (either because proven by some POE present in the signature or passed by the DA and for this reason assumed to be trusted) that a signature has existed. <a href="#R09">[R09]</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each block contains a number of rules that are executed sequentially. The rules are driven by the constraints defined in the validation policy. The result of each rule is OK or NOT OK. The process is stopped when the first rule fails. Each block also contains a conclusion. If all rules are met then the conclusion node indicates <code>PASSED</code>. Otherwise, <code>FAILED</code> or <code>INDETERMINATE</code> indication is returned depending on the ETSI standard definition.</p>
</div>
<div class="paragraph">
<p>Furthermore, a module has been introduced in DSS to allow changing the language of reports generated by DSS. Currently, this is only possible for messages for the checks executed during the validation process. For more information on that topic, see section <a href="#i18nLanguage">Language of reports</a>.</p>
</div>
<div class="paragraph">
<p>A sample of a DetailedReport is provided <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_samples/detailed-report-example.xml">here</a>, and an illustration on how to interpret "what when wrong" based on a detailed report is provided in <a href="#DetaliedReportInterpretation">Interpreting a detailed report</a></p>
</div>
</div>
<div class="sect3">
<h4 id="DiagnosticData">7.3.4. Diagnostic data</h4>
<div class="paragraph">
<p>Diagnostic data is a data set constructed from the information contained in the signature itself, but also from information retrieved dynamically like revocation data and information extrapolated like the mathematical validity of a signature. The diagnostic data is constructed before the validation is completed, and it is used by DSS to validate the signature and create a validation report.</p>
</div>
<div class="paragraph">
<p>The diagnostic data is independent of the applied validation policy. Two different validation policies applied to the same diagnostic data can lead to different results.</p>
</div>
<div class="paragraph">
<p>It is also possible to "replay the diagnostic data". Since the diagnostic data is constructed before the validation, it can be used to see what the validation report would have been if certain fields of the diagnostic data would have been different. For example, changing the digest method from SHA-256 to SHA-1 would result in different validation reports. The impact of the different fields on the validation can be observed by replaying the diagnostic data.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The validation report resulting from the replay of the diagnostic data is useful for observation but cannot be used as a proof of signature validity like the validation report directly resulting from a validation process.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_samples/diagnostic-data-example.xml">Here</a> is an example of the diagnostic data for a XAdES signature. Certain fields and certain values were trimmed or deleted to make reading easier.</p>
</div>
</div>
<div class="sect3">
<h4 id="ETSIValidationReport">7.3.5. ETSI validation report</h4>
<div class="paragraph">
<p>The ETSI Validation Report represents an implementation of TS 119 102-2 (cf. <a href="#R13">[R13]</a>). The report contains a standardized result of an ASiC digital signature validation. It includes the original validation input data, the applied validation policy, as well as the validation result of one or more signature(s) and its(their) constraints.</p>
</div>
<div class="paragraph">
<p>An example of the ETSI validation report can be found <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_samples/etsi-validation-report-example.xml">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_stylesheets_for_validation_reports_and_diagnostic_data">7.3.6. Stylesheets for validation reports and diagnostic data</h4>
<div class="paragraph">
<p>When reports are generated they are in the XML format, which is not the most straightforward way of reading a report. Therefore, stylesheets are used. A stylesheet is a set of rules that transforms XML content into an HTML or PDF representation to have a human-readable text.
Refer to section <a href="#ReportStylesheets">Report stylesheets</a> for more information on the stylesheets used for final report generation.</p>
</div>
<div class="paragraph">
<p>It is also possible to use a stylesheet to generate an SVG image from an XML document such as the diagnostic data. (cf. <a href="#DiagnosticDataStylesheets">Diagnostic data stylesheets</a>)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_various_dss_validation_options">7.4. Various DSS validation options</h3>
<div class="sect3">
<h4 id="_validation_level">7.4.1. Validation level</h4>
<div class="paragraph">
<p>There exist four signature levels: <code>BASELINE-B</code>, <code>BASELINE-T</code>, <code>BASELINE-LT</code> and <code>BASELINE-LTA</code> (cf. <a href="#SignatureClasses">Signature classes/levels</a>). For signature validation, DSS allows indicating which is the level of the signature that needs to be validated. The validation process can be for basic signatures, signatures with long-term validation data or signatures with archival data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_signing_certificate">7.4.2. Signing Certificate</h4>
<div class="paragraph">
<p>DSS allows adding the certificate that was used to sign the document to the inputs for the validation process. This might be useful if the signing certificate was not included as a signed attribute, for example when validating non-AdES signatures.</p>
</div>
</div>
<div class="sect3">
<h4 id="_adjunct_certificates">7.4.3. Adjunct Certificates</h4>
<div class="paragraph">
<p>DSS allows adding a set of certificates that could be used for a certificate path building, e.g. a timestamp certificate, CA certificate, and so on.</p>
</div>
</div>
<div class="sect3">
<h4 id="_certificates">7.4.4. Certificates</h4>
<div class="paragraph">
<p>In DSS, it is possible to return the certificates, included in the signature, as output of the validation process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timestamps">7.4.5. Timestamps</h4>
<div class="paragraph">
<p>DSS allows returning the timestamps, included in the signature, as output of the validation process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_revocation_data">7.4.6. Revocation data</h4>
<div class="paragraph">
<p>In DSS, it is possible to return the revocation data (CRLs and OCSPs), included in the signature, as output of the validation process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_user_friendly_identifiers">7.4.7. User-friendly identifiers</h4>
<div class="paragraph">
<p>DSS supports the use of user-friendly identifiers instead of hash-based values to represent signatures and tokens. A hash-base representation could be "S-651B6527872B53437C7B9A8696BD9F7A6C311CE6EE418EFE34A4A994C05D08C8". The same information but presented in a user-friendly way is a string composed of "SIGNATURE" to indicate that it is a signature, the name in the certificate chain, the signature claimed time and so on.</p>
</div>
</div>
<div class="sect3">
<h4 id="_semantics">7.4.8. Semantics</h4>
<div class="paragraph">
<p>With DSS, it is possible to add a "Semantics" section at the end of the reports explaining the meaning of the result indications, i.e. <code>TOTAL_PASSED</code>, <code>PASSED</code>, <code>INDETERMINATE</code>, <code>NO_CERTIFICATE_CHAIN_FOUND</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ServiceLoaderValidation">7.5. DocumentValidator implementation management</h3>
<div class="paragraph">
<p>For signature document or a signature policy validation, DSS is able to load a corresponding implementation of validator for the given document format at runtime using a <code>ServiceLoader</code> (e.g. <code>XMLDocumentValidator</code> for XAdES signature).</p>
</div>
<div class="paragraph">
<p>DSS is able to choose the required implementation for the following interfaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DocumentValidationFactory</code> - checks a provided signed file&#8217;s format and loads a relevant validator;</p>
</li>
<li>
<p><code>SignaturePolicyValidator</code> - checks a signature policy file and loads a relevant validator to be able to process the detected format.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If no appropriate available implementation is found, an exception will be thrown.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information about <code>ServiceLoader</code> usage please refer to the chapter <a href="#ServiceLoaderAdvanced">ServiceLoader</a>.</p>
</div>
<div class="sect3">
<h4 id="_document_validation_factory">7.5.1. Document Validation Factory</h4>
<div class="paragraph">
<p>This factory is used to create a required instance of a <code>DocumentValidator</code> based on the provided file&#8217;s format (signature or timestamp). An implementation shall process a file format check and load the related <a href="#signedDocumentValidator">SignedDocumentValidator</a> implementation to be used for the file&#8217;s validation.</p>
</div>
<div class="paragraph">
<p>The following implementations are present in DSS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CMSDocumentValidatorFactory</code>: loads <code>CMSDocumentValidator</code>, used for a CAdES validation (delivered in <code>dss-cades</code> module);</p>
</li>
<li>
<p><code>XMLDocumentValidatorFactory</code>: loads <code>XMLDocumentValidator</code>, used for a XAdES validation (delivered in <code>dss-xades</code> module);</p>
</li>
<li>
<p><code>PDFDocumentValidatorFactory</code>: loads <code>PDFDocumentValidator</code>, used for a PAdES validation (delivered in <code>dss-pades</code> module);</p>
</li>
<li>
<p><code>JAdESDocumentValidatorFactory</code>: loads <code>JWSCompactDocumentValidator</code> or <code>JWSSerializationDocumentValidator</code>, depending on provided JSON signature type (delivered in <code>dss-jades</code> module);</p>
</li>
<li>
<p><code>ASiCContainerWithCAdESValidatorFactory</code>: loads <code>ASiCContainerWithCAdESValidator</code> (delivered in <code>dss-asic-cades</code> module);</p>
</li>
<li>
<p><code>ASiCContainerWithXAdESValidatorFactory</code>: loads <code>ASiCContainerWithXAdESValidator</code> (delivered in <code>dss-asic-xades</code> module);</p>
</li>
<li>
<p><code>DetachedTimestampValidatorFactory</code>: loads <code>DetachedTimestampValidator</code>, for an independent timestamp validation (delivered in <code>dss-document</code> module).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_signature_policy_validator">7.5.2. Signature Policy Validator</h4>
<div class="paragraph">
<p>During the signature validation process, the signature policy shall be validated to verify that the retrieved policy is the one that was used for the signature creation. This can be achieved by verifying whether the digest within the <code>SignaturePolicyIdentifier</code> signed attribute of the signature matches the computed digest of the retrieved signature policy document.</p>
</div>
<div class="paragraph">
<p>The signature policy document can be retrieved from the signature itself when a <code>SignaturePolicyStore</code> attribute is present. It can also be retrieved from online or local sources using the <code>SignaturePolicyProvider</code> class (e.g. by URL from the Internet).</p>
</div>
<div class="paragraph">
<p>The interface <code>SignaturePolicyValidator</code> is used to validate a signature policy reference extracted from a signature. The choice of the implementation is format-specific. The following implementations are provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BasicASNSignaturePolicyValidator</code>: validates ASN.1 signature policies;</p>
</li>
<li>
<p><code>XMLSignaturePolicyValidator</code>: validates XML signature policies supporting transformations;</p>
</li>
<li>
<p><code>NonASN1SignaturePolicyValidator</code>: validates a policy by digest computed on an original file&#8217;s content;</p>
</li>
<li>
<p><code>ZeroHashSignaturePolicyValidator</code>: validates a policy if "zero hash" value is defined in a signature (see <a href="#R02">[R02]</a>);</p>
</li>
<li>
<p><code>EmptySignaturePolicyValidator</code>: is proceeded if a policy file is not found or not accessible.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_format_specificities">7.6. Format specificities</h3>
<div class="sect3">
<h4 id="_pades_2">7.6.1. PAdES</h4>
<div class="sect4">
<h5 id="_shadow_attack_detection">7.6.1.1. Shadow attack detection</h5>
<div class="paragraph">
<p>"Shadow attack" is a class of attacks on a signed PDF document that constitutes a change of a visual content of a document after the signature has been made. Due to a structure of PDF document, the signature stays cryptographically valid even after the content&#8217;s modification has been taken place. There are no algorithms to detect the malicious change with 100% guarantee. For more information, please refer to <a href="https://pdf-insecurity.org/">the website</a>.</p>
</div>
<div class="paragraph">
<p>DSS provides a set of own utils to detect the "shadow attack" on a signed PDF document. The following algorithms have been introduced:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Page amount difference</code> - the validation tool compares the number of pages between the obtained PDF and signed revision. If the numbers do not match, the validation fail. The validation level can be configured within the <a href="#validationPolicy">AdES validation constraints/policy</a> with the constraint <code>&lt;PdfPageDifference&gt;</code>.</p>
</li>
<li>
<p><code>Annotations overlap</code> - DSS checks if any annotation overlaps occurred. The overlapping is potentially dangerous, because some annotations can cover a visual content, e.g. forms and signature fields. How this check is applied can be configured with the constraint <code>&lt;PdfAnnotationOverlap&gt;</code>.</p>
</li>
<li>
<p><code>Visual difference</code> - DSS verifies the visual difference between the provided document and signed revision, excluding the newly created annotations (between the validating revisions). How this check is applied can be configured with the constraint <code>&lt;PdfVisualDifference&gt;</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_object_modification_detection">7.6.1.2. Object modification detection</h5>
<div class="paragraph">
<p>As an additional tool to detect malicious changes within a PDF document, an object modification detection has been introduced in DSS 5.10. The util detects all changes occurred within a PDF document after a concerned signature&#8217;s or a timestamp&#8217;s revision.</p>
</div>
<div class="paragraph">
<p>The detected modifications are categorized to four categories, depending on the "insecurity" level:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Extension change</strong> is a secure change defining modification occurred within a PDF document for signature augmentation reasons (e.g. a document timestamp or a /DSS dictionary revision was added);</p>
</li>
<li>
<p><strong>Signature or Form fill</strong> is a change occurred for a signature, visual timestamp creation or available form filling (can be restricted by /DocMDP dictionary);</p>
</li>
<li>
<p><strong>Annotation creation change</strong> defines a created or modified annotation (can be restricted by /DocMDP dictionary);</p>
</li>
<li>
<p><strong>Undefined change</strong> defines a modification that could not be categorized to the upper three categories. It is recommended to investigate the modification in details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following constraints are available to verify the validity of a signature based on encountered object modifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;DocMDP&gt;</code> - when a <code>/DocMDP</code> dictionary is present within a signature, verifies whether the performed modifications in a PDF document are permitted according to the defined level.</p>
</li>
<li>
<p><code>FieldMDP</code> - when a <code>/FieldMDP</code> dictionary is present within a signature, verifies whether the performed modifications in a PDF document are permitted according to the defined level.</p>
</li>
<li>
<p><code>SigFieldLock</code> - when a <code>/FieldMDP</code> dictionary is present within a signature, verifies whether the performed modifications in a PDF document are permitted.</p>
</li>
<li>
<p><code>UndefinedChanges</code> - verifies whether the document contains modifications that cannot be unambiguously identified.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_password_protected_documents">7.6.1.3. Password-protected documents</h5>
<div class="paragraph">
<p>PDF files can be protected using a password. However, DSS does not support the validation of PAdES signatures on PDF documents protected by a password. DSS has no functionality allowing the user to enter the password when submitting a PDF for validation. Thus, the validation of such documents fails.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="RequestingTimestampToken">8. Requesting a timestamp token in DSS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Timestamping is essential when creating digital signatures that need to be preserved. Refer to section <a href="#Timestamps">Timestamping</a> for information about the general principles of the timestamping process. The following sections present how a timestamp token can be requested in DSS.</p>
</div>
<div class="sect2">
<h3 id="_configuring_timestamp_sources">8.1. Configuring timestamp sources</h3>
<div class="paragraph">
<p>The DSS framework proposes a <code>TSPSource</code> interface to implement the communication with a Time Stamp Authority (see section <a href="#_tsa">TSA</a> for more information on Time Stamp Authorities). The class <code>OnlineTSPSource</code> is the default implementation of <code>TSPSource</code> using a HTTP(S) communication layer.</p>
</div>
<div class="paragraph">
<p>The following snippet of Java code illustrates how you might use this class:</p>
</div>
<div class="listingblock">
<div class="title">OnlineTSPSource use</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> tspServer = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss.nowina.lu/pki-factory/tsa/good-tsa</span><span style="color:#710">&quot;</span></span>;
OnlineTSPSource tspSource = <span style="color:#080;font-weight:bold">new</span> OnlineTSPSource(tspServer);
tspSource.setDataLoader(<span style="color:#080;font-weight:bold">new</span> TimestampDataLoader()); <span style="color:#777">// uses the specific content-type</span>

<span style="color:#088;font-weight:bold">final</span> DigestAlgorithm digestAlgorithm = DigestAlgorithm.SHA256;
<span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> toDigest = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world</span><span style="color:#710">&quot;</span></span>.getBytes(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">UTF-8</span><span style="color:#710">&quot;</span></span>);
<span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> digestValue = DSSUtils.digest(digestAlgorithm, toDigest);
<span style="color:#088;font-weight:bold">final</span> TimestampBinary tsBinary = tspSource.getTimeStampResponse(digestAlgorithm, digestValue);

LOG.info(DSSUtils.toHex(tsBinary.getBytes()));</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_timestamp_policy">8.1.1. Timestamp policy</h4>
<div class="paragraph">
<p>A time-stamp policy is a "named set of rules that indicates the applicability of a time-stamp token to a particular community and/or class of application with common security requirements". A TSA may define its own policy which enhances the policy defined in <a href="https://datatracker.ietf.org/doc/html/rfc3628">RFC 3628</a>. Such a policy shall incorporate or further constrain the requirements identified in RFC 3628. The user may request the TSA to issue a timestamp under a specific time-stamp policy that is supported by the TSA.</p>
</div>
<div class="listingblock">
<div class="title">Timestamp policy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">OnlineTSPSource tspSource = <span style="color:#080;font-weight:bold">new</span> OnlineTSPSource(tspServer);
tspSource.setPolicyOid(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0.4.0.2023.1.1</span><span style="color:#710">&quot;</span></span>); <span style="color:#777">// provide a policy OID</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_composite_tsp_sources">8.1.2. Composite TSP sources</h4>
<div class="paragraph">
<p>Sometimes timestamping servers may encounter interruptions (e.g. restart, configuration issues, etc.). To avoid failing signature augmentation, DSS allows a user to configure several TSP Sources. DSS will try one source after the other until getting a usable timestamp token.</p>
</div>
<div class="listingblock">
<div class="title">Configuration of a CompositeTSPSource</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Create a map with several TSPSources</span>
TimestampDataLoader timestampDataLoader = <span style="color:#080;font-weight:bold">new</span> TimestampDataLoader();<span style="color:#777">// uses the specific content-type</span>

OnlineTSPSource tsa1 = <span style="color:#080;font-weight:bold">new</span> OnlineTSPSource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss.nowina.lu/pki-factory/tsa/ee-good-tsa</span><span style="color:#710">&quot;</span></span>);
tsa1.setDataLoader(timestampDataLoader);
OnlineTSPSource tsa2 = <span style="color:#080;font-weight:bold">new</span> OnlineTSPSource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss.nowina.lu/pki-factory/tsa/good-tsa</span><span style="color:#710">&quot;</span></span>);
tsa2.setDataLoader(timestampDataLoader);

<span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, TSPSource&gt; tspSources = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>&lt;&gt;();
tspSources.put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">TSA1</span><span style="color:#710">&quot;</span></span>, tsa1);
tspSources.put(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">TSA2</span><span style="color:#710">&quot;</span></span>, tsa2);

<span style="color:#777">// Instantiate a new CompositeTSPSource and set the different sources</span>
CompositeTSPSource tspSource = <span style="color:#080;font-weight:bold">new</span> CompositeTSPSource();
tspSource.setTspSources(tspSources);

<span style="color:#088;font-weight:bold">final</span> DigestAlgorithm digestAlgorithm = DigestAlgorithm.SHA256;
<span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> toDigest = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world</span><span style="color:#710">&quot;</span></span>.getBytes(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">UTF-8</span><span style="color:#710">&quot;</span></span>);
<span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> digestValue = DSSUtils.digest(digestAlgorithm, toDigest);

<span style="color:#777">// DSS will request the tsp sources (one by one) until getting a valid token.</span>
<span style="color:#777">// If none of them succeeds, a DSSException is thrown.</span>
<span style="color:#088;font-weight:bold">final</span> TimestampBinary tsBinary = tspSource.getTimeStampResponse(digestAlgorithm, digestValue);

LOG.info(DSSUtils.toHex(tsBinary.getBytes()));</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_standalone_timestamping">9. Standalone timestamping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The DSS framework allows an independent document timestamping (without a signature). These are standalone time assertions, i.e. that no augmentation to the level <code>BASELINE-T</code> nor a creation of a signature to this level occurs.</p>
</div>
<div class="paragraph">
<p>The following Document Signature Services support the standalone timestamping :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PAdESService</code> - adds a timestamp to a PDF document;</p>
</li>
<li>
<p><code>ASiCWithCAdESService</code> - creates a timestamped ASiC container with provided documents.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DSS also provides a validation service for timestamped documents.</p>
</div>
<div class="sect2">
<h3 id="_timestamping_a_pdf">9.1. Timestamping a PDF</h3>
<div class="paragraph">
<p>For PAdES, the timestamp shall not be added to the already existing signature like it is the case for example for XAdES. Otherwise, the PAdES signature could not be validated anymore. Instead, a standalone timestamp can be used, creating a new revision.</p>
</div>
<div class="paragraph">
<p>The code below illustrates a time-stamping process for a PDF document.</p>
</div>
<div class="listingblock">
<div class="title">PDF timestamping</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Loads a document to be timestamped</span>
DSSDocument documentToTimestamp = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/hello-world.pdf</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// Configure a PAdES service for PDF timestamping</span>
PAdESService service = <span style="color:#080;font-weight:bold">new</span> PAdESService(getCompleteCertificateVerifier());
service.setTspSource(getGoodTsa());

<span style="color:#777">// Execute the timestamp method</span>
DSSDocument timestampedDoc = service.timestamp(documentToTimestamp, <span style="color:#080;font-weight:bold">new</span> PAdESTimestampParameters());</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_timestamping_with_a_container_asic">9.2. Timestamping with a container (ASiC)</h3>
<div class="paragraph">
<p>Standalone time assertions can be used in both <code>ASiC-E</code> and <code>ASiC-S</code>. When time assertions are used, the difference between the two types of containers is that for <code>ASiC-E</code> a Manifest file is created in order to list the multiple data objects included in the <code>ASiC-E</code> container.</p>
</div>
<div class="paragraph">
<p>A typical example illustrating a time-stamping process that encapsulates the provided documents and the generated time-stamp to an ASiC-E container can be found below</p>
</div>
<div class="listingblock">
<div class="title">ASIC-E time assertion</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Loads document(s) to be timestamped</span>
DSSDocument documentToTimestampOne = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/hello-world.pdf</span><span style="color:#710">&quot;</span></span>));
DSSDocument documentToTimestampTwo = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/xml_example.xml</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// Configure the ASiCWithCAdESService service for documents timestamping within a container</span>
ASiCWithCAdESService service = <span style="color:#080;font-weight:bold">new</span> ASiCWithCAdESService(getCompleteCertificateVerifier());
service.setTspSource(getGoodTsa());

<span style="color:#777">// Initialize parameters and define target container type</span>
ASiCWithCAdESTimestampParameters timestampingParameters = <span style="color:#080;font-weight:bold">new</span> ASiCWithCAdESTimestampParameters();

<span style="color:#777">// Specify the target container level</span>
timestampingParameters.aSiC().setContainerType(ASiCContainerType.ASiC_E);

<span style="color:#777">// Execute the timestamp method</span>
DSSDocument timestampedDoc = service.timestamp(
        <span style="color:#0a8;font-weight:bold">Arrays</span>.asList(documentToTimestampOne, documentToTimestampTwo), timestampingParameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to create an <code>ASiC-S</code>, just change the expected container property in the example above:</p>
</div>
<div class="listingblock">
<div class="title">ASIC-S time assertion</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">timestampingParameters.aSiC().setContainerType(ASiCContainerType.ASiC_S);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_standalone_timestamps_repetition">9.3. Standalone timestamps repetition</h3>
<div class="paragraph">
<p>It is also worth noting that time assertions can cover each other, i.e. that a timestamp can be added over previously created timestamps. In this case, the validation data for a timestamp is incorporated within the previous (last) time assertion and the digest of that timestamp is added to the new created ArchiveManifest XML file, which is covered by a new timestamp.</p>
</div>
<div class="paragraph">
<p>This is a procedure similar to the augmentation of ASiC with CAdES with multiple LTA levels. LTA timestamps are created in different time-assertion files instead of an archive-time-stamp attribute like it is the case in a CAdES signature.</p>
</div>
<div class="paragraph">
<p>This concept is illustrated in the following schema using the ASiC format as an example</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ASIC-time-assertions.jpg" alt="ASIC time assertions">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_standalone_timestamp_validation">9.4. Standalone timestamp validation</h3>
<div class="paragraph">
<p>As well as a single timestamp creation, DSS provides a validation service for timestamped documents. The timestamp validation process represents the one described in section "5.4 Time-stamp validation building block" of <a href="#R09">[R09]</a>. The validation process is similar to the <a href="#signatureValidationProcess">signature validation</a> process. An appropriate validator will be selected automatically. In total, DSS supports timestamp-alone validation for the following file formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Detached CMS timestamp (<code>DetachedTimestampValidator</code>) - a detached signed content must be provided (or its digest);</p>
</li>
<li>
<p>PDF document (<code>PDFDocumentValidator</code>);</p>
</li>
<li>
<p>ASiC CAdES container with a timestamp (<code>ASiCWithCAdESTimestampValidator</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The validation process can be run with the following inputs:</p>
</div>
<div class="listingblock">
<div class="title">Timestamped document validation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Load a document validator. The appropriate validator class will be determined automatically.</span>
SignedDocumentValidator validator = SignedDocumentValidator.fromDocument(timestampedDoc);
<span style="color:#777">// Configure the validator. Provide a certificate verifier.</span>
validator.setCertificateVerifier(getCompleteCertificateVerifier());
<span style="color:#777">// Validate the document</span>
Reports reports = validator.validateDocument();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The produced reports use the same structure as for the <a href="#signatureValidationProcess">signature validation reports</a>.</p>
</div>
<div class="paragraph">
<p>You can find an example of a produced timestamp Detailed Report <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_samples/timestamp-detailed-report-example.xml">here</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_signature_augmentation">10. Signature augmentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Signature augmentation is a process of adding material to go from one signature class to another. Signature augmentation is used for extending the validity of a signature in order to allow its long-term validation.</p>
</div>
<div class="sect2">
<h3 id="_configuration_of_the_augmentation_process">10.1. Configuration of the augmentation process</h3>
<div class="sect3">
<h4 id="_what_are_the_needed_external_resources">10.1.1. What are the needed external resources</h4>
<div class="sect4">
<h5 id="_tsa">10.1.1.1. TSA</h5>
<div class="paragraph">
<p>To augment a signature to levels <code>BASELINE-T</code> and <code>BASELINE-LTA</code> you shall indicate to the service the TSA source, which delivers for each Timestamp Request a Timestamp Response (RFC 3161 (cf. <a href="#R08">[R08]</a>)) containing tokens.
See chapter <a href="#RequestingTimestampToken">Requesting a timestamp token in DSS</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="_revocation_sources">10.1.1.2. Revocation sources</h5>
<div class="paragraph">
<p>To augment a signature to level <code>BASELINE-LT</code> you need to configure revocation sources.
See chapter <a href="#RevocationDataManagement">Revocation data management</a> for more information.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_certificateverifier_properties">10.1.2. CertificateVerifier properties</h4>
<div class="paragraph">
<p>The <code>CertificateVerifier</code> and its implementation <code>CommonCertificateVerifier</code> determines how DSS accesses the external resources and how it should react in some occasions. This configuration is used in both augmentation and validation mode.
See section <a href="#certificateVerifier">CertificateVerifier configuration</a> for more information.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_augmenting_an_ades_baseline_b_signature">10.2. Augmenting an AdES baseline B signature</h3>
<div class="paragraph">
<p>The <code>BASELINE-B</code> level contains immutable signed attributes. Once this level is created, these attributes cannot be changed.
The levels <code>BASELINE-T/-LT/-LTA</code> add unsigned attributes to the signature. This means that the attributes of these levels could be added afterwards to any AdES signature. These unsigned attributes help protect the signature so that it can be validated over a longer period of time. Refer to section <a href="#SignatureClasses">Signature classes/levels</a> for more information on the four signature levels.</p>
</div>
<div class="paragraph">
<p>The augmentation of the signature is incremental, i.e. when augmenting the signature to the <code>BASELINE-LT</code> level, the lower level <code>BASELINE-T</code> will also be added.</p>
</div>
<div class="paragraph">
<p>The whole augmentation process is implemented by reusing components from signature creation. To augment a signature we proceed in the same way as in the case of a signature creation, except that you have to call the function "extendDocument" instead of the "sign" function.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When a document is signed with several signatures, all the signatures are augmented. Augmenting a set of selected signatures is not supported in DSS.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_to_baseline_t">10.2.1. To baseline T</h4>
<div class="paragraph">
<p><code>AdES-BASELINE-T</code> is a signature for which there exists a trusted time associated to the signature (cf. <a href="#SignatureClasses">Signature classes/levels</a>). It provides the initial steps towards providing long term validity and more specifically it provides a protection against repudiation. This extension of the signature can be created during the signature creation process as well as during the signature augmentation process.</p>
</div>
<div class="paragraph">
<p>The <code>AdES-BASELINE-T</code> form must be built on an <code>AdES-BASELINE-B</code> form. The DSS framework allows augmenting the old <code>-BES</code> and <code>-EPES</code> profiles "as if" they were baseline profiles. The added components/attributes are the same, but the created signature is different (e.g. no claimed signing time). Moreover, there is some more support for XAdES extended profiles where the user can select the target augmentation profile.</p>
</div>
<div class="paragraph">
<p>The framework adds the timestamp only if there is no timestamp yet or there is one but the creation of a new augmentation of the level <code>BASELINE-T</code> is deliberate (using another TSA). It is not possible to augment a signature to the <code>BASELINE-T</code> level if it already incorporates a higher level, i.e. <code>BASELINE-LT</code> or <code>BASELINE-LTA</code>. In theory, it would be possible to add another <code>BASELINE-T</code> level when the signature has already reached level <code>BASELINE-LT</code> but the framework prevents this operation.</p>
</div>
<div class="paragraph">
<p>Below is the source code that creates a <code>XAdES-BASELINE-T</code> signature. For our example, we need to initialize an instance of <code>OnlineTSPSource</code> (that has already been configured).</p>
</div>
<div class="listingblock">
<div class="title">Augment a XAdES signature</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">XAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_T);

CommonCertificateVerifier certificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

<span style="color:#777">// Init service for signature augmentation</span>
XAdESService xadesService = <span style="color:#080;font-weight:bold">new</span> XAdESService(certificateVerifier);

<span style="color:#777">// init TSP source for timestamp requesting</span>
xadesService.setTspSource(getOnlineTSPSource());

DSSDocument tLevelSignature = xadesService.extendDocument(signedDocument, parameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the result of adding a new extension of type <code>BASELINE-T</code> to an already existing <code>BASELINE-T</code> level signature (for XAdES):</p>
</div>
<div class="listingblock">
<div class="title">XAdES Unsigned Signature Properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;UnsignedSignatureProperties&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;SignatureTimeStamp</span> <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-b16a2552-b218-4231-8982-40057525fbb5</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;ds:CanonicalizationMethod</span> <span style="color:#b48">Algorithm</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/10/xml-exc-c14n#</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;EncapsulatedTimeStamp</span> <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-token-39fbf78c-9cec-4cc1-ac21-a467d2238405</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>                         MIAGCSqGSIb3DQEHAq...
                <span style="color:#070;font-weight:bold">&lt;/EncapsulatedTimeStamp&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/SignatureTimeStamp&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;SignatureTimeStamp</span> <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-5ffab0d9-863b-414a-9690-a311d3e1af1d</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;ds:CanonicalizationMethod</span> <span style="color:#b48">Algorithm</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/10/xml-exc-c14n#</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;EncapsulatedTimeStamp</span> <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-token-87e8c599-89e5-4fb3-a32a-e5e2a40073ad</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>                         MIAGCSqGSIb3DQEHAq...
                <span style="color:#070;font-weight:bold">&lt;/EncapsulatedTimeStamp&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/SignatureTimeStamp&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/UnsignedSignatureProperties&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_to_baseline_lt">10.2.2. To baseline LT</h4>
<div class="paragraph">
<p>The <code>AdES-BASELINE-LT</code> profile implements the signature class <em>Signature with Long-Term Validation Material</em> (cf. <a href="#SignatureClasses">Signature classes/levels</a>). Augmenting to the <code>AdES-BASELINE-LT</code> will add the <code>CertificateValues</code> and <code>RevocationValues</code> unsigned qualifying properties to the signature.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>CertificateValues</code> element contains the full set of certificates that have been used to validate the electronic signature, including the signer&#8217;s certificate. However, it is not necessary to include one of those certificates if it is already present in the <code>ds:KeyInfo</code> element (in case of XAdES, or within an alternative element for another format) of the signature.</p>
</li>
<li>
<p>The <code>RevocationValues</code> element includes the sources of CRL and/or OCSP.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to find a list of all the certificates and the list of all revocation data, an automatic process of signature validation is executed. To carry out this process an object called <code>CertificateVerifier</code> must be passed to the service. The implementer must set some of its properties (e.g. a source of trusted certificates). Please refer to the <a href="#certificateVerifier">CertificateVerifier configuration</a> section for further information.</p>
</div>
<div class="paragraph">
<p>The code below shows how to use the default parameters with the <code>CertificateVerifier</code> object and how to implement the <code>BASELINE-LT</code> level of signature:</p>
</div>
<div id="SignXmlXadesLTTest.java" class="listingblock">
<div class="title">SignXmlXadesLTTest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_LT);

certificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

CommonsDataLoader commonsDataLoader = <span style="color:#080;font-weight:bold">new</span> CommonsDataLoader();

<span style="color:#777">// init revocation sources for CRL/OCSP requesting</span>
certificateVerifier.setCrlSource(<span style="color:#080;font-weight:bold">new</span> OnlineCRLSource(commonsDataLoader));
certificateVerifier.setOcspSource(<span style="color:#080;font-weight:bold">new</span> OnlineOCSPSource());

<span style="color:#777">// Trust anchors should be defined for revocation data requesting</span>
certificateVerifier.setTrustedCertSources(getTrustedCertificateSource());

xadesService = <span style="color:#080;font-weight:bold">new</span> XAdESService(certificateVerifier);
xadesService.setTspSource(getOnlineTSPSource());
DSSDocument ltLevelDocument = xadesService.extendDocument(tLevelSignature, parameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following XML segment will be added to the signature qualified and unsigned properties (for XAdES):</p>
</div>
<div class="listingblock">
<div class="title">Validation data values</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;CertificateValues&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;EncapsulatedX509Certificate&gt;</span>
                MIIFNTCCBB2gAwIBAgIBATANB...
        <span style="color:#070;font-weight:bold">&lt;/EncapsulatedX509Certificate&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;EncapsulatedX509Certificate&gt;</span>
                MIIFsjCCBJqgAwIBAgIDAMoBM...
        <span style="color:#070;font-weight:bold">&lt;/EncapsulatedX509Certificate&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;EncapsulatedX509Certificate&gt;</span>
                MIIFRjCCBC6gAwIBAgIBATANB...
        <span style="color:#070;font-weight:bold">&lt;/EncapsulatedX509Certificate&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/CertificateValues&gt;</span>
<span style="color:#070;font-weight:bold">&lt;RevocationValues&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;OCSPValues&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;EncapsulatedOCSPValue&gt;</span>
                        MIIGzAoBAKCCBsUwggbBBgkr...
                <span style="color:#070;font-weight:bold">&lt;/EncapsulatedOCSPValue&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/OCSPValues&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/RevocationValues&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The use of online sources can significantly increase the execution time of the signing process. For testing purpose you can create your own source of data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the previous code example, the <code>CommonsDataLoader</code> is used to provide the communication layer for various protocols (e.g. HTTP, HTTPS, LDAP, LDAPS). Each source that requires to go through the network to retrieve data needs to have this component set.</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_baseline_lta">10.2.3. To baseline LTA.</h4>
<div class="paragraph">
<p>The <code>AdES-BASELINE-LTA</code> profile implements the signature class <em>Signature providing Long Term Availability and Integrity of Validation Material</em> (cf. <a href="#SignatureClasses">Signature classes/levels</a>). In practice, the augmentation to <code>BASELINE-LTA</code> level is made by adding timestamps and optionally additional validation data to protect all the validation data incorporated at <code>BASELINE-LT</code> level. For example, this augmentation should happen before one of the certificates arrives to its expiration date or when there is a risk of cryptographic obsolescence of the algorithms and parameters used.</p>
</div>
<div class="paragraph">
<p>E.g. <code>XAdES-BASELINE-LTA</code> level adds the <code>ArchiveTimeStamp</code> element within the <code>UnsignedSignatureProperties</code> and may contain several <code>EncapsulatedTimeStamp</code> elements.</p>
</div>
<div class="paragraph">
<p>Below is an example of the implementation of this level of signature:</p>
</div>
<div class="listingblock">
<div class="title">Signature level setting</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_LTA);

<span style="color:#777">// Initialize CertificateVerifier with data revocation data requesting</span>
certificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

certificateVerifier.setCrlSource(<span style="color:#080;font-weight:bold">new</span> OnlineCRLSource());
certificateVerifier.setOcspSource(<span style="color:#080;font-weight:bold">new</span> OnlineOCSPSource());

certificateVerifier.setTrustedCertSources(getTrustedCertificateSource());

<span style="color:#777">// Initialize signature service with TSP Source for time-stamp requesting</span>
xadesService = <span style="color:#080;font-weight:bold">new</span> XAdESService(certificateVerifier);
xadesService.setTspSource(getOnlineTSPSource());

DSSDocument ltaLevelDocument = xadesService.extendDocument(ltLevelDocument, parameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following XML segment will be added to the signature qualified and unsigned properties (for XAdES):</p>
</div>
<div class="listingblock">
<div class="title">XAdES Archive Timestamp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;ns4:ArchiveTimeStamp</span>
        <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-22b92602-2670-410e-888f-937c5777c685</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ds:CanonicalizationMethod</span>
                <span style="color:#b48">Algorithm</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/10/xml-exc-c14n#</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;EncapsulatedTimeStamp</span>
                <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-token-0bd5aaf3-3850-4911-a22d-c98dcaca5cea</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>MIAGCSqGSDHAqCAM…
        <span style="color:#070;font-weight:bold">&lt;/EncapsulatedTimeStamp&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/ns4:ArchiveTimeStamp&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The time-stamping process may be repeated every time the protection used becomes weak. A new time-stamp needs to be affixed before either the signing certificate of the TSA is expired or the algorithms used by the TSA of the previous time-stamp have become obsolete. The new timestamp and validation material are added into the existing <code>BASELINE-LTA</code> signature.</p>
</div>
<div class="paragraph">
<p>This concept of <code>BASELINE-LTA</code> repetition is illustrated in the following schema.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LTA-repetition.jpg" alt="LTA repetition" width="100%" height="100%">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_baseline_t_signature">10.3. Creating a baseline T signature</h3>
<div class="paragraph">
<p>The normal process of signing wants to sign first with the level <code>-B</code> and then later when it becomes necessary to complete the signature with superior levels. However, the framework allows signing directly with any level.
As a direct signature creation to <code>BASELINE-T</code> level can be useful in order to provide the <em>best-signature-time</em> (and a proof of existence of the signature, respectively) as close as possible to the claimed signing time.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example of signing with the level <code>BASELINE-T</code>.</p>
</div>
<div class="listingblock">
<div class="title">Create a XAdES-BASELINE-T with an OnlineTSPSource</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing parameters for the XAdES signature</span>
XAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();
<span style="color:#777">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_T);
<span style="color:#777">// We choose the type of the signature packaging (ENVELOPED, ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
<span style="color:#777">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span style="color:#777">// same parameter when you invoke the method sign on the token. The default value is SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create XAdES service for signature</span>
XAdESService service = <span style="color:#080;font-weight:bold">new</span> XAdESService(commonCertificateVerifier);

<span style="color:#777">// Set the Timestamp source</span>
<span style="color:#0a8;font-weight:bold">String</span> tspServer = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss.nowina.lu/pki-factory/tsa/good-tsa</span><span style="color:#710">&quot;</span></span>;
OnlineTSPSource onlineTSPSource = <span style="color:#080;font-weight:bold">new</span> OnlineTSPSource(tspServer);
onlineTSPSource.setDataLoader(<span style="color:#080;font-weight:bold">new</span> TimestampDataLoader()); <span style="color:#777">// uses the specific content-type</span>
service.setTspSource(onlineTSPSource);

<span style="color:#777">// Get the SignedInfo XML segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);

<span style="color:#777">// We invoke the service to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The timestamp source shall be defined for <code>BASELINE-T</code> and <code>BASELINE-LTA</code> levels creation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>SignatureTimeStamp</code> mandated by the <code>XAdES-BASELINE-T</code> form appears as an unsigned property within the <code>QualifyingProperties</code>:</p>
</div>
<div class="listingblock">
<div class="title">XAdES Signature Timestamp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;SignatureTimeStamp</span> <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-28a441da-4030-46ef-80e1-041b66c0cb96</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ds:CanonicalizationMethod</span> <span style="color:#b48">Algorithm</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/10/xml-exc-c14n#</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;EncapsulatedTimeStamp</span>
                <span style="color:#b48">Id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">time-stamp-token-76234ed8-cc15-46fc-aa95-9460dd601cad</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                        MIAGCSqGSIb3DQEHAqCAMIACAQMxCzAJBgUrDgMCGg
                        UAMIAGCyqGSIb3DQEJEAEEoIAkgARMMEoCAQEGBoIS
                        ...
        <span style="color:#070;font-weight:bold">&lt;/EncapsulatedTimeStamp&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/SignatureTimeStamp&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_best_practices_regarding_baseline_levels">10.4. Best practices regarding baseline levels</h3>
<div class="paragraph">
<p>For signature creation, it is recommended to use a <code>BASELINE-T</code> level in order to provide the proof of existence (POE) to the signature with a signature time-stamp. This will ensure that the signature has been made during the validity period of the signing-certificate. The <code>BASELINE-B</code> level should not be used for signatures that need to be valid over a longer period of time because it does not contain a timestamp to prove the time of signing.</p>
</div>
<div class="paragraph">
<p>It is not recommended to use <code>BASELINE-LT</code> level or higher on signature creation. The <code>BASELINE-LT</code> level should be added to a signature only after a revocation data update, so that revocation&#8217;s <code>thisUpdate</code> parameter value will be after the <em>best-signing-time</em> provided by the signature time-stamp on <code>BASELINE-T</code> level. This is a requirement of a revocation freshness constraint defined in ETSI EN 319 102-1 (cf. <a href="#R09">[R09]</a>) and enforced by TS 119 172-4 (cf. <a href="#R10">[R10]</a>) with a value '0'.
Since the lower levels are also added when the signature is augmented to a certain level, the <code>BASELINE-LTA</code> level should not be used for signature creation either as it would add <code>BASELINE-LT</code> too.</p>
</div>
<div class="paragraph">
<p>The <code>AdES-BASELINE-T</code> trusted time indications should be created before the signing certificate has been revoked or expired and close to the time that the AdES signature was produced.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the signing certificate has expired before the trusted time indications have been added, it will not be possible to validate the signature anymore. This is why the timestamp should be created before the expiration of the signing certificate.</p>
</li>
<li>
<p>While the expiration date is known since the moment of the creation of the certificate, a certificate can be revoked at any time. To avoid that the certificate gets revoked before the creation of the timestamp, it is important to create the timestamp close to the time that the AdES signature was created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After the revocation data update, satisfying the revocation freshness constraint, the <code>BASELINE-LT</code> level can be incorporated to the signature, providing the information about validity of the used certificate chains. In order to prove the existence of the revocation data, the <code>BASELINE-LTA</code> level should be added after. The <code>BASELINE-LTA</code> level will prove the existence of the incorporated revocation data, so it can be trusted by the validators even after its expiration, as well as will provide a POE for cryptographic constraints and all the previous certificate chains, including the ones used for timestamp creation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="TrustedLists">11. Trusted Lists</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="tlValidationJob">11.1. Configuration of TL validation job</h3>
<div class="paragraph">
<p>The <code>TLValidationJob</code> allows downloading, parsing and validating the Trusted List(s) (TL) (cf. <a href="#EUTL">EU MS Trusted List</a>) and List(s) Of Trusted Lists (LOTL) (cf. <a href="#LOTL">List of Trusted Lists (LOTL)</a>). Once the task is done, its result is stored in the <code>TrustedListsCertificateSource</code>. The job uses 3 different caches (download, parsing and validation) and a state-machine to be efficient.</p>
</div>
<div class="paragraph">
<p>Trusted lists are stored on the file system. That offers the possibility to run in offline mode with the stored trusted lists. Trusted Lists can be loaded from the file system and/or from Internet.</p>
</div>
<div class="paragraph">
<p>In the next sections the different configurations will be covered.</p>
</div>
<div class="sect3">
<h4 id="_tlsource_and_lotlsource">11.1.1. TLSource and LOTLSource</h4>
<div class="paragraph">
<p>Several TLSources and several LOTLSources can be injected in a <code>TLValidationJob</code>. The only constraint is the uniqueness of the Trusted List URLs.</p>
</div>
<div class="listingblock">
<div class="title">Multiple TLSources and multiple LOTLSources configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TLValidationJob validationJob = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();
<span style="color:#777">// Specify where the TL/LOTL is hosted and which are the signing certificate(s) for these TL/LOTL.</span>
validationJob.setTrustedListSources(boliviaTLSource(), costaRicaTLSource());
validationJob.setListOfTrustedListSources(europeanLOTLSource(), unitedStatesLOTLSource());</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_trusted_list_source_tlsource">11.1.1.1. Trusted List Source (TLSource)</h5>
<div class="paragraph">
<p>A <code>TLSource</code> allows quickly setting up a trusted list configuration. The URL and the signing certificates for this TL are mandatory. Optionally, predicates or/and filters can be configured to retrieve only a part of the trust service providers or trust services.</p>
</div>
<div class="listingblock">
<div class="title">TLSource configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TLSource tlSource = <span style="color:#080;font-weight:bold">new</span> TLSource();

<span style="color:#777">// Mandatory : The url where the TL needs to be downloaded</span>
tlSource.setUrl(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.ssi.gouv.fr/eidas/TL-FR.xml</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// A certificate source which contains the signing certificate(s) for the</span>
<span style="color:#777">// current trusted list</span>
tlSource.setCertificateSource(getSigningCertificatesForFrenchTL());

<span style="color:#777">// Optional : predicate to filter trust services which are/were granted or</span>
<span style="color:#777">// equivalent (pre/post eIDAS).</span>
<span style="color:#777">// Input : implementation of TrustServicePredicate interface.</span>
<span style="color:#777">// Default : none (select all)</span>
tlSource.setTrustServicePredicate(<span style="color:#080;font-weight:bold">new</span> GrantedTrustService());

<span style="color:#777">// Optional : predicate to filter the trust service providers</span>
<span style="color:#777">// Input : implementation of TrustServiceProviderPredicate interface.</span>
<span style="color:#777">// Default : none (select all)</span>
tlSource.setTrustServiceProviderPredicate(<span style="color:#080;font-weight:bold">new</span> CryptologOnlyTrustServiceProvider());

<span style="color:#777">//instance of CertificateSource where all trusted certificates and their properties (service type,...) are stored.</span>
tlValidationJob.setTrustedListSources(tlSource);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_list_of_trusted_lists_source_lotlsource">11.1.1.2. List Of Trusted Lists Source (LOTLSource)</h5>
<div class="paragraph">
<p>A similar configuration is possible for Lists Of Trusted Lists (LOTL) with a <code>LOTLSource</code>. That requires an URL and a list of potential LOTL signers. Some other parameters are also possible. By default, all listed trusted lists are loaded.</p>
</div>
<div class="listingblock">
<div class="title">LOTLSource configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">LOTLSource lotlSource = <span style="color:#080;font-weight:bold">new</span> LOTLSource();

<span style="color:#777">// Mandatory : The url where the LOTL needs to be downloaded</span>
lotlSource.setUrl(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://ec.europa.eu/tools/lotl/eu-lotl.xml</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// A certificate source which contains the signing certificate(s) for the</span>
<span style="color:#777">// current list of trusted lists</span>
lotlSource.setCertificateSource(getSigningCertificatesForEuropeanLOTL());

<span style="color:#777">// true or false for the pivot support. Default = false</span>
<span style="color:#777">// More information :</span>
<span style="color:#777">// https://ec.europa.eu/tools/lotl/pivot-lotl-explanation.html</span>
lotlSource.setPivotSupport(<span style="color:#069">true</span>);

<span style="color:#777">// Optional : the predicate which allows to find the LOTL definition in the LOTL</span>
<span style="color:#777">// Input : implementation of Predicate&lt;OtherTSLPointerType&gt; interface (e.g. OtherTSLPointerPredicate)</span>
<span style="color:#777">// Default : European configuration</span>
lotlSource.setLotlPredicate(<span style="color:#080;font-weight:bold">new</span> EULOTLOtherTSLPointer().and(<span style="color:#080;font-weight:bold">new</span> XMLOtherTSLPointer()));

<span style="color:#777">// Optional : the predicate which allows to find and/or filter the TL</span>
<span style="color:#777">// definitions in the LOTL</span>
<span style="color:#777">// Input : implementation of Predicate&lt;OtherTSLPointerType&gt; interface (e.g. OtherTSLPointerPredicate)</span>
<span style="color:#777">// Default : all found trusted lists in the European LOTL</span>
lotlSource.setTlPredicate(<span style="color:#080;font-weight:bold">new</span> EUTLOtherTSLPointer().and(<span style="color:#080;font-weight:bold">new</span> XMLOtherTSLPointer()));

<span style="color:#777">// Optional : a predicate which allows to find back the signing certificates for</span>
<span style="color:#777">// the current LOTL</span>
<span style="color:#777">// Input : implementation of LOTLSigningCertificatesAnnouncementSchemeInformationURI interface.</span>
<span style="color:#777">// Default : not defined</span>
<span style="color:#777">//</span>
<span style="color:#777">// OfficialJournalSchemeInformationURI allows to specify the Official Journal</span>
<span style="color:#777">// URL where the signing certificates are published</span>
lotlSource.setSigningCertificatesAnnouncementPredicate(
                <span style="color:#080;font-weight:bold">new</span> OfficialJournalSchemeInformationURI(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.C_.2019.276.01.0001.01.ENG</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// Optional : predicate to filter trust services which are/were granted or</span>
<span style="color:#777">// equivalent (pre/post eIDAS). This parameter is applied on the related trusted</span>
<span style="color:#777">// lists</span>
<span style="color:#777">// Input : implementation of TrustServicePredicate interface.</span>
<span style="color:#777">// Default : none (select all)</span>
lotlSource.setTrustServicePredicate(<span style="color:#080;font-weight:bold">new</span> GrantedTrustService());

<span style="color:#777">// Optional : predicate to filter the trust service providers. This parameter is</span>
<span style="color:#777">// applied on the related trusted lists</span>
<span style="color:#777">// Input : implementation of TrustServiceProviderPredicate interface.</span>
<span style="color:#777">// Default : none (select all)</span>
lotlSource.setTrustServiceProviderPredicate(<span style="color:#080;font-weight:bold">new</span> CryptologOnlyTrustServiceProvider());

tlValidationJob.setListOfTrustedListSources(lotlSource);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="DSSFileLoader">11.1.2. DSSFileLoader</h4>
<div class="paragraph">
<p>The <code>FileCacheDataLoader</code> is used to download the trusted list contents on the file-system. Two different configurations are needed. Both of them share the same folder :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>offline refresh</strong> : disabled download from Internet and unlimited cache expiration</p>
</li>
<li>
<p><strong>online refresh</strong> : enabled download from Internet and limited cache expiration</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Offline and Online refresh configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> DSSFileLoader offlineLoader() {
        FileCacheDataLoader offlineFileLoader = <span style="color:#080;font-weight:bold">new</span> FileCacheDataLoader();
        offlineFileLoader.setCacheExpirationTime(-<span style="color:#00D">1</span>); <span style="color:#777">// negative value means cache never expires</span>
        offlineFileLoader.setDataLoader(<span style="color:#080;font-weight:bold">new</span> IgnoreDataLoader()); <span style="color:#777">// do not download from Internet</span>
        offlineFileLoader.setFileCacheDirectory(tlCacheDirectory());
        <span style="color:#080;font-weight:bold">return</span> offlineFileLoader;
}

<span style="color:#088;font-weight:bold">public</span> DSSFileLoader onlineLoader() {
        FileCacheDataLoader onlineFileLoader = <span style="color:#080;font-weight:bold">new</span> FileCacheDataLoader();
        onlineFileLoader.setCacheExpirationTime(<span style="color:#00D">0</span>);
        onlineFileLoader.setDataLoader(dataLoader()); <span style="color:#777">// instance of DataLoader which can access to Internet (proxy,...)</span>
        onlineFileLoader.setFileCacheDirectory(tlCacheDirectory());
        <span style="color:#080;font-weight:bold">return</span> onlineFileLoader;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_synchronizationstrategy">11.1.3. The SynchronizationStrategy</h4>
<div class="paragraph">
<p>The <code>SynchronizationStrategy</code> defines which are the trusted lists or list of trusted lists to be synchronized. By default, DSS synchronizes all of them. By default, DSS does not reject any trusted lists (e.g. expired, invalid,  etc.). The content is trusted and a warning is added in a signature / certificate validation.</p>
</div>
<div class="paragraph">
<p>DSS provides two implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ExpirationAndSignatureCheckStrategy</code> - rejects Trusted Lists with invalid signature or expired. The certificates from a such Trusted List are not loaded to the <code>TrustedListsCertificateSource</code>.</p>
</li>
<li>
<p><code>AcceptAllStrategy</code> (default) - accepts all Trusted List, whatever the validation status is.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default behaviour is configurable via a strategy with the interface <code>SynchronizationStrategy</code> :</p>
</div>
<div class="listingblock">
<div class="title">Example of a custom  SynchronizationStrategy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> SynchronizationStrategy allValidTrustedListsStrategy() {
        
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> SynchronizationStrategy() {

                <span style="color:#007">@Override</span>
                <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> canBeSynchronized(TLInfo trustedList) {
                        <span style="color:#080;font-weight:bold">return</span> trustedList.getValidationCacheInfo().isValid();
                }

                <span style="color:#007">@Override</span>
                <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> canBeSynchronized(LOTLInfo listOfTrustedList) {
                        <span style="color:#080;font-weight:bold">return</span> listOfTrustedList.getValidationCacheInfo().isValid();
                }
                
        };

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_cachecleaner">11.1.4. The CacheCleaner</h4>
<div class="paragraph">
<p>The <code>CacheCleaner</code> specifies how DSS clears the cache (e.g. in case of expired URL, etc.). Two cleaning options are available : memory and file-system.</p>
</div>
<div class="listingblock">
<div class="title">CacheCleaner Configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> CacheCleaner cacheCleaner() {
        CacheCleaner cacheCleaner = <span style="color:#080;font-weight:bold">new</span> CacheCleaner();

        cacheCleaner.setCleanMemory(<span style="color:#069">true</span>); <span style="color:#777">// free the space in memory</span>

        cacheCleaner.setCleanFileSystem(<span style="color:#069">true</span>); <span style="color:#777">// remove the stored file(s) on the file-system</span>

        <span style="color:#777">// if the file-system cleaner is enabled, inject the configured loader from the</span>
        <span style="color:#777">// online or offline refresh data loader.</span>
        cacheCleaner.setDSSFileLoader(offlineLoader());

        <span style="color:#080;font-weight:bold">return</span> cacheCleaner;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="AlertingTL">11.1.5. Alerting from TL Loading</h4>
<div class="paragraph">
<p>DSS allows running of custom alerts in some situations (e.g.: invalid TL signature, LOTL location change, etc.). Alert works with two concepts: detection and alert handler. After the download/parsing/validation and before the synchronization, the results are tested to detect events and launch alert(s).</p>
</div>
<div class="listingblock">
<div class="title">Examples of Alerting</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TLValidationJob job = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();
<span style="color:#777">// ...</span>

<span style="color:#777">// Add a log message in case of invalid signatures</span>
TLAlert tlBrokenSignatureAlert = <span style="color:#080;font-weight:bold">new</span> TLAlert(<span style="color:#080;font-weight:bold">new</span> TLSignatureErrorDetection(), <span style="color:#080;font-weight:bold">new</span> LogTLSignatureErrorAlertHandler());

<span style="color:#777">// Send an email in case of new Official Journal detected</span>
AlertHandler&lt;LOTLInfo&gt; mailSender = <span style="color:#080;font-weight:bold">new</span> AlertHandler&lt;LOTLInfo&gt;() {

        <span style="color:#007">@Override</span>
        <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> process(LOTLInfo currentInfo) {
                <span style="color:#0a8;font-weight:bold">String</span> newOJUrl = currentInfo.getParsingCacheInfo().getSigningCertificateAnnouncementUrl();
                <span style="color:#777">// code to send an email</span>
                SampleUtils.sendEmail(newOJUrl);
        }
        
};

<span style="color:#777">// The europeanLOTLSource is configured with an</span>
<span style="color:#777">// OfficialJournalSchemeInformationURI</span>
LOTLAlert officialJournalDesynchronizationAlert = <span style="color:#080;font-weight:bold">new</span> LOTLAlert(<span style="color:#080;font-weight:bold">new</span> OJUrlChangeDetection(europeanLOTLSource()), mailSender);

<span style="color:#777">// Update a database in case of LOTL location change</span>
AlertHandler&lt;LOTLInfo&gt; databaseUpgrader = <span style="color:#080;font-weight:bold">new</span> AlertHandler&lt;LOTLInfo&gt;() {

        <span style="color:#007">@Override</span>
        <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> process(LOTLInfo currentInfo) {
                <span style="color:#0a8;font-weight:bold">String</span> newLOTLUrl = <span style="color:#069">null</span>;

                <span style="color:#0a8;font-weight:bold">String</span> currentLOTLUrl = currentInfo.getUrl();
                <span style="color:#0a8;font-weight:bold">List</span>&lt;PivotInfo&gt; pivots = currentInfo.getPivotInfos();
                <span style="color:#080;font-weight:bold">for</span> (PivotInfo pivot : pivots) {
                        <span style="color:#080;font-weight:bold">if</span> (!Utils.areStringsEqual(currentLOTLUrl, pivot.getLOTLLocation())) {
                                newLOTLUrl = pivot.getLOTLLocation();
                                <span style="color:#080;font-weight:bold">break</span>;
                        }
                }

                <span style="color:#777">// code to update a database</span>
                SampleUtils.updateDatabase(newLOTLUrl);
        }

};
LOTLAlert lotlLocationChangeAlert = <span style="color:#080;font-weight:bold">new</span> LOTLAlert(<span style="color:#080;font-weight:bold">new</span> LOTLLocationChangeDetection(europeanLOTLSource()), databaseUpgrader);

<span style="color:#777">// add all alerts on the job</span>
job.setLOTLAlerts(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(officialJournalDesynchronizationAlert, lotlLocationChangeAlert));
job.setTLAlerts(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(tlBrokenSignatureAlert));</code></pre>
</div>
</div>
<div class="paragraph">
<p>See section <a href="#Alerts">Use of Alerts throughout the framework</a> in the Annex for more information on related alerts.</p>
</div>
</div>
<div class="sect3">
<h4 id="_lotltl_filter_predicates">11.1.6. LOTL/TL filter predicates</h4>
<div class="paragraph">
<p>TSL predicates provide an option to filter the extracted TSL Pointers from LOTL or TL sources, allowing a customization of a trusted certificates and trusted services loading.</p>
</div>
<div class="paragraph">
<p>The following predicates are provided within the framework:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EULOTLOtherTSLPointer</code> - filters the EU LOTL pointer;</p>
</li>
<li>
<p><code>EUTLOtherTSLPointer</code> - filters the EU TL pointers;</p>
</li>
<li>
<p><code>MimetypeOtherTSLPointer</code> - filters TL pointers by a MimeType (e.g. XML only);</p>
</li>
<li>
<p><code>XMLOtherTSLPointer</code> - filters XML TL pointers;</p>
</li>
<li>
<p><code>PDFOtherTSLPointer</code> - filters PDF TL pointers;</p>
</li>
<li>
<p><code>SchemeTerritoryOtherTSLPointer</code> - filters TL pointers with a specific scheme territory (i.e. filter by country).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Examples of TSL Loading Predicates configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// the predicates filter TSL pointers to XML documents with</span>
<span style="color:#777">// &quot;http://uri.etsi.org/TrstSvc/TrustedList/TSLType/EUlistofthelists&quot; type</span>
lotlSource.setLotlPredicate(<span style="color:#080;font-weight:bold">new</span> EULOTLOtherTSLPointer().and(<span style="color:#080;font-weight:bold">new</span> XMLOtherTSLPointer()));

<span style="color:#777">// the predicates filter only TSL pointers with scheme territories &quot;DE&quot; (Germany) and &quot;RO&quot; (Romania)</span>
<span style="color:#777">// to XML documents with &quot;http://uri.etsi.org/TrstSvc/TrustedList/TSLType/EUgeneric&quot; type</span>
lotlSource.setTlPredicate(<span style="color:#080;font-weight:bold">new</span> SchemeTerritoryOtherTSLPointer(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DE</span><span style="color:#710">&quot;</span></span>,<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">RO</span><span style="color:#710">&quot;</span></span>))
                .and(<span style="color:#080;font-weight:bold">new</span> EULOTLOtherTSLPointer()).and(<span style="color:#080;font-weight:bold">new</span> XMLOtherTSLPointer()));</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_executor_service">11.1.7. Executor Service</h4>
<div class="paragraph">
<p>An Executor Service parameter allows you to customize a way of the program execution on your Java machine, by configuring a number of possible threads to be running, await time and so on.</p>
</div>
<div class="listingblock">
<div class="title">Executor Service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Allows configuration of the execution process</span>
<span style="color:#777">// Default : Executors.newCachedThreadPool() is used</span>
tlValidationJob.setExecutorService(<span style="color:#0a8;font-weight:bold">Executors</span>.newSingleThreadExecutor());</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_complete_configuration_for_the_european_lotl">11.1.8. Complete configuration for the European LOTL</h4>
<div class="paragraph">
<p>Below, you can find a complete configuration for the European List Of Trusted Lists. The URLs need to be externalized.</p>
</div>
<div class="listingblock">
<div class="title">European LOTL Configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">        <span style="color:#777">// Should be externalized</span>
        <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> LOTL_URL = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://ec.europa.eu/tools/lotl/eu-lotl.xml</span><span style="color:#710">&quot;</span></span>;
        <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> OJ_URL = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv:OJ.C_.2019.276.01.0001.01.ENG</span><span style="color:#710">&quot;</span></span>;
        
        <span style="color:#007">@Test</span>
        <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> test() {
                CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
                TLValidationJob job = job();
                TrustedListsCertificateSource trustedListsCertificateSource = <span style="color:#080;font-weight:bold">new</span> TrustedListsCertificateSource();
                job.setTrustedListCertificateSource(trustedListsCertificateSource);
                job.onlineRefresh();
                commonCertificateVerifier.setTrustedCertSources(trustedListsCertificateSource);
                commonCertificateVerifier.setCrlSource(<span style="color:#080;font-weight:bold">new</span> OnlineCRLSource());
                commonCertificateVerifier.setOcspSource(<span style="color:#080;font-weight:bold">new</span> OnlineOCSPSource());
                commonCertificateVerifier.setAIASource(<span style="color:#080;font-weight:bold">new</span> DefaultAIASource());
                
                SignedDocumentValidator validator = SignedDocumentValidator.fromDocument(
                                <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/test/resources/signature-pool/signedXmlXadesB.xml</span><span style="color:#710">&quot;</span></span>));
                validator.setCertificateVerifier(commonCertificateVerifier);
                
                validator.validateDocument();
        }
        
        <span style="color:#088;font-weight:bold">public</span> TLValidationJob job() {
                TLValidationJob job = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();
                job.setOfflineDataLoader(offlineLoader());
                job.setOnlineDataLoader(onlineLoader());
                job.setTrustedListCertificateSource(trustedCertificateSource());
                job.setSynchronizationStrategy(<span style="color:#080;font-weight:bold">new</span> AcceptAllStrategy());
                job.setCacheCleaner(cacheCleaner());

                LOTLSource europeanLOTL = europeanLOTL();
                job.setListOfTrustedListSources(europeanLOTL);

                job.setLOTLAlerts(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(ojUrlAlert(europeanLOTL), lotlLocationAlert(europeanLOTL)));
                job.setTLAlerts(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(tlSigningAlert(), tlExpirationDetection()));

                <span style="color:#080;font-weight:bold">return</span> job;
        }

        <span style="color:#088;font-weight:bold">public</span> TrustedListsCertificateSource trustedCertificateSource() {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TrustedListsCertificateSource();
        }

        <span style="color:#088;font-weight:bold">public</span> LOTLSource europeanLOTL() {
                LOTLSource lotlSource = <span style="color:#080;font-weight:bold">new</span> LOTLSource();
                lotlSource.setUrl(LOTL_URL);
<span style="color:#777">//                lotlSource.setCertificateSource(officialJournalContentKeyStore());</span>
                lotlSource.setCertificateSource(<span style="color:#080;font-weight:bold">new</span> CommonCertificateSource());
                lotlSource.setSigningCertificatesAnnouncementPredicate(<span style="color:#080;font-weight:bold">new</span> OfficialJournalSchemeInformationURI(OJ_URL));
                lotlSource.setPivotSupport(<span style="color:#069">true</span>);
                <span style="color:#080;font-weight:bold">return</span> lotlSource;
        }

        <span style="color:#088;font-weight:bold">public</span> CertificateSource officialJournalContentKeyStore() {
                <span style="color:#080;font-weight:bold">try</span> {
                        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> KeyStoreCertificateSource(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/keystore.p12</span><span style="color:#710">&quot;</span></span>), <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">PKCS12</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dss-password</span><span style="color:#710">&quot;</span></span>);
                } <span style="color:#080;font-weight:bold">catch</span> (<span style="color:#C00;font-weight:bold">IOException</span> e) {
                        <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> DSSException(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Unable to load the keystore</span><span style="color:#710">&quot;</span></span>, e);
                }
        }

        <span style="color:#088;font-weight:bold">public</span> DSSFileLoader offlineLoader() {
                FileCacheDataLoader offlineFileLoader = <span style="color:#080;font-weight:bold">new</span> FileCacheDataLoader();
                offlineFileLoader.setCacheExpirationTime(<span style="color:#0a8;font-weight:bold">Long</span>.MAX_VALUE);
                offlineFileLoader.setDataLoader(<span style="color:#080;font-weight:bold">new</span> IgnoreDataLoader());
                offlineFileLoader.setFileCacheDirectory(tlCacheDirectory());
                <span style="color:#080;font-weight:bold">return</span> offlineFileLoader;
        }

        <span style="color:#088;font-weight:bold">public</span> DSSFileLoader onlineLoader() {
                FileCacheDataLoader onlineFileLoader = <span style="color:#080;font-weight:bold">new</span> FileCacheDataLoader();
                onlineFileLoader.setCacheExpirationTime(<span style="color:#00D">0</span>);
                onlineFileLoader.setDataLoader(dataLoader());
                onlineFileLoader.setFileCacheDirectory(tlCacheDirectory());
                <span style="color:#080;font-weight:bold">return</span> onlineFileLoader;
        }

        <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">File</span> tlCacheDirectory() {
                <span style="color:#0a8;font-weight:bold">File</span> rootFolder = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="color:#0a8;font-weight:bold">System</span>.getProperty(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.io.tmpdir</span><span style="color:#710">&quot;</span></span>));
                <span style="color:#0a8;font-weight:bold">File</span> tslCache = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(rootFolder, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dss-tsl-loader</span><span style="color:#710">&quot;</span></span>);
                <span style="color:#080;font-weight:bold">if</span> (tslCache.mkdirs()) {
                        LOG.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">TL Cache folder : {}</span><span style="color:#710">&quot;</span></span>, tslCache.getAbsolutePath());
                }
                <span style="color:#080;font-weight:bold">return</span> tslCache;
        }

        <span style="color:#088;font-weight:bold">public</span> CommonsDataLoader dataLoader() {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> CommonsDataLoader();
        }

        <span style="color:#088;font-weight:bold">public</span> CacheCleaner cacheCleaner() {
                CacheCleaner cacheCleaner = <span style="color:#080;font-weight:bold">new</span> CacheCleaner();
                cacheCleaner.setCleanMemory(<span style="color:#069">true</span>);
                cacheCleaner.setCleanFileSystem(<span style="color:#069">true</span>);
                cacheCleaner.setDSSFileLoader(offlineLoader());
                <span style="color:#080;font-weight:bold">return</span> cacheCleaner;
        }

        <span style="color:#777">// Optionally : alerting.</span>
        <span style="color:#777">// Recommended detections : OJUrlChangeDetection + LOTLLocationChangeDetection</span>

        <span style="color:#088;font-weight:bold">public</span> TLAlert tlSigningAlert() {
                TLSignatureErrorDetection signingDetection = <span style="color:#080;font-weight:bold">new</span> TLSignatureErrorDetection();
                LogTLSignatureErrorAlertHandler handler = <span style="color:#080;font-weight:bold">new</span> LogTLSignatureErrorAlertHandler();
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TLAlert(signingDetection, handler);
        }

        <span style="color:#088;font-weight:bold">public</span> TLAlert tlExpirationDetection() {
                TLExpirationDetection expirationDetection = <span style="color:#080;font-weight:bold">new</span> TLExpirationDetection();
                LogTLExpirationAlertHandler handler = <span style="color:#080;font-weight:bold">new</span> LogTLExpirationAlertHandler();
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TLAlert(expirationDetection, handler);
        }

        <span style="color:#088;font-weight:bold">public</span> LOTLAlert ojUrlAlert(LOTLSource source) {
                OJUrlChangeDetection ojUrlDetection = <span style="color:#080;font-weight:bold">new</span> OJUrlChangeDetection(source);
                LogOJUrlChangeAlertHandler handler = <span style="color:#080;font-weight:bold">new</span> LogOJUrlChangeAlertHandler();
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> LOTLAlert(ojUrlDetection, handler);
        }

        <span style="color:#088;font-weight:bold">public</span> LOTLAlert lotlLocationAlert(LOTLSource source) {
                LOTLLocationChangeDetection lotlLocationDetection = <span style="color:#080;font-weight:bold">new</span> LOTLLocationChangeDetection(source);
                LogLOTLLocationChangeAlertHandler handler = <span style="color:#080;font-weight:bold">new</span> LogLOTLLocationChangeAlertHandler();
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> LOTLAlert(lotlLocationDetection, handler);
        }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_the_tl_lotl_refresh">11.1.9. The TL / LOTL refresh</h4>
<div class="paragraph">
<p>The TL / LOTL loading in DSS works as below :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download / parse / validate all LOTLSources from the configuration with/without pivot support (multi-threaded);</p>
</li>
<li>
<p>Analyze introduced changes and expired cache entries (new TL URLs, new signing certificates for a TL,&#8230;&#8203;);</p>
</li>
<li>
<p>Create TLSources from the retrieved LOTLs;</p>
</li>
<li>
<p>Combine these TLSources with independent TLSources (from the configuration);</p>
</li>
<li>
<p>Download / parse / validate all TLs (multi-threaded);</p>
</li>
<li>
<p>If alerts are configured, test if an alert needs to be launched;</p>
</li>
<li>
<p>If the debug is enabled, print in the log the cache status;</p>
</li>
<li>
<p>Synchronize the <code>TrustedListCertificateSource</code>;</p>
</li>
<li>
<p>If the cache cleaner is configured, execute it;</p>
</li>
<li>
<p>If the debug is enabled, print in the log the cache status.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The refresh can be called with the offline or the online loader and run exactly the same code</p>
</div>
<div class="listingblock">
<div class="title">How to refresh the Trusted List(s) and Lists of Trusted Lists</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TLValidationJob validationJob = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();

<span style="color:#777">// call with the Offline Loader (application initialization)</span>
validationJob.offlineRefresh();

<span style="color:#777">// call with the Online Loader (callable every day/hour in a cron)</span>
validationJob.onlineRefresh();</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="KeyStore">11.1.9.1. Java Keystore Management</h5>
<div class="paragraph">
<p>Generally (like in case of European LOTL) DSS downloads Trusted Lists by using the SSL protocol (for resources using HTTPS extension), that requires to have a certificate of a remote source in the Java trust store. The certificates have their own validity period and can expire. If a certificate is expired, it will be replaced on a server by a new one in order to support a secure SSL connection. The easiest way to know if your Java trust store is outdated and new certificates need to be added is to check your logs during a <code>TLValidationJob</code> update :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>ERROR 14052 --- [pool-2-thread-30] e.e.e.dss.tsl.runnable.AbstractAnalysis  : Unable to process GET call for url [https://sr.riik.ee/tsl/estonian-tsl.xml]. Reason : [PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>SunCertPathBuilderException</code> means that the certificate establishing the secure connection is not trusted by your Java Virtual Machine. In order to add the certificate to the trust store, you need to do the following steps (the example is based on Windows OS and Google Chrome browser):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the failed URL in your browser. In our case it will be 'https://sr.riik.ee/tsl/estonian-tsl.xml' obtained from the logs.</p>
</li>
<li>
<p>Click on a lock icon next to the URL in the tab you just opened. It will open a window about the current connection status.</p>
</li>
<li>
<p>Click on 'Certificate' button to open the Certificate window.</p>
</li>
<li>
<p>Go to 'Details' tab and choose 'Copy to File&#8230;&#8203;'.</p>
</li>
<li>
<p>Process the 'Certificate Export Wizard', by saving the certificate in one of '.CER' formats. Store the file in your file system. For us it will create a file 'ee.cer'.</p>
</li>
<li>
<p>Run 'Command Prompt' with administrator permissions (right click &#8594; 'Run As Administrator').</p>
</li>
<li>
<p>Execute the following line (ensure that 'keytool' is installed) :</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="title">Certificate import</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">keytool -import -<span style="color:#080;font-weight:bold">alias</span> <span style="color:#06B;font-weight:bold">newCert</span> <span style="color:#06B;font-weight:bold">-</span>file pathToCert<span style="color:#F00;background-color:#FAA">\</span>ee.cer -keystore pathToJavaDirectory<span style="color:#F00;background-color:#FAA">\</span>lib<span style="color:#F00;background-color:#FAA">\</span>security<span style="color:#F00;background-color:#FAA">\</span>cacerts -storepass changeit</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default password for a Java keystore is <code>changeit</code>. Ensure that you have a default configuration, or use another password you have configured.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In order to apply changes, the application using Java must be rebooted.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After these steps the <code>TLValidationJob</code> will successfully download the target Trusted List (i.e. Estonian in our example).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This described algorithm is not only one available solution, if you have difficulties with this, you can search in the Internet for another working for you solution.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tlvalidationjobsummary">11.1.10. TLValidationJobSummary</h4>
<div class="paragraph">
<p>The class <code>TLValidationJobSummary</code> contains all processed data about the download (time, error,&#8230;&#8203;), the parsing (extracted information, parsing error,&#8230;&#8203;) and the signature validation (signing certificate, signing time,&#8230;&#8203;).</p>
</div>
<div class="listingblock">
<div class="title">How to retrieve the information about the TLValidationJob process</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">TrustedListsCertificateSource trustedListCertificateSource = <span style="color:#080;font-weight:bold">new</span> TrustedListsCertificateSource();

TLValidationJob job = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();
job.setTrustedListCertificateSource(trustedListCertificateSource);

<span style="color:#777">// ... config &amp; refresh ...</span>

<span style="color:#777">// A cache content summary can be computed on request</span>
TLValidationJobSummary summary = job.getSummary();

<span style="color:#777">// All information about processed LOTLSources</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;LOTLInfo&gt; lotlInfos = summary.getLOTLInfos();
LOTLInfo lotlInfo = lotlInfos.get(<span style="color:#00D">0</span>);
<span style="color:#777">// All data about the download (last occurrence, cache status, error,...)</span>
DownloadInfoRecord downloadCacheInfo = lotlInfo.getDownloadCacheInfo();

<span style="color:#777">// All data about the parsing (date, extracted data, cache status,...)</span>
ParsingInfoRecord parsingCacheInfo = lotlInfo.getParsingCacheInfo();

<span style="color:#777">// All data about the signature validation (signing certificate, validation</span>
<span style="color:#777">// result, cache status,...)</span>
ValidationInfoRecord validationCacheInfo = lotlInfo.getValidationCacheInfo();

<span style="color:#777">// All information about processed TLSources (which are not linked to a</span>
<span style="color:#777">// LOTLSource)</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;TLInfo&gt; otherTLInfos = summary.getOtherTLInfos();

<span style="color:#777">// or the last update can be collected from the TrustedListsCertificateSource</span>
TLValidationJobSummary lastSynchronizedSummary = trustedListCertificateSource.getSummary();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_validation_policy_for_trusted_lists">11.2. Validation policy for trusted lists</h3>
<div class="paragraph">
<p>An eIDAS XML node linked to the status of the Trusted List is included in the DSS validation policy (see <a href="#validationPolicy">AdES validation constraints/policy</a> for more information). The following elements are contained in that node:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>TLFreshness</strong>: Given that TLs are too heavy to be downloaded at each validation, TLs are downloaded every few hours. However, it can happen that a download is not possible because the TL is not available or because there is a problem with the downloader on the signature validation algorithm side. For such situations, it is useful to display a message to indicate that the TL is not “fresh”. To achieve this, the TL freshness indicates that TLs were downloaded no later than the validation time minus the TL freshness time interval.</p>
</li>
<li>
<p><strong>TLNotExpired</strong>: The TL might be expired in case of an attack consisting in replacing the current TL by an older one. Using an old TL might bring problems. The expired TL could for example contain Certificate Authorities that are not present in the current TL. Thus, an expired TL should lead to a warning during the validation.</p>
</li>
<li>
<p><strong>TLWellSigned</strong>: If the signature of the TL is not valid, the TL should be discarded. A non-valid TL signature might indicate that the content of that TL is "fake" and should not be trusted.</p>
</li>
<li>
<p><strong>TLVersion</strong>: If the version of the trusted list does not correspond to the version indicated in the validation policy, the validation process fails.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_using_non_eu_trusted_lists">11.3. Using non-EU trusted lists</h3>
<div class="paragraph">
<p>Non-EU trusted lists are supported by DSS. However, there are a few constraints</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Non-EU trusted lists shall have the same XML structure as EU TLs, i.e. they shall be compliant with the XSD schema.</p>
</li>
<li>
<p>There is no guarantee for a proper qualification determination as the non-EU TL shall also be compliant with EU regulations.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Even though the ETSI TS 119 615 standard (<a href="#R14">[R14]</a>) is EU-specific, the diagnostic data contains the necessary information for implementers to implement non-EU ETSI TS 119 615 status determination.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_signing_a_trusted_list">11.4. Signing a trusted list</h3>
<div class="paragraph">
<p>The standard ETSI TS 119 612 (cf. <a href="#R11">[R11]</a>) specifies in its annex B the XML structure and the format of the signature (XAdES, enveloped signature, transformation, canonicalization, etc.). With the class <code>TrustedListSignatureParametersBuilder</code>, DSS is able to pre-configure the signature parameters to comply with the specifications and simplify the signature creation.</p>
</div>
<div class="listingblock">
<div class="title">Sign a Trusted List with the TrustedListSignatureParametersBuilder</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DSSDocument trustedList = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/trusted-list.xml</span><span style="color:#710">&quot;</span></span>);

DSSPrivateKeyEntry privateKeyEntry = signingToken.getKeys().get(<span style="color:#00D">0</span>);
CertificateToken signingCertificate = privateKeyEntry.getCertificate();

<span style="color:#777">// This class creates the appropriated XAdESSignatureParameters object to sign a trusted list.</span>
<span style="color:#777">// It handles the configuration complexity and creates a ready-to-be-used XAdESSignatureParameters with a correct configuration.</span>
TrustedListSignatureParametersBuilder builder = <span style="color:#080;font-weight:bold">new</span> TrustedListSignatureParametersBuilder(signingCertificate, trustedList);
XAdESSignatureParameters parameters = builder.build();

XAdESService service = <span style="color:#080;font-weight:bold">new</span> XAdESService(<span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier());

ToBeSigned dataToSign = service.getDataToSign(trustedList, parameters);
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKeyEntry);
DSSDocument signedTrustedList = service.signDocument(trustedList, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_eidas">12. eIDAS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_of_certificates">12.1. Overview of certificates</h3>
<div class="sect3">
<h4 id="_type_of_certificate">12.1.1. Type of certificate</h4>
<div class="paragraph">
<p>A certificate can be for electronic signature, for electronic seal or for website authentication.</p>
</div>
</div>
<div class="sect3">
<h4 id="_qualified_status_of_certificate">12.1.2. Qualified status of certificate</h4>
<div class="paragraph">
<p>Explanations as well as an example on the determination of the qualified status of a certificate are presented in section <a href="#CertificateValidation">Validation of a certificate</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_certificate_type_and_qualification_are_represented_in_dss">12.2. How certificate type and qualification are represented in DSS</h3>
<div class="sect3">
<h4 id="CertificateQualificationDetermination">12.2.1. Certificate Qualification determination</h4>
<div class="paragraph">
<p>In order to determine a type and qualification of certificate, the <code>CertificateVerifier</code> can be used, provided the relevant information extracted from a Trusted List(s).</p>
</div>
<div class="paragraph">
<p>An example of a qualification data extraction for a certificate, can be found below:</p>
</div>
<div class="listingblock">
<div class="title">Certificate qualification validation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Configure the internet access</span>
CommonsDataLoader dataLoader = <span style="color:#080;font-weight:bold">new</span> CommonsDataLoader();

<span style="color:#777">// We set an instance of TrustAllStrategy to rely on the Trusted Lists content</span>
<span style="color:#777">// instead of the JVM trust store.</span>
dataLoader.setTrustStrategy(TrustAllStrategy.INSTANCE);

<span style="color:#777">// Configure the TLValidationJob to load a qualification information from the corresponding LOTL/TL</span>
TLValidationJob tlValidationJob = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();
tlValidationJob.setOnlineDataLoader(<span style="color:#080;font-weight:bold">new</span> FileCacheDataLoader(dataLoader));

<span style="color:#777">// Configure the relevant TrustedList</span>
TLSource tlSource = <span style="color:#080;font-weight:bold">new</span> TLSource();
tlSource.setUrl(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss-test.lu</span><span style="color:#710">&quot;</span></span>);
tlValidationJob.setTrustedListSources(tlSource);

<span style="color:#777">// Initialize the trusted list certificate source to fill with the information extracted from TLValidationJob</span>
TrustedListsCertificateSource trustedListsCertificateSource = <span style="color:#080;font-weight:bold">new</span> TrustedListsCertificateSource();
tlValidationJob.setTrustedListCertificateSource(trustedListsCertificateSource);

<span style="color:#777">// Update TLValidationJob</span>
tlValidationJob.onlineRefresh();

<span style="color:#777">// Thirdly, we need to configure the CertificateVerifier</span>
CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
cv.setTrustedCertSources(trustedListsCertificateSource); <span style="color:#777">// configured trusted list certificate source</span>
cv.setAIASource(aiaSource); <span style="color:#777">// configured AIA Access</span>
cv.setOcspSource(ocspSource); <span style="color:#777">// configured OCSP Access</span>
cv.setCrlSource(crlSource); <span style="color:#777">// configured CRL Access</span>

<span style="color:#777">// Create an instance of CertificateValidator for the SSL Certificate with the</span>
<span style="color:#777">// CertificateVerifier</span>
CertificateValidator validator = CertificateValidator.fromCertificate(certificate);
validator.setCertificateVerifier(cv);

<span style="color:#777">// Validate the certificate</span>
CertificateReports reports = validator.validate();
SimpleCertificateReport simpleReport = reports.getSimpleReport();

<span style="color:#777">// Extract the qualification information</span>
CertificateQualification qualificationAtCertificateIssuance = simpleReport.getQualificationAtCertificateIssuance();
CertificateQualification qualificationAtValidationTime = simpleReport.getQualificationAtValidationTime();

<span style="color:#777">// Extract the requested information about a certificate type and its qualification</span>
CertificateType type = qualificationAtValidationTime.getType();
<span style="color:#339;font-weight:bold">boolean</span> isQualifiedCertificate = qualificationAtValidationTime.isQc();
<span style="color:#339;font-weight:bold">boolean</span> isQSCD = qualificationAtValidationTime.isQscd();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_qualified_certificate_for_website_authentication_qwac">12.2.2. Qualified certificate for WebSite Authentication (QWAC)</h4>
<div class="paragraph">
<p>With DSS, it is possible to validate SSL certificate against the EUMS TL and the ETSI TS 119 615 (cf. <a href="#R14">[R14]</a>) to determine if it is a Qualified certificate for WebSite Authentication (QWAC).</p>
</div>
<div class="paragraph">
<p>DSS provides a special class <code>SSLCertificateLoader</code> allowing to extract the SSL certificate chain from the given URL. The qualification verification is similar to the example defined in chapter <a href="#CertificateQualificationDetermination">Certificate Qualification determination</a>.</p>
</div>
<div class="listingblock">
<div class="title">Validate an SSL certificate and retrieve its qualification level</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Secondly, we create an instance of SSLCertificateLoader which is responsible</span>
<span style="color:#777">// for the SSL certificate(s) downloading.</span>
SSLCertificateLoader sslCertificateLoader = <span style="color:#080;font-weight:bold">new</span> SSLCertificateLoader();
<span style="color:#777">// We set the configured dataLoader</span>
sslCertificateLoader.setCommonsDataLoader(dataLoader);

<span style="color:#777">// We retrieve the SSL certificates for the given URL</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;CertificateToken&gt; certificates = sslCertificateLoader.getCertificates(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://www.microsec.hu</span><span style="color:#710">&quot;</span></span>);

CertificateToken sslCertificate = certificates.get(<span style="color:#00D">0</span>);

<span style="color:#777">// Add intermediate certificates as non-trusted certificates (adjunct)</span>
CertificateSource adjunctCertSource = <span style="color:#080;font-weight:bold">new</span> CommonCertificateSource();
<span style="color:#080;font-weight:bold">for</span> (CertificateToken certificateToken : certificates) {
        adjunctCertSource.addCertificate(certificateToken);
}
cv.setAdjunctCertSources(adjunctCertSource);

<span style="color:#777">// Create an instance of CertificateValidator for the SSL Certificate with the</span>
<span style="color:#777">// CertificateVerifier</span>
CertificateValidator validator = CertificateValidator.fromCertificate(sslCertificate);
validator.setCertificateVerifier(cv);

CertificateReports reports = validator.validate();
SimpleCertificateReport simpleReport = reports.getSimpleReport();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overview_of_ades_signatures">12.3. Overview of AdES signatures</h3>
<div class="sect3">
<h4 id="_type_of_ades">12.3.1. Type of AdES</h4>
<div class="paragraph">
<p>Under eIDAS, there exist advanced electronic signatures and seals.</p>
</div>
</div>
<div class="sect3">
<h4 id="_qualified_status_of_ades_signature">12.3.2. Qualified status of AdES signature</h4>
<div class="paragraph">
<p>Below is an example of the validation and verification of the qualified status of an AdES signature:</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_signature_type_and_qualification_are_represented_in_dss">12.4. How signature type and qualification are represented in DSS</h3>
<div class="sect3">
<h4 id="SignatureQualificationDetermination">12.4.1. Signature Qualification determination</h4>
<div class="paragraph">
<p>In order to determine a type and qualification of a signature, an instance of <code>SignedDocumentValidator</code> can be used, provided the relevant information is extracted from a Trusted List(s).</p>
</div>
<div class="paragraph">
<p>An example of a qualification data extraction for a signature, can be found below:</p>
</div>
<div class="listingblock">
<div class="title">Signature qualification validation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Configure the internet access</span>
CommonsDataLoader dataLoader = <span style="color:#080;font-weight:bold">new</span> CommonsDataLoader();

<span style="color:#777">// We set an instance of TrustAllStrategy to rely on the Trusted Lists content</span>
<span style="color:#777">// instead of the JVM trust store.</span>
dataLoader.setTrustStrategy(TrustAllStrategy.INSTANCE);

<span style="color:#777">// Configure the TLValidationJob to load a qualification information from the corresponding LOTL/TL</span>
TLValidationJob tlValidationJob = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();
tlValidationJob.setOnlineDataLoader(<span style="color:#080;font-weight:bold">new</span> FileCacheDataLoader(dataLoader));

<span style="color:#777">// Configure the relevant TrustedList</span>
TLSource tlSource = <span style="color:#080;font-weight:bold">new</span> TLSource();
tlSource.setUrl(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss-test.lu</span><span style="color:#710">&quot;</span></span>);
tlValidationJob.setTrustedListSources(tlSource);

<span style="color:#777">// Initialize the trusted list certificate source to fill with the information extracted from TLValidationJob</span>
TrustedListsCertificateSource trustedListsCertificateSource = <span style="color:#080;font-weight:bold">new</span> TrustedListsCertificateSource();
tlValidationJob.setTrustedListCertificateSource(trustedListsCertificateSource);

<span style="color:#777">// Update TLValidationJob</span>
tlValidationJob.onlineRefresh();

<span style="color:#777">// No we need to configure the DocumentValidator</span>
CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
cv.setTrustedCertSources(trustedListsCertificateSource); <span style="color:#777">// configured trusted list certificate source</span>
cv.setAIASource(aiaSource); <span style="color:#777">// configured AIA Access</span>
cv.setOcspSource(ocspSource); <span style="color:#777">// configured OCSP Access</span>
cv.setCrlSource(crlSource); <span style="color:#777">// configured CRL Access</span>

<span style="color:#777">// Create an instance of SignedDocumentValidator</span>
DocumentValidator validator = SignedDocumentValidator.fromDocument(signedDocument);
validator.setCertificateVerifier(cv);

<span style="color:#777">// Validate the signature</span>
Reports reports = validator.validateDocument();
SimpleReport simpleReport = reports.getSimpleReport();

<span style="color:#777">// Extract the qualification information</span>
SignatureQualification signatureQualification = simpleReport.getSignatureQualification(simpleReport.getFirstSignatureId());</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_verifying_the_qualified_status_of_timestamp">12.5. Verifying the qualified status of timestamp</h3>
<div class="paragraph">
<p>ETSI TS 119 615 (<a href="#R14">[R14]</a>) specifies standardized procedures for the determination of the qualification of a timestamp.
DSS is able to determine a qualification level of a timestamp if a relative information about TrustServiceProviders is provided to a certificate verifier (loaded automatically to a trusted certificate source with <a href="#tlValidationJob">Configuration of TL validation job</a>).</p>
</div>
<div class="paragraph">
<p>Three qualification levels are supported by DSS and can be obtained :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>QTSA</code> (issued from a granted trust service with TSA/QTST type at the timestamp production time);</p>
</li>
<li>
<p><code>TSA</code> any other from a known trust anchor;</p>
</li>
<li>
<p><code>N/A</code> for others.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to determine a type and qualification of signature, an instance of <code>DetachedTimestampValidator</code> can be used for a detached CMS time-stamp verification, provided the relevant information extracted from a Trusted List(s).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For standalone time-stamps within different containers (e.g. PDF or ASiC) a corresponding instance of a <code>TimestampValidator</code> shall be used.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example verifies the qualification level of a timestamp:</p>
</div>
<div class="listingblock">
<div class="title">Validate a timestamp and retrieve its qualification level</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Configure the internet access</span>
CommonsDataLoader dataLoader = <span style="color:#080;font-weight:bold">new</span> CommonsDataLoader();

<span style="color:#777">// We set an instance of TrustAllStrategy to rely on the Trusted Lists content</span>
<span style="color:#777">// instead of the JVM trust store.</span>
dataLoader.setTrustStrategy(TrustAllStrategy.INSTANCE);

<span style="color:#777">// Configure the TLValidationJob to load a qualification information from the corresponding LOTL/TL</span>
TLValidationJob tlValidationJob = <span style="color:#080;font-weight:bold">new</span> TLValidationJob();
tlValidationJob.setOnlineDataLoader(<span style="color:#080;font-weight:bold">new</span> FileCacheDataLoader(dataLoader));

<span style="color:#777">// Configure the relevant TrustedList</span>
TLSource tlSource = <span style="color:#080;font-weight:bold">new</span> TLSource();
tlSource.setUrl(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://dss-test.lu</span><span style="color:#710">&quot;</span></span>);
tlValidationJob.setTrustedListSources(tlSource);

<span style="color:#777">// Initialize the trusted list certificate source to fill with the information extracted from TLValidationJob</span>
TrustedListsCertificateSource trustedListsCertificateSource = <span style="color:#080;font-weight:bold">new</span> TrustedListsCertificateSource();
tlValidationJob.setTrustedListCertificateSource(trustedListsCertificateSource);

<span style="color:#777">// Update TLValidationJob</span>
tlValidationJob.onlineRefresh();

<span style="color:#777">// No we need to configure the DocumentValidator</span>
CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
cv.setTrustedCertSources(trustedListsCertificateSource); <span style="color:#777">// configured trusted list certificate source</span>
cv.setAIASource(aiaSource); <span style="color:#777">// configured AIA Access</span>
cv.setOcspSource(ocspSource); <span style="color:#777">// configured OCSP Access</span>
cv.setCrlSource(crlSource); <span style="color:#777">// configured CRL Access</span>

<span style="color:#777">// Create an instance of DetachedTimestampValidator</span>
DocumentValidator validator = <span style="color:#080;font-weight:bold">new</span> DetachedTimestampValidator(timeStampDocument);
validator.setCertificateVerifier(cv);

<span style="color:#777">// Validate the time-stamp</span>
Reports reports = validator.validateDocument();
SimpleReport simpleReport = reports.getSimpleReport();

<span style="color:#777">// Extract the qualification information</span>
TimestampQualification timestampQualification = simpleReport.getTimestampQualification(simpleReport.getFirstTimestampId());</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_webservices_2">13. Webservices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DSS offers REST and SOAP web services.</p>
</div>
<div class="paragraph">
<p>The different webservices are :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Signature webservices</strong> (<code>dss-signature-soap</code> / <code>dss-signature-rest</code>) and their clients: expose methods to allow signing and augmenting or counter-signing a signature from a client.</p>
</li>
<li>
<p><strong>Server-signing webservice</strong> (<code>dss-server-signing-soap</code> / <code>dss-server-signing-rest</code>) and their clients: expose methods to retrieve keys from a server (PKCS#11, PKCS#12, HSM,&#8230;&#8203;) and to sign the digest on the server side.</p>
</li>
<li>
<p><strong>Signature validation webservices</strong> (<code>dss-validation-soap</code> / <code>dss-validation-rest</code>) and their clients: expose methods to allow signature validation, with an optional detached file and an optional validation policy.</p>
</li>
<li>
<p><strong>Certificate validation webservices</strong> (<code>dss-certificate-validation-soap</code> / <code>dss-certificate-validation-rest</code>) and their clients: expose methods to allow certificate validation, with an optional provided certificate chain and custom validation time.</p>
</li>
<li>
<p><strong>Timestamp webservices</strong> (<code>dss-timestamp-remote-soap</code> / <code>dss-timestamp-remote-rest</code>) and their clients: expose methods to allow remote timestamp creation, by providing digest value to be timestamped and a digest algorithm, used for the digest calculation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The data structure in webservices is similar in both REST and SOAP modules.</p>
</div>
<div class="paragraph">
<p>The documentation will cover the REST calls. All the REST services present in DSS are compliant with <a href="https://www.openapis.org/">OpenAPI Specification</a>.</p>
</div>
<div class="paragraph">
<p>Additionally, we also provide a <a href="https://github.com/esig/dss/tree/master/dss-cookbook/src/main/soapui">SOAP-UI</a> and <a href="https://github.com/esig/dss/tree/master/dss-cookbook/src/main/postman">Postman</a> samples in the <code>dss-cookbook</code> module for simplicity.</p>
</div>
<div class="sect2">
<h3 id="REST">13.1. REST</h3>
<div class="sect3">
<h4 id="_rest_signature_service">13.1.1. REST signature service</h4>
<div class="paragraph">
<p>This service exposes several methods taking as input one or more document and having as output a signed data object (possibly a timestamped document):</p>
</div>
<div class="listingblock">
<div class="title">Rest signature service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">                <span style="color:#777">// Initializes the rest client</span>
                RestDocumentSignatureService restClient = <span style="color:#080;font-weight:bold">new</span> RestDocumentSignatureServiceImpl();
                
                <span style="color:#777">// Defines RemoteSignatureParameters</span>
                RemoteSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> RemoteSignatureParameters();
                parameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_B);
                parameters.setSigningCertificate(<span style="color:#080;font-weight:bold">new</span> RemoteCertificate(privateKey.getCertificate().getEncoded()));
                parameters.setSignaturePackaging(SignaturePackaging.ENVELOPING);
                parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);
                
                <span style="color:#777">// Initialize a RemoteDocument object to be signed</span>
                FileDocument fileToSign = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/test/resources/sample.pdf</span><span style="color:#710">&quot;</span></span>));
                RemoteDocument toSignDocument = <span style="color:#080;font-weight:bold">new</span> RemoteDocument(Utils.toByteArray(fileToSign.openStream()), fileToSign.getName());
                
                <span style="color:#777">// computes the digest to be signed</span>
                ToBeSignedDTO dataToSign = restClient.getDataToSign(<span style="color:#080;font-weight:bold">new</span> DataToSignOneDocumentDTO(toSignDocument, parameters));

                <span style="color:#777">// Creates a SignOneDocumentDTO</span>
                SignatureValue signatureValue = signingToken.sign(DTOConverter.toToBeSigned(dataToSign), DigestAlgorithm.SHA256, privateKey);
                SignOneDocumentDTO signDocument = <span style="color:#080;font-weight:bold">new</span> SignOneDocumentDTO(toSignDocument, parameters,
                                <span style="color:#080;font-weight:bold">new</span> SignatureValueDTO(signatureValue.getAlgorithm(), signatureValue.getValue()));
                
                <span style="color:#777">// Adds the signature value to the document</span>
                RemoteDocument signedDocument = restClient.signDocument(signDocument);

                <span style="color:#777">// Define the extension parameters</span>
                RemoteSignatureParameters extendParameters = <span style="color:#080;font-weight:bold">new</span> RemoteSignatureParameters();
                extendParameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_T);

                <span style="color:#777">// Extends the existing signature</span>
                RemoteDocument extendedDocument = restClient.extendDocument(<span style="color:#080;font-weight:bold">new</span> ExtendDocumentDTO(signedDocument, extendParameters));
                
                <span style="color:#777">// Defines timestamp parameters</span>
                RemoteTimestampParameters remoteTimestampParameters = <span style="color:#080;font-weight:bold">new</span> RemoteTimestampParameters();
                remoteTimestampParameters.setDigestAlgorithm(DigestAlgorithm.SHA256);
                
                <span style="color:#777">// Defines a Timestamp document DTO</span>
                TimestampOneDocumentDTO timestampOneDocumentDTO = <span style="color:#080;font-weight:bold">new</span> TimestampOneDocumentDTO(extendedDocument, remoteTimestampParameters);
                
                <span style="color:#777">// Timestamps a provided document (available for PDF, ASiC-E and ASiC-S container formats)</span>
                RemoteDocument timestampedDocument = restClient.timestampDocument(timestampOneDocumentDTO);</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_get_data_to_sign">13.1.1.1. Get data to sign</h5>
<div class="paragraph">
<p>The method allows retrieving the data to be signed. The user sends the document to be signed, the parameters (signature level,&#8230;&#8203;) and the certificate chain.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The parameters in getDataToSign and signDocument MUST be the same (especially the signing date).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_sign_document">13.1.1.2. Sign document</h5>
<div class="paragraph">
<p>The method allows generation of the signed document with the received signature value.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The parameters in getDataToSign and signDocument MUST be the same (especially the signing date).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/2/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/2/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/2/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/2/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/2/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/2/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_extend_document">13.1.1.3. Extend document</h5>
<div class="paragraph">
<p>The method allows augmentation of an existing signature to a higher level.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/3/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/3/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/3/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/3/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/3/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-and-extend-one-document/3/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_timestamp_document">13.1.1.4. Timestamp document</h5>
<div class="paragraph">
<p>The method allows timestamping of a provided document.
Available for PDF, ASiC-E and ASiC-S container formats.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/timestamp-one-document/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/timestamp-one-document/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/timestamp-one-document/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/timestamp-one-document/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/timestamp-one-document/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/timestamp-one-document/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_get_data_to_be_counter_signed">13.1.1.5. Get data to be counter-signed</h5>
<div class="paragraph">
<p>This method returns the data to be signed in order to create a counter signature. The user should provide a document containing a signature to be counter-signed, id of the signature, and other parameters similarly to the method 'getDataToSign()'.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The parameters in getDataToBeCounterSigned and counterSignSignature MUST be the same (especially the signing date).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_counter_sign_signature">13.1.1.6. Counter-Sign Signature</h5>
<div class="paragraph">
<p>This method incorporates a created counter signature to unsigned properties of the master signature with this specified id.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The parameters in getDataToBeCounterSigned and counterSignSignature MUST be the same (especially the signing date).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/2/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/2/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/2/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/2/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/2/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/counter-sign-signature/2/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rest_server_signature_service">13.1.2. REST server signature service</h4>
<div class="paragraph">
<p>This service also exposes some methods for server signing operations.:</p>
</div>
<div class="listingblock">
<div class="title">Rest server signing service</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Instantiate a RestSignatureTokenConnection</span>
RestSignatureTokenConnection remoteToken = <span style="color:#080;font-weight:bold">new</span> RestSignatureTokenConnectionImpl();

<span style="color:#777">// Retrieves available keys on server side</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;RemoteKeyEntry&gt; keys = remoteToken.getKeys();

<span style="color:#0a8;font-weight:bold">String</span> alias = keys.get(<span style="color:#00D">0</span>).getAlias();

<span style="color:#777">// Retrieves a key on the server side by its alias</span>
RemoteKeyEntry key = remoteToken.getKey(alias);

DSSDocument documentToSign = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello world!</span><span style="color:#710">&quot;</span></span>.getBytes());

<span style="color:#777">// Create a toBeSigned DTO</span>
ToBeSignedDTO toBeSigned = <span style="color:#080;font-weight:bold">new</span> ToBeSignedDTO(DSSUtils.toByteArray(documentToSign));

<span style="color:#777">// Signs the document with a given Digest Algorithm and alias for a key to use</span>
<span style="color:#777">// Signs the digest value with the given key</span>
SignatureValueDTO signatureValue = remoteToken.sign(toBeSigned, DigestAlgorithm.SHA256, alias);

<span style="color:#777">// Or alternatively we can sign the document by providing digest only</span>

<span style="color:#777">// Prepare digestDTO. </span>
<span style="color:#777">// NOTE: the used Digest algorithm must be the same!</span>
DigestDTO digestDTO = <span style="color:#080;font-weight:bold">new</span> DigestDTO(DigestAlgorithm.SHA256, DSSUtils.digest(DigestAlgorithm.SHA256, documentToSign));

<span style="color:#777">// Signs the digest</span>
SignatureValueDTO signatureValueFromDigest = remoteToken.signDigest(digestDTO, alias);</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_get_keys">13.1.2.1. Get keys</h5>
<div class="paragraph">
<p>This method allows retrieving of all available keys on the server side (PKCS#11, PKCS#12, HSM,&#8230;&#8203;). All keys will have an alias, a signing certificate and its chain. The alias will be used in following steps.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-keys/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-keys/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-keys/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-keys/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-keys/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-keys/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_get_key">13.1.2.2. Get key</h5>
<div class="paragraph">
<p>This method allows retrieving a key information for a given alias.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-key/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-key/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-key/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-key/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-key/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-key/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_sign">13.1.2.3. Sign</h5>
<div class="paragraph">
<p>This method allows signing of given digests with a server side certificate.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-digest-document-remotely/3/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-digest-document-remotely/3/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-digest-document-remotely/3/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-digest-document-remotely/3/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-digest-document-remotely/3/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/sign-digest-document-remotely/3/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rest_validation_service">13.1.3. REST validation service</h4>
<div class="paragraph">
<p>DSS provides also a module for documents validation.</p>
</div>
<div class="sect4">
<h5 id="_validate_a_document">13.1.3.1. Validate a document</h5>
<div class="paragraph">
<p>This service allows a signature validation (all formats/types) against a validation policy.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-doc/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-doc/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-doc/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-doc/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-doc/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-doc/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_retrieve_original_documents">13.1.3.2. Retrieve original document(s)</h5>
<div class="paragraph">
<p>This service returns the signed data for a given signature.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-original-documents/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-original-documents/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-original-documents/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-original-documents/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-original-documents/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-original-documents/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rest_certificate_validation_service">13.1.4. REST certificate validation service</h4>
<div class="sect4">
<h5 id="_validate_a_certificate">13.1.4.1. Validate a certificate</h5>
<div class="paragraph">
<p>This service allows a certificate validation (provided in a binary format).</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-cert/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-cert/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-cert/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-cert/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-cert/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/validate-cert/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rest_remote_timestamp_service">13.1.5. REST remote timestamp service</h4>
<div class="sect4">
<h5 id="_get_timestamp_response">13.1.5.1. Get Timestamp Response</h5>
<div class="paragraph">
<p>This service allows a remote timestamp creation. The method takes as an input the digest to be timestamped and digest algorithm that has been used for the digest value computation. The output of the method is the generated timestamp&#8217;s binaries.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JSON</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-timestamp-response/1/request-body.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-timestamp-response/1/response-body.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTP</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-timestamp-response/1/http-request.adoc">Request</a> | <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-timestamp-response/1/http-response.adoc">Response</a></p>
</li>
<li>
<p><strong>HTTPie</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-timestamp-response/1/httpie-request.adoc">Request</a></p>
</li>
<li>
<p><strong>Curl</strong>: <a href="https://github.com/esig/dss/blob/master/dss-cookbook/src/main/asciidoc/_restdocs/get-timestamp-response/1/curl-request.adoc">Request</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="SOAP">13.2. SOAP</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_internationalization_i18n">14. Internationalization (i18n)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="i18nLanguage">14.1. Language of reports</h3>
<div class="paragraph">
<p>DSS provides a module allowing changing a language for generated reports.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Internationalization module supports translation of only validation process messages.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A target language of the report can be set with the following code:</p>
</div>
<div class="listingblock">
<div class="title">Language customization</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SignedDocumentValidator validator = SignedDocumentValidator.fromDocument(signedDocument);
<span style="color:#777">// A target Locale must be defined for the validator</span>
validator.setLocale(<span style="color:#0a8;font-weight:bold">Locale</span>.FRENCH); <span style="color:#777">// for French language</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case if no language is specified, the framework will use a default <code>Locale</code> obtained from OS on a running machine. If a requested language is not found, a default translation will be used.</p>
</div>
<div class="paragraph">
<p>As a default configuration DSS provides English translation.</p>
</div>
<div class="paragraph">
<p>In order to provide a custom translation, a new file must be created inside <code>src\main\resources</code> directory of your project with a name followed by one of the patterns:</p>
</div>
<div class="paragraph">
<p><code>dss-messages_XX.properties</code> or
<code>dss-messages_XX_YY.properties</code>, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XX - an abbreviation of a target language;</p>
</li>
<li>
<p>YY - a country code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, for a French language a file with a name <code>dss-messages_fr.properties</code> need to be created, or <code>dss-messages_fr_FR.properties</code> to use it only in France local.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptions">15. Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section provides an overview of runtime Exceptions which are being thrown by various modules of DSS framework.</p>
</div>
<div class="paragraph">
<p>The following Exceptions can be obtained by the upper level:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NullPointerException</code> is thrown when a mandatory parameter has not been provided by the end-user to the method/process, requiring the property;</p>
</li>
<li>
<p><code>IllegalArgumentException</code> is thrown when a configuration of input parameters is not valid for the called method or some parameters cannot be used together (e.g. on a signature creation);</p>
</li>
<li>
<p><code>IllegalInputException</code> is thrown when a provided input document is not valid for the requested process and/or the configuration of parameters is not applicable for the given document;</p>
</li>
<li>
<p><code>UnsupportedOperationException</code> is thrown when a method is not implemented or its usage with the requested parameters is not (yet) supported;</p>
</li>
<li>
<p><code>IllegalStateException</code> is thrown when the requested method cannot be performed at the current method (e.g. another method shall be executed before);</p>
</li>
<li>
<p><code>DSSException</code> is thrown in case of an error obtained during the internal DSS process (e.g. data conversion, CRL/OCSP parsing, etc.);</p>
</li>
<li>
<p><code>DSSExternalResourceException</code> is thrown if an error occurs during a remote source request (AIA, CRL, OCPS requests, etc.);</p>
</li>
<li>
<p><code>DSSRemoteServiceException</code> is thrown in case of a request/response error within <a href="#REST">REST</a> and <a href="#SOAP">SOAP</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_privacy">16. Privacy</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_use_of_digested_documents">16.1. Use of digested documents</h3>
<div class="paragraph">
<p>Digested documents can be used during signature creation instead of the original documents to keep the latter private. In that case, the signature is created in a detached way, using the digest of the original document only.</p>
</div>
<div class="paragraph">
<p>Refer to section <a href="#DSSDocuments">Representation of documents in DSS</a> for more information on digested documents, section <a href="#Packaging">Signature packaging</a> for information on the detached packaging of signatures and section <a href="#DetachedSignatureDigest">Detached signature based on digested document</a> for code illustrations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_original_document_in_the_data_to_be_signed">16.2. Original document in the Data To Be Signed</h3>
<div class="paragraph">
<p>The data to be signed (DTBS) for CAdES and XAdES does not contain the original document on which the signature value is computed. JAdES and PAdES DTBS, however, does contain the whole original content.</p>
</div>
</div>
<div class="sect2">
<h3 id="_private_information_in_logs">16.3. Private information in logs</h3>
<div class="paragraph">
<p>Five log levels are used in DSS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ERROR</strong> - is used for the most critical issues, interrupting a normal process workflow (encoding issues, not processable signed attributes, etc.).</p>
</li>
<li>
<p><strong>WARN</strong> - is used to indicate problems occurred during an executed process. Such issue does not stop or invalidate the process explicitly, but can have an impact on the final output.</p>
</li>
<li>
<p><strong>INFO</strong> - returns an important information to the logs.</p>
</li>
<li>
<p><strong>DEBUG</strong> - is used to print an extended information, such as token binaries, attribute values, etc.</p>
</li>
<li>
<p><strong>TRACE</strong> - is used to indicate the currently performing methods and state of objects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When setting a log execution level to <code>ERROR</code>, <code>WARN</code> or <code>INFO</code> levels, no private information will be print to the log file. However, <code>DEBUG</code> and <code>TRACE</code> might potentially contain private information, as they display more information, including the source binaries of tokens.</p>
</div>
<div class="paragraph">
<p>Since the logs are hardcoded it is not possible to modify the behavior.
Therefore, to avoid disclosing private information, users should not use the DEBUG and TRACE levels. It is also not recommended using these two levels in the production.</p>
</div>
<div class="paragraph">
<p>For example, when an error occurs on a certificate reading, DSS only WARN users that an error occurred. However, if the log level is set to DEBUG on the user&#8217;s side, the binaries of the failed certificate are printed.</p>
</div>
<div class="paragraph">
<p>Sometimes, DSS uses mixing rules for logging, such as it displays more information within a <code>WARN</code> or <code>INFO</code> level when <code>DEBUG</code> level is enabled.</p>
</div>
</div>
<div class="sect2">
<h3 id="ClientServerSeparation">16.4. Client-side signature creation with server-side remote key activation</h3>
<div class="paragraph">
<p>With DSS, it is possible to sign a document without needing to send it to the signing server. This is useful for users who do not want signing servers to have access to the information contained in their documents. Such a process is possible because DSS decomposes the signature of a document in three or four atomic steps.
See section <a href="#SignatureCreationThreeSteps">Signature creation in 3 stateless methods</a> for an extensive description of these steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The first step is performed by the client and consists in the computation of the data to be signed (DTBS).</p>
</li>
<li>
<p>For the XAdES and CAdES formats, the client can optionally compute the digest of the DTBS (DTBSR). For JAdES and PAdES the client shall compute the digest of the DTBS to "hide" the content of the original document, given that the DTBS of these two formats contains the whole original content. The client sends the DTBS or the DTBSR to the server.</p>
</li>
<li>
<p>Then, the server encrypts the DTBS using the private key to create the signature value. The server sends the signature value back to the client.</p>
</li>
<li>
<p>The last step takes place at the client-side. The client adds the signature value to the appropriate field.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following schema illustrates the different steps</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/clientCreation-serverKeyActivation.jpg" alt="client-server" width="80%" height="80%">
</div>
</div>
<div class="paragraph">
<p>For code illustrations of the different steps, refer to the <a href="#ClientServerAnnex">Client-side signature creation with server-side remote key activation</a> section in the Annex.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="AdvancedConcepts">17. Advanced DSS java concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="ServiceLoaderAdvanced">17.1. ServiceLoader</h3>
<div class="paragraph">
<p>DSS incorporates modules that are loaded in the run time based on the chosen configuration and the input data via a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html">ServiceLoader</a>. This provides a flexibility for an end-user to work only with selected modules and a possibility to expand DSS with custom implementations.</p>
</div>
<div class="paragraph">
<p>In order to provide a chosen implementation(s) to <code>ServiceLoader</code>, a file listing all the desired implementations should be created in the resource directory <code>META-INF/services</code> with a name matching the implemented interface. When merging sources (e.g. creating a Fat JAR module), the files can be lost/overwritten, and should be configured manually (all the required implementations shall be listed).</p>
</div>
<div class="paragraph">
<p>It is also possible to customize the order of the used implementation, but creating a corresponding file in <code>META-INF/services</code> directory within your project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If a DSS module(s) implementing a required interface(s) is added to your project&#8217;s dependency list, the implementation shall be loaded automatically.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following modules are provided with independent implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DSS Utils;</p>
</li>
<li>
<p>DSS CRL Parser;</p>
</li>
<li>
<p>DSS PAdES.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
At least one implementation shall be chosen.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="dssUtils">17.1.1. DSS Utils</h4>
<div class="paragraph">
<p>The module <code>dss-utils</code> offers an interface with utility methods to operate on String, Collection, I/O, etc. DSS framework provides two different implementations with the same behaviour :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dss-utils-apache-commons</code>: this module uses Apache Commons libraries (commons-lang3, commons-collection4, commons-io and commons-codec).</p>
</li>
<li>
<p><code>dss-utils-google-guava</code>: this module uses Google Guava (recommended on Android).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your integration includes <code>dss-utils</code>, you will need to select an implementation. For example, to choose the <code>dss-utils-apache-commons</code> implementation within a Maven project you need to define the following:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>eu.europa.ec.joinup.sd-dss<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>dss-utils-apache-commons<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dssCrlParser">17.1.2. DSS CRL Parser</h4>
<div class="paragraph">
<p>DSS contains two ways to parse/validate a CRL and to retrieve revocation data. An alternative to the <code>X509CRL</code> java object was developed to face memory issues in case of large CRLs. The <code>X509CRL</code> object fully loads the CRL in memory and can cause <code>OutOfMemoryError</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dss-crl-parser-x509crl</code>: this module uses the <code>X509CRL</code> java object.</p>
</li>
<li>
<p><code>dss-crl-parser-streams</code>: this module offers an alternative with a CRL streaming.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your integration requires <code>dss-crl-parser</code>, you will need to choose your implementation. For example, to choose the <code>dss-crl-parser-streams</code> implementation within a Maven project you need to define the following:</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>eu.europa.ec.joinup.sd-dss<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>dss-crl-parser-stream<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dssPades">17.1.3. DSS PAdES</h4>
<div class="paragraph">
<p>DSS allows generation, augmentation and validation of PAdES signatures with two different frameworks: PDFBox and OpenPDF (fork of iText). The <code>dss-pades</code> module only contains the common code and requires an underlying implementation :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dss-pades-pdfbox</code>: PAdES implementation based on <a href="https://github.com/apache/pdfbox">Apache PDFBox</a>. Supports drawing of custom text, images, as well as text+image, in a signature field.</p>
</li>
<li>
<p><code>dss-pades-openpdf</code>: PAdES implementation based on <a href="https://github.com/LibrePDF/OpenPDF">OpenPDF (fork of iText)</a>. Supports drawing of custom text OR images in a signature field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DSS permits to override the visible signature generation with these interfaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eu.europa.esig.dss.pdf.IPdfObjFactory</code>;</p>
</li>
<li>
<p><code>eu.europa.esig.dss.pdf.visible.SignatureDrawerFactory</code> (selects the <code>SignatureDrawer</code> depending on the <code>SignatureImageParameters</code> content);</p>
</li>
<li>
<p><code>eu.europa.esig.dss.pdf.visible.SignatureDrawer</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A new instance of the <code>IPdfObjFactory</code> can be created with its own <code>SignatureDrawerFactory</code> and injected in the <code>padesService.setPdfObjFactory(IPdfObjFactory)</code>. By default, DSS uses an instance of <code>ServiceLoaderPdfObjFactory</code>. This instance checks for any registered implementation in the classpath with the ServiceLoader (potentially a service from <code>dss-pades-pdfbox</code>, <code>dss-pades-openpdf</code> or your own(s)).</p>
</div>
<div class="sect4">
<h5 id="_dss_pdfbox">17.1.3.1. DSS PDFBox</h5>
<div class="paragraph">
<p>DSS allows switching between two implementations of the PDFBox framework: default (original) and native.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Native Drawer</strong>: A native implementation of PDFBox Drawer, allowing a user to add a vector text, image or combination of text and image to a visible signature field. The native implementation embeds the provided custom text to the inner PDF structure, that makes the text selectable and searchable, but also clearer and smoother in comparison with the raster implementation.</p>
</li>
<li>
<p><strong>Default Drawer</strong>: The original drawer implemented on the PDFBox framework, supports displaying of custom text, images, but also text and image combination in a signature field. The implementation does not include the provided custom text to the inner PDF structure, instead of it, the drawer creates an image representation of the provided text, which is added to the signature field (i.e. the text is not selectable and not searchable).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, DSS uses the "Native Drawer" as the PDFBox implementation. In order to switch the implementation, that allowed at runtime, you have to set a new instance for PdfObjFactory as following:</p>
</div>
<div class="listingblock">
<div class="title">Runtime PDF Object Factory changing</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">service.setPdfObjFactory(<span style="color:#080;font-weight:bold">new</span> PdfBoxNativeObjectFactory());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or create a new file <code>META-INF/services/eu.europa.esig.dss.pdf.IPdfObjFactory</code> within project&#8217;s resources, defining the desired implementation (see <a href="#ServiceLoaderAdvanced">ServiceLoader</a> for more information).</p>
</div>
</div>
<div class="sect4">
<h5 id="_dss_openpdf">17.1.3.2. DSS OpenPDF</h5>
<div class="paragraph">
<p>This implementation is based on the OpenPDF framework. DSS provides two drawers using the implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TextOnlySignatureDrawer</code> - to draw a vector text information within a signature field. The text information is selectable and searchable.</p>
</li>
<li>
<p><code>ImageOnlySignatureDrawer</code> - to draw an image within a signature field.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
DSS provides a limited support of OpenPDF framework, therefore not all features are supported (e.g. text+image drawing).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multithreading">17.2. Multithreading</h3>
<div class="paragraph">
<p>DSS can be used in multi-threaded environments but some points need to be considered like resources sharing and caching. All operations are stateless and this fact requires to be maintained. Some resources can be shared, others are proper to an operation.</p>
</div>
<div class="paragraph">
<p>For each provided operation, DSS requires a <code>CertificateVerifier</code> object. This object is responsible to provide certificates and accesses to external resources (AIA, CRL, OCSP, etc.). At the beginning of all operation, CertificateSources and RevocationSources are created for each signature / timestamp / revocation data. Extracted information are combined with the configured sources in the CertificateVerifier. For these reasons, integrators need to be careful about the <code>CertificateVerifier</code> configuration.</p>
</div>
<div class="sect3">
<h4 id="_resource_sharing">17.2.1. Resource sharing</h4>
<div class="paragraph">
<p>The trusted certificates can be shared between multiple threads because these certificates are static. This means they don&#8217;t require more analysis. Their status won&#8217;t evolve. For these certificates, DSS doesn&#8217;t need to collect issuer certificate and/or their revocation data.</p>
</div>
<div class="paragraph">
<p>In opposition, the adjunct certificates cannot be shared. These certificates concern a specific signature/validation operation. This parameter is used to provide missing certificate(s). When DSS is unable to build the complete certificate path with the provided certificates (as signature parameters or embedded within a signature), it is possible to inject certificates that are not present. These certificates are not necessarily trusted and may require future "modifications" like revocation data collection,&#8230;&#8203;</p>
</div>
</div>
<div class="sect3">
<h4 id="_caching_2">17.2.2. Caching</h4>
<div class="paragraph">
<p>In case of multi-threading usage, we strongly recommend caching of external resources. All external resources can be cached (AIA, CRL, OCSP) to improve performances and to avoid requesting too much time the same resources. FileCacheDataLoader and JdbcCacheCRLSource can help you in this way.</p>
</div>
<div class="paragraph">
<p>See section <a href="#CachingUseCases">Caching use cases</a> of the Annex for complete examples of caching revocation data, certificates and trusted lists.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jaxb_modules">17.3. JAXB modules</h3>
<div class="sect3">
<h4 id="_general">17.3.1. General</h4>
<div class="paragraph">
<p>DSS provides the following JAXB modules with a harmonized structure :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dss-policy-jaxb</code> - defines validation policy JAXB model</p>
</li>
<li>
<p><code>dss-diagnostic-jaxb</code> - defines Diagnostic Data JAXB model</p>
</li>
<li>
<p><code>dss-detailed-report-jaxb</code> - defines Detailed Report JAXB model</p>
</li>
<li>
<p><code>dss-simple-report-jaxb</code> - defines Simple Report JAXB model</p>
</li>
<li>
<p><code>dss-simple-certificate-report-jaxb</code> - defines Certificate Simple Report JAXB model</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All modules share the same logic and have the following structure (where &#42;&#42;&#42; is a model name):</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><strong><em>dss-&#42;&#42;&#42;-jaxb</em></strong></code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><strong><em>src/main/java</em></strong></code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><strong><em>eu.europa.esig.dss.&#42;&#42;&#42;</em></strong></code></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code><strong><em>&#42;&#42;&#42;.java</em></strong></code> - wrapper(s) which eases the JAXB manipulation</p>
</li>
<li>
<p><code><strong><em>&#8230;&#8203;</em></strong></code></p>
</li>
<li>
<p><code><strong><em>&#42;&#42;&#42;Facade.java</em></strong></code> - class which allows marshalling/unmarshalling of jaxb objects, generation of HTML/PDF content, etc.</p>
</li>
<li>
<p><code><strong><em>&#42;&#42;&#42;XmlDefiner.java</em></strong></code> - class which contains the model definition (XSD, XSLT references, ObjectFactory)</p>
</li>
<li>
<p><code><strong><em>jaxb</em></strong></code> - generated on compile time</p>
<div class="ulist">
<ul>
<li>
<p><code><strong><em>Xml&#42;&#42;&#42;.java</em></strong></code> - JAXB model</p>
</li>
<li>
<p><code><strong><em>&#8230;&#8203;</em></strong></code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1"><code><strong><em>src/main/resources</em></strong></code></dt>
<dd>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><strong><em>xsd</em></strong></code></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code><strong><em>&#42;&#42;&#42;.xsd</em></strong></code> - XML Schema (XSD) for the Detailed Report model</p>
</li>
<li>
<p><code><strong><em>binding.xml</em></strong></code> - XJC instructions to generate the JAXB model from the XSD</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code><strong><em>xslt</em></strong></code></dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><code><strong><em>html</em></strong></code></p>
<div class="ulist">
<ul>
<li>
<p><code><strong><em>&#42;&#42;&#42;.xslt</em></strong></code> - XML Stylesheet for the HTML generation</p>
</li>
</ul>
</div>
</li>
<li>
<p><code><strong><em>pdf</em></strong></code></p>
<div class="ulist">
<ul>
<li>
<p><code><strong><em>&#42;&#42;&#42;.xslt</em></strong></code> - XML Stylesheet for the PDF generation</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In the main classes, a <code>Facade</code> is present to quickly operate with the JAXB objects (eg: marshall, unmarshall, generate the HTML/PDF, validate the XML structure,&#8230;&#8203;).</p>
</div>
<div class="listingblock">
<div class="title">DetailedReportFacade usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Reports completeReports = documentValidator.validateDocument();

DetailedReportFacade detailedReportFacade = DetailedReportFacade.newFacade();

<span style="color:#777">// Transforms the JAXB object to String (xml content)</span>
<span style="color:#0a8;font-weight:bold">String</span> marshalledDetailedReport = detailedReportFacade.marshall(completeReports.getDetailedReportJaxb());

<span style="color:#777">// Transforms the String (xml content) to a JAXB Object</span>
XmlDetailedReport xmlDetailedReport = detailedReportFacade.unmarshall(marshalledDetailedReport);

<span style="color:#777">// Generates the HTML content for the given Detailed Report (compatible with</span>
<span style="color:#777">// BootStrap)</span>
<span style="color:#777">// Similar method is available for PDF generation (requires Apache FOP)</span>
<span style="color:#0a8;font-weight:bold">String</span> htmlDetailedReport = detailedReportFacade.generateHtmlReport(completeReports.getDetailedReportJaxb());</code></pre>
</div>
</div>
<div class="paragraph">
<p>An <code>XmlDefiner</code> is also available with the access to the embedded XML Schemas (XSD), the XML Stylesheets (XSLT) to be able to generate the HTML or the PDF content (for DSS specific JAXB) and the JAXB Object Factory.</p>
</div>
<div class="listingblock">
<div class="title">DetailedReportXmlDefiner usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// The JAXB Object Factory</span>
<span style="color:#0a8;font-weight:bold">ObjectFactory</span> objectFactory = DetailedReportXmlDefiner.OBJECT_FACTORY;

<span style="color:#777">// The JAXBContext (cached)</span>
JAXBContext jaxbContext = DetailedReportXmlDefiner.getJAXBContext();

<span style="color:#777">// The XML Schema to validate a XML content (cached)</span>
<span style="color:#0a8;font-weight:bold">Schema</span> schema = DetailedReportXmlDefiner.getSchema();

<span style="color:#777">// The Templates object with the loaded XML Stylesheet to generate the HTML</span>
<span style="color:#777">// content from the JAXB Object (cached)</span>
<span style="color:#0a8;font-weight:bold">Templates</span> bootstrap4Templates = DetailedReportXmlDefiner.getHtmlBootstrap4Templates();

<span style="color:#777">// The Templates object with the loaded XML Stylesheet to generate the PDF</span>
<span style="color:#777">// content from the JAXB Object (cached)</span>
<span style="color:#0a8;font-weight:bold">Templates</span> pdfTemplates = DetailedReportXmlDefiner.getPdfTemplates();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_trusted_list">17.3.2. Creating a trusted list</h4>
<div class="paragraph">
<p>It is possible to programatically create or/and edit an XML Trusted List using the JAXB module.</p>
</div>
<div class="paragraph">
<p>Below is an example of how to use JAXB modules to create a trusted list (not complete solution):</p>
</div>
<div class="listingblock">
<div class="title">Creation of a trusted list</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Create an empty 'TrustServiceStatusList' element</span>
TrustStatusListType trustStatusListType = objectFactory.createTrustStatusListType();

<span style="color:#777">// Fill the requred information, Id, ...</span>
trustStatusListType.setId(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Demo-TL</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// Store to file</span>
DSSDocument modifiedUnsignedTL = <span style="color:#069">null</span>;
<span style="color:#080;font-weight:bold">try</span> (<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">ByteArrayOutputStream</span> baos = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ByteArrayOutputStream</span>()) {
    TrustedListFacade.newFacade().marshall(trustStatusListType, baos, <span style="color:#069">false</span>);
    modifiedUnsignedTL = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(baos.toByteArray());
}
modifiedUnsignedTL.save(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target/unsigned_TL.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>And an example how to modify an existing Trusted List (e.g. change its version):</p>
</div>
<div class="listingblock">
<div class="title">Edit a trusted list</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Load original Trusted List</span>
<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">File</span> file = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/trusted-list.xml</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// Parse it to JAXB object</span>
<span style="color:#088;font-weight:bold">final</span> TrustStatusListType jaxbObject = TrustedListFacade.newFacade().unmarshall(file, <span style="color:#069">false</span>);
assertNotNull(jaxbObject);

<span style="color:#777">// Modify JAXB Object where required</span>
jaxbObject.getSchemeInformation().setTSLSequenceNumber(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">BigInteger</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">39</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// Store to file</span>
DSSDocument modifiedUnsignedTL;
<span style="color:#080;font-weight:bold">try</span> (<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">ByteArrayOutputStream</span> baos = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ByteArrayOutputStream</span>()) {
    TrustedListFacade.newFacade().marshall(jaxbObject, baos, <span style="color:#069">false</span>);
    modifiedUnsignedTL = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(baos.toByteArray());
}
modifiedUnsignedTL.save(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target/unsigned_TL.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_validating_xsd_conformity">17.3.3. Validating XSD conformity</h4>
<div class="paragraph">
<p>You can also use JAXB modules not only for the content creation or changing, but also in order to verify the conformity of an XML document against its XSD schema.</p>
</div>
<div class="paragraph">
<p>For example, in order to validate a XAdES signature conformance against <a href="https://github.com/esig/dss/blob/master/specs-xades/src/main/resources/xsd/XAdES01903v132-201601.xsd">1.3.2 XSD schema</a>, you can use the corresponding class <code>XAdES319132Utils</code>:</p>
</div>
<div class="listingblock">
<div class="title">Validating XSD conformity</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">Document</span> signatureDocDom = DomUtils.buildDOM(xadesSignatureDocument);
<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; errors = XAdES319132Utils.getInstance().validateAgainstXSD(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">DOMSource</span>(signatureDocDom));</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ReportStylesheets">17.3.4. Report stylesheets</h4>
<div class="paragraph">
<p>The report modules (namely: <code>dss-simple-report-jaxb</code>, <code>dss-simple-certificate-report-jaxb</code> and <code>dss-detailed-report-jaxb</code>) contain XSLT style sheets each for final reports generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bootstrap 4 XSLT for HTML report;</p>
</li>
<li>
<p>PDF XSLT for PDF report.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since DSS 5.9 only Bootstrap 4 XSLT is provided within the framework for HTML report generation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to generate a report with a selected style sheet you need to call a relevant method in a Facade class (see classes definition above):</p>
</div>
<div class="listingblock">
<div class="title">HTML report generation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">String</span> bootstrap4Report = SimpleReportFacade.newFacade().generateHtmlReport(xmlSimpleReport);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, in case you need to customize the transformer, you can create a report by using an <code>XmlDefiner</code>:</p>
</div>
<div class="listingblock">
<div class="title">Custom report generation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">try</span> (<span style="color:#0a8;font-weight:bold">Writer</span> writer = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">StringWriter</span>()) {
        <span style="color:#0a8;font-weight:bold">Transformer</span> transformer = SimpleCertificateReportXmlDefiner.getHtmlBootstrap4Templates().newTransformer();
        <span style="color:#777">// specify custom parameters if needed</span>
        transformer.transform(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">StreamSource</span>(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">StringReader</span>(simpleReport)), <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">StreamResult</span>(writer));
        <span style="color:#0a8;font-weight:bold">String</span> bootstrap4Report = writer.toString();
} </code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="DiagnosticDataStylesheets">17.3.5. Diagnostic data stylesheets</h4>
<div class="paragraph">
<p>The <code>dss-diagnostic-jaxb</code> module contains an XSLT stylesheet that creates an SVG image from an XML document in order to visually represent the signature at validation time.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="xmlSecurities">17.4. XML securities</h3>
<div class="paragraph">
<p>The framework allows custom configuration of XML-related modules for enabling/disabling of XML securities (e.g. in order to use Xalan or Xerces).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
We strongly do not recommend disabling of security features and usage of deprecated dependencies. Be aware: the feature is designed only for experienced users, and all changes made in the module are at your own risk.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The configuration is available for the following classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javax.xml.parsers.DocumentBuilderFactory</code> with a <code>DocumentBuilderFactoryBuilder</code> - builds a DOM document object from the obtained XML file and creates a new <code>org.w3c.dom.Document</code>;</p>
</li>
<li>
<p><code>javax.xml.transform.TransformerFactory</code> with a <code>TransformerFactoryBuilder</code> - loads XML templates and builds DOM objects;</p>
</li>
<li>
<p><code>javax.xml.validation.SchemaFactory</code> with a <code>SchemaFactoryBuilder</code> - loads XML Schema;</p>
</li>
<li>
<p><code>javax.xml.validation.Validator</code> with a <code>ValidatorConfigurator</code> - configures a validator to validate an XML document against an XML Schema.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All the classes can be configured with the following methods (example for <code>TransformerFactory</code>):</p>
</div>
<div class="listingblock">
<div class="title">XMLSecurities configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Obtain a singleton instance of {@link XmlDefinerUtils}</span>
XmlDefinerUtils xmlDefinerUtils = XmlDefinerUtils.getInstance();

<span style="color:#777">// returns a predefined {@link TransformerFactoryBuilder} with all securities in place</span>
TransformerFactoryBuilder transformerBuilder = TransformerFactoryBuilder.getSecureTransformerBuilder();

<span style="color:#777">// sets an alert in case of exception on feature/attribute setting</span>
transformerBuilder.setSecurityExceptionAlert(<span style="color:#080;font-weight:bold">new</span> LogOnStatusAlert(<span style="color:#0a8;font-weight:bold">Level</span>.WARN));

<span style="color:#777">// allows to enable a feature</span>
transformerBuilder.enableFeature(<span style="color:#0a8;font-weight:bold">XMLConstants</span>.FEATURE_SECURE_PROCESSING);

<span style="color:#777">// allows to disable a feature</span>
transformerBuilder.disableFeature(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">FEATURE_TO_DISABLE</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// allows to set an attribute with a value</span>
transformerBuilder.setAttribute(<span style="color:#0a8;font-weight:bold">XMLConstants</span>.ACCESS_EXTERNAL_DTD, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// sets the transformer (will be applied for all calls)</span>
xmlDefinerUtils.setTransformerFactoryBuilder(transformerBuilder);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>javax.xml.parsers.DocumentBuilderFactory</code>, that allows XML files parsing and creation of DOM <code>org.w3c.dom.Document</code> object, can be configured with the following methods:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since DSS 5.9 the configuration of <code>javax.xml.parsers.DocumentBuilderFactory</code> has been moved from <code>DomUtils</code> to a new singleton class <code>DocumentBuilderFactoryBuilder</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">DocumentBuilderFactory configuration</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// returns a configured secure instance of {@link DocumentBuilderFactoryBuilder}</span>
DocumentBuilderFactoryBuilder documentBuilderFactoryBuilder = DocumentBuilderFactoryBuilder.getSecureDocumentBuilderFactoryBuilder();

<span style="color:#777">// allows enabling of a feature</span>
documentBuilderFactoryBuilder.enableFeature(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://xml.org/sax/features/external-general-entities</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// allows disabling of a feature</span>
documentBuilderFactoryBuilder.disableFeature(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://apache.org/xml/features/nonvalidating/load-external-dtd</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// allows to set an attribute</span>
documentBuilderFactoryBuilder.setAttribute(<span style="color:#0a8;font-weight:bold">XMLConstants</span>.ACCESS_EXTERNAL_DTD, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// sets the DocumentBuilderFactoryBuilder (will be applied for all calls)</span>
xmlDefinerUtils.setDocumentBuilderFactoryBuilder(documentBuilderFactoryBuilder);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class <code>XmlDefinerUtils</code> is a singleton, therefore all changes performed on the instance will have an impact to all calls of the related methods.</p>
</div>
<div class="paragraph">
<p>See section <a href="#Alerts">Use of Alerts throughout the framework</a> in chapter Annex for more information on alerts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="DSSUpgrades">18. DSS upgrades and change history</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dss_upgrades">18.1. DSS upgrades</h3>
<div class="sect3">
<h4 id="_code_adaptations">18.1.1. Code adaptations</h4>
<div class="paragraph">
<p>In the <code>pom.xml</code> of your project, search for the properties and then change the dss version in the <code>dss.version</code> field. The following example shows how to switch to DSS version 5.9.</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;properties&gt;</span>
    ...
    <span style="color:#070;font-weight:bold">&lt;dss.version&gt;</span>5.9<span style="color:#070;font-weight:bold">&lt;/dss.version&gt;</span>
    ...
<span style="color:#070;font-weight:bold">&lt;/properties&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_possible_problems_and_solutions">18.1.2. Possible problems and solutions</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Possible problems and solutions</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 12.5%;">
<col style="width: 37.5%;">
<col style="width: 37.5%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Release date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Problem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="6"><p class="tableblock">v5.8 to v5.9</p></td>
<td class="tableblock halign-left valign-top" rowspan="6"><p class="tableblock">September 2021</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dss_change_history_for_added_features_fixed_bugs">18.1.3. DSS change history for added features fixed bugs</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Change history for features and bugs</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Release date</th>
<th class="tableblock halign-left valign-top">Features</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">September 2021</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Main new features / improvements :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Many improvements in the validation reports</p>
</li>
<li>
<p>AIASource introduction : more customizations</p>
</li>
<li>
<p>Customization of revocation collection strategy (OCSP/CRL first)</p>
</li>
<li>
<p>DocumentBuilderFactory securities</p>
</li>
<li>
<p>ECDSA / ECDSA-PLAIN support</p>
</li>
<li>
<p>JAdES (JSON AdES) consolidations</p>
</li>
<li>
<p>PAdES visual signature refactorings / improvements :</p>
<div class="ulist">
<ul>
<li>
<p>Image scaling : STRETCH / ZOOM_AND_CENTER / CENTER</p>
</li>
<li>
<p>Text wrapping : BOX_FILL / FILL_BOX_AND_LINEBREAK / FONT_BASIC</p>
</li>
</ul>
</div>
</li>
<li>
<p>Dependency upgrades (Santuario, BouncyCastle, PDFBox,…)</p>
</li>
<li>
<p>Java 16 support</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bug fixes :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Short term OCSP response</p>
</li>
<li>
<p>On hold certificate</p>
</li>
<li>
<p>Qualification conflict (issuance time / best signing time)</p>
</li>
<li>
<p>ASiC-S can’t be timestamped twice</p>
</li>
<li>
<p>PAdES revision extraction</p>
</li>
<li>
<p>PAdES wrong level detection (files with multiple signatures/timestamps)</p>
</li>
<li>
<p>ETSI Validation report : multiple files / references</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.9.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">July 2021</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Many improvements in the validation reports</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AIASource introduction : more customizations</p>
</li>
<li>
<p>Customization of revocation collection strategy (OCSP/CRL first)</p>
</li>
<li>
<p>DocumentBuilderFactory securities</p>
</li>
<li>
<p>ECDSA / ECDSA-PLAIN support</p>
</li>
<li>
<p>JAdES (JSON AdES) consolidations</p>
</li>
<li>
<p>PAdES visual signature refactorings / improvements :</p>
</li>
<li>
<p>Image scaling : STRETCH / ZOOM_AND_CENTER / CENTER</p>
</li>
<li>
<p>Text wrapping : BOX_FILL / FILL_BOX_AND_LINEBREAK / FONT_BASIC</p>
</li>
<li>
<p>Dependency upgrades (Santuario, BouncyCastle, PDFBox,…)</p>
</li>
<li>
<p>Java 16 support</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bug fixes :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Short term OCSP response</p>
</li>
<li>
<p>On hold certificate</p>
</li>
<li>
<p>Qualification conflict (issuance time / best signing time)</p>
</li>
<li>
<p>ASiC-S can’t be timestamped twice</p>
</li>
<li>
<p>PAdES revision extraction</p>
</li>
<li>
<p>PAdES wrong level detection (files with multiple signatures/timestamps)</p>
</li>
<li>
<p>ETSI Validation report : multiple files / references</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">February 2021</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>JAdES implementation (ETSI TS 119 182 v0.0.6) : signature creation, extension and validation (advanced electronic signatures based on JWS)</p>
</li>
<li>
<p>PDF Shadow attacks : prevention and detection</p>
</li>
<li>
<p>Counter Signature creation (CAdES, XAdES, JAdES and ASiC containers)</p>
</li>
<li>
<p>Support of the unsigned attribute SignaturePolicyStore (CAdES, XAdES, JAdES and ASiC containers)</p>
</li>
<li>
<p>Support of the QCLimitValue attribute</p>
</li>
<li>
<p>Support of Java 8 up to 15</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.8.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">December 2020</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>JAdES implementation (ETSI TS 119 182 v0.0.6) : signature creation, extension and validation (advanced electronic signatures based on JWS)</p>
</li>
<li>
<p>PDF Shadow attacks : prevention and detection</p>
</li>
<li>
<p>Counter Signature creation (CAdES, XAdES, JAdES and ASiC containers)</p>
</li>
<li>
<p>Support of the unsigned attribute SignaturePolicyStore (CAdES, XAdES, JAdES and ASiC containers)</p>
</li>
<li>
<p>Support of the QCLimitValue attribute</p>
</li>
<li>
<p>Support of Java 8 up to 15</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">August 2020</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>CertificatePool removal and performance ameliorations</p>
</li>
<li>
<p>QWAC validator</p>
</li>
<li>
<p>New design of PDF reports</p>
</li>
<li>
<p>Support of PSD2 attributes</p>
</li>
<li>
<p>Support of EdDSA</p>
</li>
<li>
<p>Signature representation with a timeline</p>
</li>
<li>
<p>Visual signature creation with REST/SOAP webservices</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.7.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">June 2020</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>CertificatePool removal and performance ameliorations</p>
</li>
<li>
<p>QWAC validator</p>
</li>
<li>
<p>New design of PDF reports</p>
</li>
<li>
<p>Support of PSD2 attributes</p>
</li>
<li>
<p>Support of EdDSA</p>
</li>
<li>
<p>Signature representation with a timeline</p>
</li>
<li>
<p>Visual signature creation with REST/SOAP webservices</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">March 2020</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Complete rewriting of the TL/LOTL loading with:</p>
<div class="ulist">
<ul>
<li>
<p>online / offline refresh</p>
</li>
<li>
<p>3 caches (download / parse / validate)</p>
</li>
<li>
<p>multiple LOTL support</p>
</li>
<li>
<p>multiple TL support (not linked to a LOTL)</p>
</li>
<li>
<p>Pivot LOTL support</p>
</li>
<li>
<p>Synchronization strategy (eg : expired TL/LOTL are rejected/accepted)</p>
</li>
<li>
<p>multi-lingual support (trust service matching)</p>
</li>
<li>
<p>alerting (eg : LOTL/OJ location desynchronization,&#8230;&#8203;)</p>
</li>
<li>
<p>complete reporting (summary of download / parsing / validation)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Independant timestamp creation and validation (not linked to a signature, with ASiC and PDF)</p>
</li>
<li>
<p>Timestamp qualification</p>
</li>
<li>
<p>Internationalization of the validation reports</p>
</li>
<li>
<p>Multiple Trusted Sources support</p>
</li>
<li>
<p>XAdES support of different prefixes / versions</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.6.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">January 2020</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">October 2019</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>The implementation of the ETSI Validation Report</p>
</li>
<li>
<p>The support of Java 12 (multi-release jars)</p>
</li>
<li>
<p>Webservice which allows to validate certificates.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.5.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">August 2019</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.4.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">August 2019</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">January 2019</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.4.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">October 2018</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Augmentation of signatures with invalid time-stamps, archive-time-stamps and revoked certificates</p>
</li>
<li>
<p>Upgrade to Java 8 or 9</p>
</li>
<li>
<p>Certify documents</p>
</li>
<li>
<p>Add support of KeyHash in OCSP Responses</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.3.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">October 2018</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Following a security assessment from the Ruhr-Universität Bochum, we are delivering security patches for DSS versions 5.2 and 5.3</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">July 2018</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Certificate validation</p>
</li>
<li>
<p>content-timestamps generation</p>
</li>
<li>
<p>SHA-3 support</p>
</li>
<li>
<p>non-EU trusted list(s) support</p>
</li>
<li>
<p>integration of the last version of MOCCA</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">May 2018</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Certificate validation</p>
</li>
<li>
<p>content-timestamps generation</p>
</li>
<li>
<p>SHA-3 support</p>
</li>
<li>
<p>non-EU trusted list(s) support</p>
</li>
<li>
<p>integration of the last version of MOCCA</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.3.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">April 2018</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Certificate validation</p>
</li>
<li>
<p>content-timestamps generation</p>
</li>
<li>
<p>SHA-3 support</p>
</li>
<li>
<p>non-EU trusted list(s) support</p>
</li>
<li>
<p>integration of the last version of MOCCA</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.2.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">October 2018</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Following a security assessment from the Ruhr-Universität Bochum, we are delivering security patches for DSS versions 5.2 and 5.3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">December 2017</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Qualification matrix guidelines and documentation</p>
</li>
<li>
<p>Improvements regarding visual representation of a signature</p>
</li>
<li>
<p>Alternative packaging: Image docker / spring-boot</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.2.RC2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">December 2017</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.2.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">September 2017</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>This release candidate comes with 2 main improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CRL streaming, the demo won’t use the X509CRL java object by default (it can be changed). With some signatures, we had large CRLs (+60Mo in Estonia) and that could cause memory issues.</p>
</li>
<li>
<p>RSASSA-PSS support, I received some requests to support these algorithms :</p>
<div class="ulist">
<ul>
<li>
<p>SHA1withRSAandMGF1</p>
</li>
<li>
<p>SHA224withRSAandMGF1</p>
</li>
<li>
<p>SHA256withRSAandMGF1</p>
</li>
<li>
<p>SHA384withRSAandMGF1</p>
</li>
<li>
<p>SHA512withRSAandMGF1</p>
</li>
</ul>
</div>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">September 2017</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.1.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">June 2017</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">April 2017</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Refactoring of ASiC format handling, following the ETSI ASiC Plugtest</p>
</li>
<li>
<p>Signature of multiple files (ASiC and XAdES)</p>
</li>
<li>
<p>Integration of the Qualification matrix as described in draft ETSI 119 172-4, for supporting signatures before and after 01/07/2016 (eIDAS entry into force)</p>
</li>
<li>
<p>Migration to PDFBox 2 for handling PDFs</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.0.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">January 2017</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Complete refactoring of the ASiC part (creation, extension and validation)</p>
</li>
<li>
<p>Compliance to eIDAS regulation.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v4.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">October 2016</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v4.7.RC2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">September 2016</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v4.7.RC1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">June 2016</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A XAdES PlugTest is planned in October / November 2015. Remaining changes resulting from this PlugTest and not included in v4.6 may be included in this release.
An eSignature Validation PlugTest is planned in April 2016. Depending on the actual timeframe, impacts from this PlugTest may be included in this release, and the release of DSS 4.7 will be postponed accordingly.</p>
</div>
<div class="paragraph">
<p>Other potential improvements and features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extension of signature validation policy support</p>
</li>
<li>
<p>CAdES attribute certificates</p>
</li>
<li>
<p>CRL in multiple parts</p>
</li>
<li>
<p>Distributed timestamps method</p>
</li>
<li>
<p>Support of cross-certification in path building</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v4.6*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">March 2016</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Based on standards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Signature formats when creating a signature: baseline profiles ETSI TS 103 171, 103 172, 103 173, and 103 174</p>
</li>
<li>
<p>Signature formats when validating a signature: baseline profiles, and core specs ETSI TS 101 903, 101 733, 102 778 and 102 918</p>
</li>
<li>
<p>Signature validation process ETSI TS 102 853</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Improvements in packaging and core functionalities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CAdES optimisation, CAdES multiple Signer Information. A CAdES PlugTest is occurring in June and July 2015. Changes resulting from this PlugTest will be included in this release. CAdES countersignature will not be supported.</p>
</li>
<li>
<p>Impacts from XAdES PlugTest of October 2015</p>
</li>
<li>
<p>Processing of large files</p>
</li>
<li>
<p>Further refactoring of demo applet (size, validation policy editor)</p>
</li>
<li>
<p>SOAP and REST Web Services</p>
</li>
<li>
<p>Standalone demo application</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>* October 2015: Implementing Acts Art. 27 &amp; 37 (eSig formats)</p>
</div>
</div>
<div class="sect3">
<h4 id="_dss_change_history_for_validation_policy">18.1.4. DSS change history for validation policy</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Change history for validation policy</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Release date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v5.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">September 2021</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Annex">19. Annex</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Alerts">19.1. Use of Alerts throughout the framework</h3>
<div class="paragraph">
<p>The framework includes an extended possibility to execute custom processes in case of arbitrary defined events.</p>
</div>
<div class="paragraph">
<p>The <code>Alert</code> is a basic interface used to trigger a process on a passed object.
DSS provides an <code>AbstractAlert</code> implementation of the interface with a clearly defined structure. The class must be instantiated with two attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AlertDetector</code> - used to detect an event/state of the object and trigger a process;</p>
</li>
<li>
<p><code>AlertHandler</code> - defines a process to be executed on an object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In its basic module, framework provides a few alerts based on a <code>Status</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ExceptionOnStatusAlert</code> - throws an <code>AlertException</code> (RuntimeException) when the status reports an issue;</p>
</li>
<li>
<p><code>LogOnStatusAlert</code> - logs a message with the defined log level;</p>
</li>
<li>
<p><code>SilentOnStatusAlert</code> - ignores the reported issue and does nothing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The usage of alerts is available in the following classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XML securities configurators from <code>dss-jaxb-parsers</code> module : <code>TransformerFactoryBuilder</code>, <code>SchemaFactoryBuilder</code>, <code>ValidatorConfigurator</code> (see chapter <a href="#xmlSecurities">XML securities</a> for more information);</p>
</li>
<li>
<p>CertificateVerifier - to handle the unexpected situation(s) in a custom way (introduced <code>AlertException</code> to re-throw exceptions, see section <a href="#certificateVerifier">CertificateVerifier configuration</a> for more information);</p>
</li>
<li>
<p>TLValidationJob - to process custom actions on change/state on loading of LOTL/TLs (see <code>LOTLAlert</code> and <code>TLAlert</code> in the <a href="#AlertingTL">Alerting from TL Loading</a> section).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_of_validation_policy_in_different_use_cases">19.2. Configuration of validation policy in different use cases</h3>
<div class="sect3">
<h4 id="_general_2">19.2.1. General</h4>
<div class="paragraph">
<p>A Signature validation policy is a set of rules/constraints that need to be fulfilled to validate a signature. When checking a constraints fails, this leads to a sub-indication in the validation report.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Validation policy constraints</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-middle">Constraint</th>
<th class="tableblock halign-center valign-middle">Sub-constraint</th>
<th class="tableblock halign-center valign-middle">Sub-constraint</th>
<th class="tableblock halign-center valign-middle">Sub-constraint</th>
<th class="tableblock halign-center valign-middle">Level</th>
<th class="tableblock halign-center valign-middle">Sub-indication</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="32"><p class="tableblock">ContainerConstraints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AcceptableContainerTypes</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ZipCommentPresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AcceptableZipComment</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">MimeTypeFilePresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AcceptableMimeTypeFileContent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ManifestFilePresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignedFilesPresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AllFilesSigned</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="235"><p class="tableblock">SignatureConstraints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">StructuralValidation</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AcceptablePolicies</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">PolicyAvailable</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">PolicyHashMatch</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AcceptableFormats</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="159"><p class="tableblock">BasicSignatureConstraints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataExistence</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ManifestEntryObjectExistence</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignatureIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignatureDuplicated</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ProspectiveCertificateChain</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignerInformationStore</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">PdfPageDifference</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">PdfAnnotationOverlap</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">PdfVisualDifference</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TrustedServiceTypeIdentifier</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TrustedServiceStatus</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="81"><p class="tableblock">SigningCertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Recognition</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AuthorityInfoAccessPresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationInfoAccessPresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">KeyUsage</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SerialNumberPresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationIssuerNotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotSelfSigned</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Qualification</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SupportedByQSCD</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">QcLegislationCountryCodes</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">IssuedToNaturalPerson</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">IssuedToLegalPerson</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">UsePseudonym</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="29"><p class="tableblock">CACertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="52"><p class="tableblock">SignedAttributes</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SigningCertificatePresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">UnicitySigningCertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SigningCertificateRefersCertificateChain</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CertDigestPresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CertDigestMatch</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">IssuerSerialMatch</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SigningTime</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">MessageDigestOrSignedPropertiesPresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ContentType</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ContentHints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CommitmentTypeIndication</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignerLocation</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ContentTimeStamp</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">UnsignedAttributes</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CounterSignature</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="175"><p class="tableblock">CounterSignatureConstraints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="131"><p class="tableblock">BasicSignatureConstraints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataExistence</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignatureIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignatureDuplicated</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ProspectiveCertificateChain</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TrustedServiceTypeIdentifier</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TrustedServiceStatus</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="73"><p class="tableblock">SigningCertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Recognition</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">AuthorityInfoAccessPresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationInfoAccessPresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">KeyUsage</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SerialNumberPresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotSelfSigned</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Qualification</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SupportedByQSCD</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">IssuedToNaturalPerson</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">IssuedToLegalPerson</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">UsePseudonym</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="29"><p class="tableblock">CACertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="44"><p class="tableblock">SignedAttributes</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SigningCertificatePresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CertDigestPresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CertDigestMatch</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">IssuerSerialMatch</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SigningTime</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">MessageDigestOrSignedPropertiesPresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ContentType</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ContentHints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CommitmentTypeIndication</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignerLocation</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ContentTimeStamp</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="127"><p class="tableblock">Timestamp</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TimestampDelay</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationTimeAgainstBestSignatureTime</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">BestSignatureTimeBeforeExpirationDateOfSigningCertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Coherence</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="87"><p class="tableblock">BasicSignatureConstraints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataExistence</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignatureIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ProspectiveCertificateChain</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="41"><p class="tableblock">SigningCertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Recognition</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ExtendedKeyUsage</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotSelfSigned</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="29"><p class="tableblock">CACertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="20"><p class="tableblock">SignedAttributes</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SigningCertificatePresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">UnicitySigningCertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SigningCertificateRefersCertificateChain</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CertDigestPresent</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">IssuerSerialMatch</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TSAGeneralNameContentMatch</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="91"><p class="tableblock">Revocation</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationFreshness</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">UnknownStatus</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SelfIssuedOCSP</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="79"><p class="tableblock">BasicSignatureConstraints</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataExistence</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ReferenceDataIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">SignatureIntact</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">ProspectiveCertificateChain</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="33"><p class="tableblock">SigningCertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Recognition</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="29"><p class="tableblock">CACertificate</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">Signature</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotExpired</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataAvailable</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">CRLNextUpdatePresent</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">RevocationDataFreshness</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotRevoked</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">NotOnHold</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="8"><p class="tableblock">Cryptographic</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">AcceptableEncryptionAlgo</p></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">MiniPublicKeySize</p></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">AcceptableDigestAlgo</p></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">AlgoExpirationDate</p></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">/</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="16"><p class="tableblock">eIDAS</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TLFreshness</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TLNotExpired</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TLWellSigned</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle" rowspan="4"><p class="tableblock">TLVersion</p></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle" rowspan="4"></td>
<td class="tableblock halign-center valign-middle"><p class="tableblock">FAIL</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">WARN</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">INFORM</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-center valign-middle"><p class="tableblock">IGNORE</p></td>
<td class="tableblock halign-center valign-middle"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_ades_validation">19.2.2. AdES validation</h4>
<div class="paragraph">
<p>According to ETSI EN 319 102-1 (cf. <a href="#R09">[R09]</a>), the signature validation process can be separated to different levels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Validation process for basic signatures - validates the signature at the validation (current) time;</p>
</li>
<li>
<p>Validation process for Signatures with Time and Signatures with Long-Term Validation Material - verifies the signature against its <em>best-signature-time</em> (i.e. against the signature time-stamp&#8217;s production time);</p>
</li>
<li>
<p>Validation process for Signatures providing Long Term Availability and Integrity of Validation Material - verifies the signature with all available Long-Term Availability material (i.e. including the validation of archive time-stamps).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DSS allows the user to choose the validation level when performing a signature validation, i.e. to specify the validation process to be used for validation (cf. <a href="#R09">[R09]</a>). By default, the highest level (with LTA enabled) is used.</p>
</div>
<div class="sect4">
<h5 id="_basic_ades_validation">19.2.2.1. Basic AdES validation</h5>
<div class="paragraph">
<p>Below you can find a signature validation example with a basic signature validation level:</p>
</div>
<div class="listingblock">
<div class="title">B-level AdES validation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// The document to be validated (any kind of signature file)</span>
DSSDocument document = <span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">File</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/test/resources/signature-pool/signedXmlXadesLT.xml</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// First, we need a Certificate verifier</span>
CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
cv.setAIASource(<span style="color:#080;font-weight:bold">new</span> DefaultAIASource());
cv.setOcspSource(<span style="color:#080;font-weight:bold">new</span> OnlineOCSPSource());
cv.setCrlSource(<span style="color:#080;font-weight:bold">new</span> OnlineCRLSource());

cv.addTrustedCertSources(trustedCertSource);
cv.addAdjunctCertSources(adjunctCertSource);

<span style="color:#777">// We create an instance of DocumentValidator</span>
<span style="color:#777">// It will automatically select the supported validator from the classpath</span>
SignedDocumentValidator documentValidator = SignedDocumentValidator.fromDocument(document);

<span style="color:#777">// We add the certificate verifier</span>
documentValidator.setCertificateVerifier(cv);

<span style="color:#777">// Validate the signature only against its B-level</span>
documentValidator.setValidationLevel(ValidationLevel.BASIC_SIGNATURES);

<span style="color:#777">// Here, everything is ready. We can execute the validation (for the example, we use the default and embedded</span>
<span style="color:#777">// validation policy)</span>
Reports reports = documentValidator.validateDocument();</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_long_term_ades_validation">19.2.2.2. Long Term AdES validation</h5>
<div class="listingblock">
<div class="title">LTV-level AdES validation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Validate the signature with long-term validation material</span>
documentValidator.setValidationLevel(ValidationLevel.LONG_TERM_DATA);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_long_term_availability_ades_validation">19.2.2.3. Long Term Availability AdES validation</h5>
<div class="listingblock">
<div class="title">LTA-level AdES validation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Validate the signature with long-term availability and integrity material</span>
documentValidator.setValidationLevel(ValidationLevel.ARCHIVAL_DATA);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_trusted_list_validation">19.2.3. Trusted list validation</h4>
<div class="paragraph">
<p>A validation of a Trusted List is similar to a signature validation, with the only difference that the validation of a Trusted List can be done in offline mode.</p>
</div>
<div class="paragraph">
<p>Additionally, a validation against the XSD schema should be performed.</p>
</div>
<div class="listingblock">
<div class="title">Validation of a trusted list</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Create an instance of a trusted certificate source</span>
<span style="color:#777">// NOTE: signing-certificate of a TL shall be trusted directly</span>
CommonTrustedCertificateSource trustedCertSource = <span style="color:#080;font-weight:bold">new</span> CommonTrustedCertificateSource();
trustedCertSource.addCertificate(getSigningCert());

<span style="color:#777">// First, we need a Certificate verifier (online sources are not required for TL-validation)</span>
CertificateVerifier cv = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
cv.addTrustedCertSources(trustedCertSource);

<span style="color:#777">// We create an instance of XMLDocumentValidator</span>
DocumentValidator documentValidator = <span style="color:#080;font-weight:bold">new</span> XMLDocumentValidator(signedTrustedList);

<span style="color:#777">// We add the certificate verifier</span>
documentValidator.setCertificateVerifier(cv);

<span style="color:#777">// TL shall be valid at the validation time</span>
documentValidator.setValidationLevel(ValidationLevel.BASIC_SIGNATURES);

<span style="color:#777">// Here, everything is ready. We can execute the validation.</span>
Reports reports = documentValidator.validateDocument();

<span style="color:#777">// Additionally, the TL can be validated against the XSD schema</span>
<span style="color:#0a8;font-weight:bold">Document</span> tlDocDom = DomUtils.buildDOM(signedTrustedList);
<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; errors = TrustedListUtils.getInstance().validateAgainstXSD(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">DOMSource</span>(tlDocDom));</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CachingUseCases">19.3. Caching use cases</h3>
<div class="sect3">
<h4 id="_caching_revocation_data_crl_ocsp">19.3.1. Caching revocation data (CRL, OCSP)</h4>
<div class="sect4">
<h5 id="_crl_3">19.3.1.1. CRL</h5>
<div class="paragraph">
<p>An example for JdbcCacheCRLSource:</p>
</div>
<div class="listingblock">
<div class="title">JdbcCacheCRLSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Creates an instance of JdbcCacheCRLSource</span>
JdbcCacheCRLSource cacheCRLSource = <span style="color:#080;font-weight:bold">new</span> JdbcCacheCRLSource();

<span style="color:#777">// Initialize the JdbcCacheConnector</span>
JdbcCacheConnector jdbcCacheConnector = <span style="color:#080;font-weight:bold">new</span> JdbcCacheConnector(dataSource);

<span style="color:#777">// Set the JdbcCacheConnector</span>
cacheCRLSource.setJdbcCacheConnector(jdbcCacheConnector);

<span style="color:#777">// Allows definition of an alternative dataLoader to be used to access a revocation</span>
<span style="color:#777">// from online sources if a requested revocation is not present in the repository or has been expired (see below).</span>
cacheCRLSource.setProxySource(onlineCRLSource);

<span style="color:#777">// All setters accept values in seconds</span>
<span style="color:#0a8;font-weight:bold">Long</span> oneWeek = (<span style="color:#339;font-weight:bold">long</span>) (<span style="color:#00D">60</span> * <span style="color:#00D">60</span> * <span style="color:#00D">24</span> * <span style="color:#00D">7</span>); <span style="color:#777">// seconds * minutes * hours * days</span>

<span style="color:#777">// If &quot;nextUpdate&quot; field is not defined for a revocation token, the value of &quot;defaultNextUpdateDelay&quot; </span>
<span style="color:#777">// will be used in order to determine when a new revocation data should be requested. </span>
<span style="color:#777">// If the current time is not beyond the &quot;thisUpdate&quot; time + &quot;defaultNextUpdateDelay&quot;, </span>
<span style="color:#777">// then a revocation data will be retrieved from the repository source, otherwise a new revocation data </span>
<span style="color:#777">// will be requested from a proxiedSource. </span>
<span style="color:#777">// Default : null (a new revocation data will be requested of &quot;nestUpdate&quot; field is not defined).</span>
cacheCRLSource.setDefaultNextUpdateDelay(oneWeek);

<span style="color:#777">// Defines a custom maximum possible nextUpdate delay. Allows limiting of a time interval </span>
<span style="color:#777">// from &quot;thisUpdate&quot; to &quot;nextUpdate&quot; defined in a revocation data. </span>
<span style="color:#777">// Default : null (not specified, the &quot;nextUpdate&quot; value provided in a revocation is used).</span>
cacheCRLSource.setMaxNextUpdateDelay(oneWeek); <span style="color:#777">// force refresh every week (eg : ARL)</span>

<span style="color:#777">// Defines if a revocation should be removed on its expiration. </span>
<span style="color:#777">// Default : true (removes revocation from a repository if expired).</span>
cacheCRLSource.setRemoveExpired(<span style="color:#069">true</span>);

<span style="color:#777">// Creates an SQL table</span>
cacheCRLSource.initTable();

<span style="color:#777">// Extract CRL for a certificate</span>
CRLToken crlRevocationToken = cacheCRLSource.getRevocationToken(certificateToken, issuerCertificateToken);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ocsp_3">19.3.1.2. OCSP</h5>
<div class="paragraph">
<p>An example for JdbcCacheOCSPSource:</p>
</div>
<div class="listingblock">
<div class="title">JdbcCacheOCSPSource usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JdbcCacheOCSPSource cacheOCSPSource = <span style="color:#080;font-weight:bold">new</span> JdbcCacheOCSPSource();
JdbcCacheConnector jdbcCacheConnector = <span style="color:#080;font-weight:bold">new</span> JdbcCacheConnector(dataSource);
cacheOCSPSource.setJdbcCacheConnector(jdbcCacheConnector);
cacheOCSPSource.setProxySource(onlineOCSPSource);
<span style="color:#0a8;font-weight:bold">Long</span> threeMinutes = (<span style="color:#339;font-weight:bold">long</span>) (<span style="color:#00D">60</span> * <span style="color:#00D">3</span>);
cacheOCSPSource.setDefaultNextUpdateDelay(threeMinutes); <span style="color:#777">// default nextUpdateDelay (if not defined in the revocation data)</span>
cacheOCSPSource.initTable();
OCSPToken ocspRevocationToken = cacheOCSPSource.getRevocationToken(certificateToken, certificateToken);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_caching_certificates_aia_certificates">19.3.2. Caching certificates (AIA certificates)</h4>
<div class="paragraph">
<p>An example for JdbcCacheOCSPSource:</p>
</div>
<div class="listingblock">
<div class="title">Caching of certificates</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">JdbcCacheAIASource cacheAIASource = <span style="color:#080;font-weight:bold">new</span> JdbcCacheAIASource();
JdbcCacheConnector jdbcCacheConnector = <span style="color:#080;font-weight:bold">new</span> JdbcCacheConnector(dataSource);
cacheAIASource.setJdbcCacheConnector(jdbcCacheConnector);
cacheAIASource.setProxySource(onlineAIASource);
cacheAIASource.initTable();
<span style="color:#0a8;font-weight:bold">Set</span>&lt;CertificateToken&gt; aiaCertificates = cacheAIASource.getCertificatesByAIA(certificateToken);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_caching_trusted_lists">19.3.3. Caching trusted lists</h4>
<div class="paragraph">
<p>Trusted Lists and List(s) of Trusted Lists are cached automatically as a part if <code>TLValidationJob</code> (see <a href="#tlValidationJob">Configuration of TL validation job</a>). To configure it you may use <code>FileCacheDataLoader</code> (see <a href="#DSSFileLoader">DSSFileLoader</a>).</p>
</div>
<div class="paragraph">
<p>To load Trusted Lists from a cache, the offline loader shall be configured, and the action can be performed with the method:</p>
</div>
<div class="listingblock">
<div class="title">Trusted Lists update from a cache</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// call with the Offline Loader (application initialization)</span>
validationJob.offlineRefresh();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_complete_examples_of_signature_creation">19.4. Complete examples of Signature creation</h3>
<div class="sect3">
<h4 id="XAdES">19.4.1. XAdES</h4>
<div class="paragraph">
<p>Below is an example of the <code>XAdES-Baseline-B</code> signature signing an XML document:</p>
</div>
<div class="listingblock">
<div class="title">Create a XAdES-BASELINE-B signature</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing parameters for the XAdES signature</span>
XAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> XAdESSignatureParameters();
<span style="color:#777">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
<span style="color:#777">// We choose the type of the signature packaging (ENVELOPED, ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPED);
<span style="color:#777">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span style="color:#777">// same parameter when you invoke the method sign on the token. The default value is SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();

<span style="color:#777">// Create XAdES service for signature</span>
XAdESService service = <span style="color:#080;font-weight:bold">new</span> XAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo XML segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);

<span style="color:#777">// We invoke the service to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="CAdES">19.4.2. CAdES</h4>
<div class="paragraph">
<p>Below is an example of the <code>CAdES-Baseline-B</code> signature:</p>
</div>
<div class="listingblock">
<div class="title">Signing a file with CAdES</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing parameters for the CAdES signature</span>
CAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> CAdESSignatureParameters();
<span style="color:#777">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.CAdES_BASELINE_B);
<span style="color:#777">// We choose the type of the signature packaging (ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPING);
<span style="color:#777">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span style="color:#777">// same parameter when you invoke the method sign on the token. The default value is</span>
<span style="color:#777">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create CAdESService for signature</span>
CAdESService service = <span style="color:#080;font-weight:bold">new</span> CAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span style="color:#777">// We invoke the CAdESService to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="PAdES">19.4.3. PAdES</h4>
<div class="paragraph">
<p>Below is an example of code to perform a <code>PAdES-BASELINE-B</code> type signature:</p>
</div>
<div class="listingblock">
<div class="title">Signing a PDF file with PAdES</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing parameters for the PAdES signature</span>
PAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> PAdESSignatureParameters();
<span style="color:#777">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_B);
<span style="color:#777">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span style="color:#777">// same parameter when you invoke the method sign on the token. The default value is</span>
<span style="color:#777">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create PAdESService for signature</span>
PAdESService service = <span style="color:#080;font-weight:bold">new</span> PAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span style="color:#777">// Optionally or for debug purpose :</span>
<span style="color:#777">// Validate the signature value against the original dataToSign</span>
assertTrue(service.isValidSignatureValue(dataToSign, signatureValue, privateKey.getCertificate()));

<span style="color:#777">// We invoke the padesService to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="PAdESVisibleSignatureAnnex">19.4.3.1. PAdES Visible Signature</h5>
<div class="paragraph">
<p>DSS provides a large set of utilities for PDF visible signature creation (see <a href="#PAdESVisibleSignature">PAdES Visible Signature</a> for more information).</p>
</div>
<div class="paragraph">
<p>Below there is an example of code to perform a <code>PAdES-BASELINE-B</code> type signature with a visible signature:</p>
</div>
<div class="listingblock">
<div class="title">Add a visible signature to a PDF document</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing parameters for the PAdES signature</span>
PAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> PAdESSignatureParameters();
<span style="color:#777">// We choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.PAdES_BASELINE_B);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Initialize visual signature and configure</span>
SignatureImageParameters imageParameters = <span style="color:#080;font-weight:bold">new</span> SignatureImageParameters();
<span style="color:#777">// set an image</span>
imageParameters.setImage(<span style="color:#080;font-weight:bold">new</span> InMemoryDocument(getClass().getResourceAsStream(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/signature-pen.png</span><span style="color:#710">&quot;</span></span>)));

<span style="color:#777">// initialize signature field parameters</span>
SignatureFieldParameters fieldParameters = <span style="color:#080;font-weight:bold">new</span> SignatureFieldParameters();
imageParameters.setFieldParameters(fieldParameters);
<span style="color:#777">// the origin is the left and top corner of the page</span>
fieldParameters.setOriginX(<span style="color:#00D">200</span>);
fieldParameters.setOriginY(<span style="color:#00D">400</span>);
fieldParameters.setWidth(<span style="color:#00D">300</span>);
fieldParameters.setHeight(<span style="color:#00D">200</span>);
parameters.setImageParameters(imageParameters);

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create PAdESService for signature</span>
PAdESService service = <span style="color:#080;font-weight:bold">new</span> PAdESService(commonCertificateVerifier);
service.setPdfObjFactory(<span style="color:#080;font-weight:bold">new</span> PdfBoxNativeObjectFactory());
<span style="color:#777">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span style="color:#777">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, DSS also allows you to insert a visible signature to an existing field :</p>
</div>
<div class="listingblock">
<div class="title">Add a visible signature to an existing field</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SignatureFieldParameters fieldParameters = <span style="color:#080;font-weight:bold">new</span> SignatureFieldParameters();
fieldParameters.setFieldId(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">field-id</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following sections present examples of existing parameters for creation of visible signatures with DSS.</p>
</div>
<div class="sect5">
<h6 id="Positioning">19.4.3.1.1. Positioning</h6>
<div class="paragraph">
<p>DSS provides a set of functions allowing to place the signature field on a specific place in the PDF page :</p>
</div>
<div class="listingblock">
<div class="title">Visible signature positioning</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Object containing a list of visible signature parameters</span>
SignatureImageParameters signatureImageParameters = <span style="color:#080;font-weight:bold">new</span> SignatureImageParameters();

<span style="color:#777">// Allows alignment of a signature field horizontally to a page. Allows the following values:</span>
<span style="color:#777">/* _NONE_ (_DEFAULT value._ None alignment is applied, coordinates are counted from the left page side);
   _LEFT_ (the signature is aligned to the left side, coordinated are counted from the left page side);
   _CENTER_ (the signature is aligned to the center of the page, coordinates are counted automatically);
   _RIGHT_ (the signature is aligned to the right side, coordinated are counted from the right page side). */</span>
signatureImageParameters.setAlignmentHorizontal(VisualSignatureAlignmentHorizontal.CENTER);

<span style="color:#777">// Allows alignment of a signature field vertically to a page. Allows the following values:</span>
<span style="color:#777">/* _NONE_ (_DEFAULT value._ None alignment is applied, coordinated are counted from the top side of a page);
   _TOP_ (the signature is aligned to a top side, coordinated are counted from the top page side);
   _MIDDLE_ (the signature aligned to a middle of a page, coordinated are counted automatically);
   _BOTTOM_ (the signature is aligned to a bottom side, coordinated are counted from the bottom page side). */</span>
signatureImageParameters.setAlignmentVertical(VisualSignatureAlignmentVertical.TOP);

<span style="color:#777">// Rotates the signature field and changes the coordinates' origin respectively to its values as following:</span>
<span style="color:#777">/* _NONE_ (_DEFAULT value._ No rotation is applied. The origin of coordinates begins from the top left corner of a page);
   _AUTOMATIC_ (Rotates a signature field respectively to the page's rotation. Rotates the signature field on the same value as defined in a PDF page);
   _ROTATE_90_ (Rotates a signature field for a 90&amp;#176; clockwise. Coordinates' origin begins from top right page corner);
   _ROTATE_180_ (Rotates a signature field for a 180&amp;#176; clockwise. Coordinates' origin begins from the bottom right page corner);
   _ROTATE_270_ (Rotates a signature field for a 270&amp;#176; clockwise. Coordinates' origin begins from the bottom left page corner). */</span>
signatureImageParameters.setRotation(VisualSignatureRotation.AUTOMATIC);

<span style="color:#777">// Defines a zoom of the image. The value is applied to width and height of a signature field. </span>
<span style="color:#777">// The value must be defined in percentage (default value is 100, no zoom is applied).</span>
signatureImageParameters.setZoom(<span style="color:#00D">50</span>);

<span style="color:#777">// Specifies a background color for a signature field.</span>
signatureImageParameters.setBackgroundColor(<span style="color:#0a8;font-weight:bold">Color</span>.GREEN);

<span style="color:#777">// Defines the image scaling behavior within a signature field with a fixed size</span>
<span style="color:#777">/*
  STRETCH - the default behavior, stretches the image in both directions in order to fill the signature field box;
  ZOOM_AND_CENTER - zooms the image to fill the signature box to the closest side, and centers in another dimension;
  CENTER - centers the image in both dimensions.
*/</span>
signatureImageParameters.setImageScaling(ImageScaling.CENTER);

<span style="color:#777">// set the image parameters to signature parameters</span>
padesSignatureParameters.setImageParameters(signatureImageParameters);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="Dimensions">19.4.3.1.2. Dimensions</h6>
<div class="paragraph">
<p>DSS framework provides a set of functions to manage the signature field size :</p>
</div>
<div class="listingblock">
<div class="title">Visible signature dimensions</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Object containing a list of signature field parameters</span>
SignatureFieldParameters fieldParameters = <span style="color:#080;font-weight:bold">new</span> SignatureFieldParameters();
signatureImageParameters.setFieldParameters(fieldParameters);

<span style="color:#777">// Allows defining of a specific page in a PDF document where the signature must be placed. </span>
<span style="color:#777">// The counting of pages starts from 1 (the first page) </span>
<span style="color:#777">// (the default value = 1).</span>
fieldParameters.setPage(<span style="color:#00D">1</span>);

<span style="color:#777">// Absolute positioning functions, allowing to specify a margin between </span>
<span style="color:#777">// the left page side and the top page side respectively, and</span>
<span style="color:#777">// a signature field (if no rotation and alignment is applied).</span>
fieldParameters.setOriginX(<span style="color:#00D">10</span>);
fieldParameters.setOriginY(<span style="color:#00D">10</span>);

<span style="color:#777">// Allows specifying of a precise signature field's width in pixels. </span>
<span style="color:#777">// If not defined, the default image/text width will be used.</span>
fieldParameters.setWidth(<span style="color:#00D">100</span>);

<span style="color:#777">// Allows specifying of a precise signature field's height in pixels. </span>
<span style="color:#777">// If not defined, the default image/text height will be used.</span>
fieldParameters.setHeight(<span style="color:#00D">125</span>);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="TextParameters">19.4.3.1.3. Text Parameters</h6>
<div class="paragraph">
<p>The available implementations allow placing of a visible text to a signature field :</p>
</div>
<div class="listingblock">
<div class="title">List of available visible text parameters</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Instantiates a SignatureImageTextParameters object</span>
SignatureImageTextParameters textParameters = <span style="color:#080;font-weight:bold">new</span> SignatureImageTextParameters();
<span style="color:#777">// Allows you to set a DSSFont object that defines the text style (see more information in the section &quot;Fonts usage&quot;)</span>
textParameters.setFont(font);
<span style="color:#777">// Defines the text content</span>
textParameters.setText(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">My visual signature </span><span style="color:#b0b">\n</span><span style="color:#D20"> #1</span><span style="color:#710">&quot;</span></span>);
<span style="color:#777">// Defines the color of the characters</span>
textParameters.setTextColor(<span style="color:#0a8;font-weight:bold">Color</span>.BLUE);
<span style="color:#777">// Defines the background color for the area filled out by the text</span>
textParameters.setBackgroundColor(<span style="color:#0a8;font-weight:bold">Color</span>.YELLOW);
<span style="color:#777">// Defines a padding between the text and a border of its bounding area</span>
textParameters.setPadding(<span style="color:#00D">20</span>);
<span style="color:#777">// TextWrapping parameter allows defining the text wrapping behavior within  the signature field</span>
<span style="color:#777">/*
  FONT_BASED - the default text wrapping, the text is computed based on the given font size;
  FILL_BOX - finds optimal font size to wrap the text to a signature field box;
  FILL_BOX_AND_LINEBREAK - breaks the words to multiple lines in order to find the biggest possible font size to wrap the text into a signature field box.
*/</span>
textParameters.setTextWrapping(TextWrapping.FONT_BASED);
<span style="color:#777">// Set textParameters to a SignatureImageParameters object</span>
imageParameters.setTextParameters(textParameters);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="TextImageCombi">19.4.3.1.4. Text and image combination</h6>
<div class="paragraph">
<p>DSS provides a set of functions to align a text respectively to an image. The parameters must be applied to a <code>SignatureImageTextParameters</code> object :</p>
</div>
<div class="listingblock">
<div class="title">Combination of text and image parameters</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Specifies a text position relatively to an image (Note: applicable only for joint image+text visible signatures). </span>
<span style="color:#777">// Thus with _SignerPosition.LEFT_ value, the text will be placed on the left side, </span>
<span style="color:#777">// and image will be aligned to the right side inside the signature field</span>
textParameters.setSignerTextPosition(SignerTextPosition.LEFT);
<span style="color:#777">// Specifies a horizontal alignment of a text with respect to its area</span>
textParameters.setSignerTextHorizontalAlignment(SignerTextHorizontalAlignment.RIGHT);
<span style="color:#777">// Specifies a vertical alignment of a text block with respect to a signature field area</span>
textParameters.setSignerTextVerticalAlignment(SignerTextVerticalAlignment.TOP);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of applying the foregoing transformations is provided on the image below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/visual-sig-text-parameters.jpg" alt="visual sig text parameters">
</div>
</div>
</div>
<div class="sect5">
<h6 id="Fonts">19.4.3.1.5. Fonts usage</h6>
<div class="paragraph">
<p>You can create a custom font as following, for a physical font:</p>
</div>
<div class="listingblock">
<div class="title">Add a custom font as a file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Initialize text to generate for visual signature</span>
DSSFont font = <span style="color:#080;font-weight:bold">new</span> DSSFileFont(getClass().getResourceAsStream(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/fonts/OpenSansRegular.ttf</span><span style="color:#710">&quot;</span></span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a logical font:</p>
</div>
<div class="listingblock">
<div class="title">Java font usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SignatureImageTextParameters textParameters = <span style="color:#080;font-weight:bold">new</span> SignatureImageTextParameters();
DSSFont font = <span style="color:#080;font-weight:bold">new</span> DSSJavaFont(<span style="color:#0a8;font-weight:bold">Font</span>.SERIF);
font.setSize(<span style="color:#00D">16</span>); <span style="color:#777">// Specifies the text size value (the default font size is 12pt)</span>
textParameters.setFont(font);
textParameters.setTextColor(<span style="color:#0a8;font-weight:bold">Color</span>.BLUE);
textParameters.setText(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">My visual signature</span><span style="color:#710">&quot;</span></span>);
imageParameters.setTextParameters(textParameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a native font:</p>
</div>
<div class="listingblock">
<div class="title">Native font usage</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">textParameters.setFont(<span style="color:#080;font-weight:bold">new</span> PdfBoxNativeFont(PDType1Font.HELVETICA));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="JAdES">19.4.4. JAdES</h4>
<div class="paragraph">
<p>A typical example of a <code>JAdES-BASELINE-B</code> signature creation is represented below:</p>
</div>
<div class="listingblock">
<div class="title">Signing a file with JAdES</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Prepare parameters for the JAdES signature</span>
JAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> JAdESSignatureParameters();
<span style="color:#777">// Choose the level of the signature (-B, -T, -LT, -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.JAdES_BASELINE_B);
<span style="color:#777">// Choose the type of the signature packaging (ENVELOPING, DETACHED).</span>
parameters.setSignaturePackaging(SignaturePackaging.ENVELOPING);
<span style="color:#777">// Choose the form of the signature (COMPACT_SERIALIZATION, JSON_SERIALIZATION, FLATTENED_JSON_SERIALIZATION)</span>
parameters.setJwsSerializationType(JWSSerializationType.COMPACT_SERIALIZATION);

<span style="color:#777">// Set the digest algorithm</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);
<span style="color:#777">// Set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// Set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create JAdESService for signature</span>
JAdESService service = <span style="color:#080;font-weight:bold">new</span> JAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span style="color:#777">// We invoke the JAdESService to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ASiC">19.4.5. ASiC</h4>
<div class="sect4">
<h5 id="ASiC-S">19.4.5.1. ASiC-S</h5>
<div class="paragraph">
<p>This is an example of the source code for signing a document using <code>ASiC-S</code> based on <code>XAdES-BASELINE-B</code> profile:</p>
</div>
<div class="listingblock">
<div class="title">Sign a file within an ASiC-S container</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing parameters for the AsicS signature</span>
ASiCWithXAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> ASiCWithXAdESSignatureParameters();
<span style="color:#777">// We choose the level of the signature (-B, -T, -LT, LTA).</span>
parameters.setSignatureLevel(SignatureLevel.XAdES_BASELINE_B);
<span style="color:#777">// We choose the container type (ASiC-S or ASiC-E)</span>
parameters.aSiC().setContainerType(ASiCContainerType.ASiC_S);

<span style="color:#777">// We set the digest algorithm to use with the signature algorithm. You must use the</span>
<span style="color:#777">// same parameter when you invoke the method sign on the token. The default value is</span>
<span style="color:#777">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create ASiC service for signature</span>
ASiCWithXAdESService service = <span style="color:#080;font-weight:bold">new</span> ASiCWithXAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// This function obtains the signature value for signed information using the</span>
<span style="color:#777">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span style="color:#777">// We invoke the xadesService to sign the document with the signature value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="ASiC-E">19.4.5.2. ASiC-E</h5>
<div class="paragraph">
<p>This is another example of the source code for signing multiple documents using <code>ASiC-E</code> based on <code>CAdES-BASELINE-B</code>:</p>
</div>
<div class="listingblock">
<div class="title">Sign multiple files within an ASiC-E container</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Preparing the documents to be embedded in the container and signed</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;DSSDocument&gt; documentsToBeSigned = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;&gt;();
documentsToBeSigned.add(<span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/hello-world.pdf</span><span style="color:#710">&quot;</span></span>));
documentsToBeSigned.add(<span style="color:#080;font-weight:bold">new</span> FileDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">src/main/resources/xml_example.xml</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// Preparing parameters for the ASiC-E signature</span>
ASiCWithCAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> ASiCWithCAdESSignatureParameters();

<span style="color:#777">// We choose the level of the signature (-B, -T, -LT or -LTA).</span>
parameters.setSignatureLevel(SignatureLevel.CAdES_BASELINE_B);
<span style="color:#777">// We choose the container type (ASiC-S pr ASiC-E)</span>
parameters.aSiC().setContainerType(ASiCContainerType.ASiC_E);

<span style="color:#777">// We set the digest algorithm to use with the signature algorithm. You</span>
<span style="color:#777">// must use the</span>
<span style="color:#777">// same parameter when you invoke the method sign on the token. The</span>
<span style="color:#777">// default value is</span>
<span style="color:#777">// SHA256</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// We set the signing certificate</span>
parameters.setSigningCertificate(privateKey.getCertificate());
<span style="color:#777">// We set the certificate chain</span>
parameters.setCertificateChain(privateKey.getCertificateChain());

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create ASiC service for signature</span>
ASiCWithCAdESService service = <span style="color:#080;font-weight:bold">new</span> ASiCWithCAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo segment that need to be signed.</span>
ToBeSigned dataToSign = service.getDataToSign(documentsToBeSigned, parameters);

<span style="color:#777">// This function obtains the signature value for signed information</span>
<span style="color:#777">// using the</span>
<span style="color:#777">// private key and specified algorithm</span>
DigestAlgorithm digestAlgorithm = parameters.getDigestAlgorithm();
SignatureValue signatureValue = signingToken.sign(dataToSign, digestAlgorithm, privateKey);

<span style="color:#777">// We invoke the xadesService to sign the document with the signature</span>
<span style="color:#777">// value obtained in</span>
<span style="color:#777">// the previous step.</span>
DSSDocument signedDocument = service.signDocument(documentsToBeSigned, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Topology">19.5. Examples of SCA and SCDev Topology and Workflows.</h3>
<div class="sect3">
<h4 id="_hash_encryption">19.5.1. Hash encryption</h4>
<div class="paragraph">
<p>In order to avoid transfer of original or sensitive information, and also to reduce the amount of data by online protocols, a hash of a document or data to be signed can be computed.</p>
</div>
<div class="listingblock">
<div class="title">Hash encryption</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Compute hash on a DSSDocument</span>
DSSDocument document = <span style="color:#080;font-weight:bold">new</span> InMemoryDocument(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello World!</span><span style="color:#710">&quot;</span></span>.getBytes());
<span style="color:#0a8;font-weight:bold">String</span> base64Sha256HashOfDocument = document.getDigest(DigestAlgorithm.SHA256);

<span style="color:#777">// Compute hash on a byte array</span>
<span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> binaries = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Hello World</span><span style="color:#710">&quot;</span></span>.getBytes();
<span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> sha256HashOfBinaries = DSSUtils.digest(DigestAlgorithm.SHA256, binaries);
<span style="color:#0a8;font-weight:bold">String</span> base64Sha256HashOfBinaries = Utils.toBase64(sha256HashOfBinaries);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="DetachedSignatureDigest">19.5.2. Detached signature based on digested document</h4>
<div class="paragraph">
<p>When you want to keep your original documents private, a signature can be created in a detached way, by providing the digest of an original document only. You can find an example of a use case below:</p>
</div>
<div class="listingblock">
<div class="title">Detached signature based on digested document</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Create a DigestDocument from original DSSDocument</span>
DigestDocument digestDocument = <span style="color:#080;font-weight:bold">new</span> DigestDocument();
digestDocument.addDigest(DigestAlgorithm.SHA256, originalDocument.getDigest(DigestAlgorithm.SHA256));

<span style="color:#777">// Preparing parameters for a signature creation</span>
CAdESSignatureParameters parameters = <span style="color:#080;font-weight:bold">new</span> CAdESSignatureParameters();
parameters.setSigningCertificate(privateKey.getCertificate());
parameters.setCertificateChain(privateKey.getCertificateChain());
parameters.setSignatureLevel(SignatureLevel.CAdES_BASELINE_B);

<span style="color:#777">// Set the detached packaging, as a digest only will be included into the signature, and the original content</span>
parameters.setSignaturePackaging(SignaturePackaging.DETACHED);

<span style="color:#777">// The same DigestAlgorithm shall be used as the one used to create the DigestDocument</span>
parameters.setDigestAlgorithm(DigestAlgorithm.SHA256);

<span style="color:#777">// Create common certificate verifier</span>
CommonCertificateVerifier commonCertificateVerifier = <span style="color:#080;font-weight:bold">new</span> CommonCertificateVerifier();
<span style="color:#777">// Create signature service for signature creation</span>
CAdESService service = <span style="color:#080;font-weight:bold">new</span> CAdESService(commonCertificateVerifier);

<span style="color:#777">// Get the SignedInfo segment that need to be signed providing the digest document</span>
ToBeSigned dataToSign = service.getDataToSign(digestDocument, parameters);

<span style="color:#777">// Sign the ToBeSigned data</span>
SignatureValue signatureValue = signingToken.sign(dataToSign, parameters.getDigestAlgorithm(), privateKey);

<span style="color:#777">// We invoke the signature service to create a signed document incorporating the obtained Sig</span>
DSSDocument signedDocument = service.signDocument(digestDocument, parameters, signatureValue);

<span style="color:#777">// Initialize the DocumentValidator</span>
DocumentValidator documentValidator = SignedDocumentValidator.fromDocument(signedDocument);

<span style="color:#777">// Set the CertificateVerifier</span>
documentValidator.setCertificateVerifier(commonCertificateVerifier);

<span style="color:#777">// Provide the original or digested document as a detached contents to the validator</span>
documentValidator.setDetachedContents(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(originalDocument));

<span style="color:#777">// Validate the signed document</span>
Reports reports = documentValidator.validateDocument();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ClientServerAnnex">19.5.3. Client-side signature creation with server-side remote key activation</h4>
<div class="paragraph">
<p>When a private key signing is operated remotely, i.e. on an external server, then the document preparation and the actual signing can be separated. The signature document is created on client&#8217;s side and the actual signature is made remotely. Refer to section <a href="#ClientServerSeparation">Client-side signature creation with server-side remote key activation</a> for a detailed description and visual illustration of the steps that take place in such a situation. See the code below for a code illustration:</p>
</div>
<div class="listingblock">
<div class="title">Creation of the signature envelope on client side and signature value on server side</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Get the SignedInfo segment that need to be signed providing the original document</span>
ToBeSigned dataToSign = service.getDataToSign(toSignDocument, parameters);

<span style="color:#777">// Compute the hash of ToBeSigned data to send to the remote server</span>
<span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> toBeSignedDigest = DSSUtils.digest(parameters.getDigestAlgorithm(), dataToSign.getBytes());
Digest digest = <span style="color:#080;font-weight:bold">new</span> Digest(parameters.getDigestAlgorithm(), toBeSignedDigest);

<span style="color:#777">// Provide the hash of ToBeSigned data to the remote server for signing</span>
SignatureValue signatureValue = serverSignDigest(digest);
<span style="color:#777">//SignatureValue signatureValue = serverSign(dataToSign, parameters.getDigestAlgorithm());</span>

<span style="color:#777">// We invoke the signature service to create a signed document incorporating the obtained Sig</span>
DSSDocument signedDocument = service.signDocument(toSignDocument, parameters, signatureValue);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="DetaliedReportInterpretation">19.6. Interpreting a detailed report</h3>
<div class="paragraph">
<p>We will illustrate here how to read a detailed validation report where the validation succeeds even though the signing certificate has been revoked.</p>
</div>
<div class="paragraph">
<p>This will illustrate how to look up at which check failed and how the overall validation process can succeed even when a sub-process failed.</p>
</div>
<div class="paragraph">
<p>First, as explained in <a href="#DetailedReport">Detailed report</a> the structure of the detailed validation report is based on ETSI EN 319 102-1 (<a href="#R09">[R09]</a>). This means that the detailed report is structured in terms of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Validation processes; and</p>
</li>
<li>
<p>Building blocks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are three validation processes specified in ETSI EN 319 102-1:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Validation process for Basic Signatures;</p>
</li>
<li>
<p>The Validation process for Signatures with Time and Signatures with Long-Term Validation Material;</p>
</li>
<li>
<p>The Validation process for Signatures providing Long Term Availability and Integrity of Validation Material, abbreviated in the report as "Validation Process for Signatures with Archival Data".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Those validation processes in turn rely on building blocks, which are denoted in ETSI EN 319 102-1 as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The basic building blocks;</p>
</li>
<li>
<p>The time-stamp validation building block;</p>
</li>
<li>
<p>The additional building blocks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DSS groups the basic building blocks and the additional building blocks related to the validation of a particular signature together. However, it separates the time-stamp validation builiding block from the rest and present it alongside the validation processes because this building block essentially consists in applying the validation process for basic signatures to a timestamp token taken as a CMS object.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s see how this looks in a validation report (we use here the HTML representation provided by the demonstration).</p>
</div>
<div class="paragraph">
<p>First, as mentionned, are the validation processes and the time-stamp validation building block, which are numbered in the figure below with:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The validation process for Basic Signatures;</p>
</li>
<li>
<p>The time-stamp building block in which appears the validation process of the timestamp;</p>
</li>
<li>
<p>The validation process for Signatures with Time and Signatures with Long-Term Validation Material;</p>
</li>
<li>
<p>The validation process for Signatures with Archival Data.</p>
</li>
</ol>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/DetailedReport-Illustration-SigProcesses.png" alt="DetailedReport Illustration SigProcesses" width="100%" height="100%">
</div>
</div>
<div class="paragraph">
<p>As further illustrated in the figure above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The validation process for Basic signature is executed against the first time which is the (current) validation time;</p>
</li>
<li>
<p>The validation process for Signatures with Time and Signatures with Long-Term Validation Material is executed against a second time which is the "best signature time" that is determined using the signature timestamp;</p>
</li>
<li>
<p>The validation process for Signatures with Archival Data is executed aginst a third time which is the "best signature time" determined using all time assertions present in the signature.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, each process has an associated indication, here:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>REVOKED_NO_POE for the validation process for basic signatures;</p>
</li>
<li>
<p>PASSED for the timestamp validation block;</p>
</li>
<li>
<p>PASSED for the validation process for Signatures with Time and Signatures with Long-Term Validation Material;</p>
</li>
<li>
<p>PASSED for the validation process for Signatures with Archival Data.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Each of those indications is determined using the result of the associated building blocks, and applying additional checks.</p>
</div>
<div class="paragraph">
<p>Here we can see that the REVOKED_NO_POE indication arises from the fact that the result of the "X.509 Certificate Validation" building block is not conclusive.</p>
</div>
<div class="paragraph">
<p>Now delving into the building blocks themselves, we can see in the figure below that the building blocks are grouped by the signed objects to which they relate:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>BBB SIG are the building blocks used for the validation of the signature itself;</p>
</li>
<li>
<p>BBB TIMESTAMP are the building blocks used for the validation of the timestamp;</p>
</li>
<li>
<p>BBB REVOCATION DATA are the building blocks used for the validation of the OCSP responses taken as CMS objects.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/DetailedReport-Illustration-BB.png" alt="DetailedReport Illustration BB" width="100%" height="100%">
</div>
</div>
<div class="paragraph">
<p>We saw previously that the "validation process for basic signature" resulted in the REVOKED_NO_POE indication because the result of the "X.509 Certificate Validation" building block was not conclusive.</p>
</div>
<div class="paragraph">
<p>To check what went wrong, we must therefore look at the "X.509 Certificate Validation" building block associated to the signature, that is the "X.509 Certificate Validation" building block that is in BBB SIG.</p>
</div>
<div class="paragraph">
<p>We see there that the check "Is the certificate validation conclusive?" has failed. Therefore, we now need to look at the "Certificate" sub-block of BBB SIG.</p>
</div>
<div class="paragraph">
<p>In the "Certificate" sub-block we can see that all checks succeded except for "Is the certificate not revoked?". We can thus conclude that the validation process for basic signature resulted in the indication "REVOKED_NO_POE" because the signing certificate is revoked at validation time.</p>
</div>
<div class="paragraph">
<p>That being said, we saw before that although the validation process for basic signature failed with "REVOKED_NO_POE", the other validation processes resulted in the PASSED indication. And in fact, the overall result of the validation process is TOTAL_PASSED.</p>
</div>
<div class="paragraph">
<p>To understand why that is so, we need to look back at the signature validation processes. There we can see in the "validation process for Signatures with Time and Signatures with Long-Term Validation Material" that specific checks differing from the building blocks are executed. Which checks are executed depends on the indication determined during the "validation process for basic signatures". In the present case, because the indication was "REVOKED_NO_POE" the specific check "Is the revocation time after best-signature-time" is executed.</p>
</div>
<div class="paragraph">
<p>As mentioned before, "best-signature-time" is determined, for that validation process, using the signature timestamp. Because here the validation of the signature timestamp succeeded, the time indicated in the timestamp is used as best-signature-time, and because this time is indeed before the time of revocation of the signing certificate, the check succeeds, and the whole "validation process for Signatures with Time and Signatures with Long-Term Validation Material" succeeds.</p>
</div>
<div class="paragraph">
<p>Now to understand why the overall result of the validation is TOTAL_PASSED, we need to go back to the procedures specified in ETSI EN 319 102-1. The three validation processes specified in that standard are in fact not independent:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The "validation process for Signatures providing Long Term Availability and Integrity of Validation Material" calls the "validation process for Signatures with Time and Signatures with Long-Term Validation Material"; and</p>
</li>
<li>
<p>The "validation process for Signatures with Time and Signatures with Long-Term Validation Material" itself calls the "validation process for basic signatures".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The overall validation result is then provided as the indication returned by the validation process against which the validation was performed.</p>
</div>
<div class="paragraph">
<p>Although it is possible to only run the validation process for basic signature, in our case the process that was run was the "validation process for Signatures providing Long Term Availability and Integrity of Validation Material" which required to run the other two validation processes.</p>
</div>
<div class="paragraph">
<p>Therefore, because that validation process returned PASSED, the overall validation result is TOTAL_PASSED.</p>
</div>
<div class="paragraph">
<p>Finally, the report contains information on the determination of the qualification of the signature.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/DetailedReport-Illustration-Qualification.png" alt="DetailedReport Illustration Qualification" width="100%" height="100%">
</div>
</div>
<div class="paragraph">
<p>This determination is not specified in ETSI EN 319 102-1, but rather in ETSI TS 119 172-4 (<a href="#R10">[R10]</a>).</p>
</div>
<div class="paragraph">
<p>Essentially, a signature can be determined as qualified if:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The result of running the "validation process for Signatures providing Long Term Availability and Integrity of Validation Material" defined in ETSI EN 319 102-1 is TOTAL_PASSED</p>
</li>
<li>
<p>The signing certificate is determined as qualified at best-signature-time and at issuance time (the time when the certificate was issued i.e. the value of the "notBefore" field);</p>
</li>
<li>
<p>The private key corresponding to the signing certificate is determined as being held in a qualified signature creation device (QSCD).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>We discussed above the validation processes defined in ETSI EN 319 102-1. The determinations of point 2 and 3 on the other hand rely on the procedures specified in ETSI TS 119 615 (<a href="#R14">[R14]</a>).</p>
</div>
<div class="paragraph">
<p>Without going into details, ETSI TS 119 615 specifies procedures for interpreting the content of EUMS trusted lists, including procedures for validating EUMS trusted lists.</p>
</div>
<div class="paragraph">
<p>Illustrated in the figure above are the results of the main steps defined in that standard.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-01-03 09:51:47 +0100
</div>
</div>
</body>
</html>